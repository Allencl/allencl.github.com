"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[5857],{5857:function(e,t,a){a.r(t),a.d(t,{default:function(){return q}});a(41817);var i=a(73396),l=a(87139);const o=(0,i._)("span",{style:{"padding-left":"6px"}},"当前报修设备",-1),n={class:"font-weight-medium text-left text-teal-lighten-1",color:"primary"},m={class:"text-h7 card-title-index1"},s=(0,i._)("span",null,"故障确认",-1),u=(0,i._)("div",{style:{height:"8px"}},null,-1),p=(0,i._)("div",{style:{height:"12px"}},null,-1),r={class:"text-h7 card-title-index1"},d=(0,i._)("span",null,"报修确认",-1),c=(0,i._)("div",{style:{height:"8px"}},null,-1),f={class:"mt-3 mb-4"},y=(0,i._)("div",{style:{height:"52px"}},null,-1);function h(e,t,a,h,g,V){const b=(0,i.up)("AppBarPage"),v=(0,i.up)("v-icon"),w=(0,i.up)("v-col"),x=(0,i.up)("v-row"),S=(0,i.up)("SelectComponents"),_=(0,i.up)("van-field"),T=(0,i.up)("UploaderImageComponents"),W=(0,i.up)("v-sheet"),q=(0,i.up)("v-btn");return(0,i.wg)(),(0,i.iD)("span",null,[(0,i.Wm)(b),(0,i.Wm)(x,{"no-gutters":"",style:{"margin-bottom":"2px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{cols:"11"},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{icon:"mdi-tools",size:"16",color:"#3F51B5"}),o])),_:1}),(0,i.Wm)(w,{cols:"1",class:"text-right",style:{"padding-right":"6px"}})])),_:1}),(0,i.Wm)(x,{"no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{cols:"12",style:{"margin-bottom":"4px","padding-left":"2px"}},{default:(0,i.w5)((()=>[(0,i._)("p",n,(0,l.zw)(e.equipmentName),1)])),_:1})])),_:1}),(0,i.Wm)(W,{elevation:"2",rounded:"",class:"pa-1"},{default:(0,i.w5)((()=>[(0,i._)("div",m,[(0,i.Wm)(v,{size:"x-small",color:"#26C6DA",icon:"mdi-file-document-edit"}),s]),u,(0,i.Wm)(S,{modelValue:e.formData.typeSelectValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.formData.typeSelectValue=t),label:"故障类型",required:"",option:e.typeOption},null,8,["modelValue","option"]),(0,i.Wm)(S,{modelValue:e.formData.locationSelectValue,"onUpdate:modelValue":t[1]||(t[1]=t=>e.formData.locationSelectValue=t),label:"故障位置",required:"",option:e.locationOption},null,8,["modelValue","option"]),(0,i.Wm)(_,{modelValue:e.formData.description,"onUpdate:modelValue":t[2]||(t[2]=t=>e.formData.description=t),rows:"2",autosize:"",label:"故障详细描述",type:"textarea",autocomplete:"off",placeholder:"请输入",maxlength:"200",required:"","show-word-limit":""},null,8,["modelValue"]),(0,i.Wm)(T,{modelValue:e.bufferFileList,"onUpdate:modelValue":t[3]||(t[3]=t=>e.bufferFileList=t)},null,8,["modelValue"])])),_:1}),p,(0,i.Wm)(W,{elevation:"2",rounded:"",class:"pa-1"},{default:(0,i.w5)((()=>[(0,i._)("div",r,[(0,i.Wm)(v,{size:"x-small",color:"#3F51B5",icon:"mdi-account-wrench"}),d]),c,(0,i.Wm)(S,{modelValue:e.formData.maintainTypeSelectValue,"onUpdate:modelValue":t[4]||(t[4]=t=>e.formData.maintainTypeSelectValue=t),label:"维修类型",required:"",option:e.maintainTypeSelectOption},null,8,["modelValue","option"]),(0,i.Wm)(_,{modelValue:e.repairsPersonnel,"onUpdate:modelValue":t[5]||(t[5]=t=>e.repairsPersonnel=t),placeholder:"请输入",autocomplete:"off",label:"报修人",readonly:""},null,8,["modelValue"])])),_:1}),(0,i._)("div",f,[(0,i.Wm)(q,{block:"",color:"primary",onClick:V.submit},{default:(0,i.w5)((()=>[(0,i.Uk)(" 确定 ")])),_:1},8,["onClick"])]),y])}a(73210);var g=a(76496),V=a(2243),b=a(21655),v=a(57265),w=a(37184),x=a(89337),S=a(20868),_=(a(51693),{components:{AppBarPage:g.Z,SelectComponents:V.Z,UploaderImageComponents:v.Z,DatePickerComponents:b.Z},data:()=>({repairsPersonnel:"",equipmentName:"",bufferFileList:[],formData:{typeSelectValue:"",locationSelectValue:"",description:"",maintainTypeSelectValue:"",user:"",date:""},typeOption:[],locationOption:[],maintainTypeSelectOption:[],repairmanSelectOption:[]}),created(){this.initType(),this.initPosition(),this.initMaintainType(),this.initRepairman(),this.initTime()},methods:{async initTime(){const{equipmentNo:e="",equipmentName:t="",tmBasEquipmentId:a}=this.$route.query;this.formData.date="2023-2-23 15:33";const i=JSON.parse(localStorage.getItem("bufferUserInfo")||"{}");this.repairsPersonnel=`${i["userName"]}-${i["nickName"]}`;const{code:l,data:o={}}=await(0,w.i)({url:`/iiot/equipment/getEquipment/${a}`,method:"get"});200==l&&(this.equipmentName=o.equipmentName)},async initType(){const{data:e=[]}=await(0,x.AT)();this.typeOption=e.map((e=>Object.assign({text:`${e.faultTypeNo}-${e.faultTypeName}`,value:e.tmBasFaultTypeId})))},async initPosition(){const{data:e=[]}=await(0,x.vU)();this.locationOption=e.map((e=>Object.assign({text:`${e.faultNo}-${e.faultName}`,value:e.tmBasFaultId})))},async initMaintainType(){const{data:e=[]}=await(0,x.ew)();this.maintainTypeSelectOption=e.map((e=>Object.assign({text:`${e.dictLabel}`,value:e.dictValue})))},async initRepairman(){const{data:e=[]}=await(0,x.NM)();this.repairmanSelectOption=e.map((e=>Object.assign({text:`${e.userName}-${e.nickName}`,value:String(e.userName)})))},async submit(){const{typeSelectValue:e,locationSelectValue:t,description:a,maintainTypeSelectValue:i,user:l}=this.formData,{tmBasEquipmentId:o}=this.$route.query;if(!e)return void(0,S.LJ)("故障类型必填！");if(!t)return void(0,S.LJ)("故障位置必填！");if(!a.trim())return void(0,S.LJ)("故障详细描述必填！");if(!i)return void(0,S.LJ)("维修类型必填！");const{code:n}=await(0,x.$w)({payload:{tmBasFaultTypeId:e,tmBasFaultId:t,problemCause:a,reportType:i,tmBasEquipmentId:o,filePath:this.bufferFileList.map((e=>e.url)).join()}});200==n&&((0,S.XA)("提交成功！"),this.$router.go(-1))}}}),T=a(40089);const W=(0,T.Z)(_,[["render",h]]);var q=W}}]);
//# sourceMappingURL=chunk.5857.1689576434327.js.map