"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[455],{89337:function(e,t,a){a.d(t,{$w:function(){return c},AT:function(){return n},NM:function(){return r},ew:function(){return o},jt:function(){return l},vU:function(){return s}});var i=a(37184);const l=async(e={})=>await(0,i.i)({url:"/iiot/nodeLevel/list",method:"get",url_params:e}),n=async e=>await(0,i.i)({url:"/iiot/faultType/list?enabled=1",method:"get"}),s=async e=>await(0,i.i)({url:"/iiot/fault/list?enabled=1",method:"get"}),o=async e=>await(0,i.i)({url:"/system/dict/data/type/equipment_repair_type",method:"get"}),r=async e=>await(0,i.i)({url:"/iiot/equipmentRepair/userList?enabled=1",method:"post"}),c=async e=>await(0,i.i)({url:"/iiot/equipmentRepair/confirmRepairWbForApp",method:"post",payload:e.payload})},5878:function(e,t,a){a.d(t,{b:function(){return i}});a(33948),a(57658);const i=(e,t,a,i)=>{let l={id:t||"id",parentId:a||"parentId",childrenList:i||"children"};var n={},s={},o=[];for(let c of e){let e=c[l.parentId];null==n[e]&&(n[e]=[]),s[c[l.id]]=c,n[e].push(c)}for(let c of e){let e=c[l.parentId];null==s[e]&&o.push(c)}for(let c of o)r(c);function r(e){if(null!==n[e[l.id]]&&(e[l.childrenList]=n[e[l.id]]),e[l.childrenList])for(let t of e[l.childrenList])r(t)}return o}},2243:function(e,t,a){a.d(t,{Z:function(){return g}});var i=a(73396),l=a(87139);const n={style:{height:"98%","padding-bottom":"40px"}},s={style:{height:"100%"}},o={style:{position:"relative",top:"4px"}},r=["onClick"],c={class:"text-truncate",style:{height:"24px"}},h={key:2,class:"text-center",style:{"margin-top":"16px"}};function u(e,t,a,u,p,d){const m=(0,i.up)("van-field"),f=(0,i.up)("v-col"),g=(0,i.up)("v-btn"),w=(0,i.up)("v-row"),k=(0,i.up)("van-search"),y=(0,i.up)("van-checkbox"),_=(0,i.up)("van-popup");return(0,i.wg)(),(0,i.iD)("span",null,[(0,i.Wm)(m,{modelValue:e.fieldValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fieldValue=t),"is-link":"",readonly:"",required:a.required,label:a.label,placeholder:a.placeholder,autocomplete:"off",type:a.multiple?"textarea":"text",onClick:d.fieldClick},null,8,["modelValue","required","label","placeholder","type","onClick"]),(0,i.Wm)(_,{show:e.showPicker,"onUpdate:show":t[5]||(t[5]=t=>e.showPicker=t),style:{padding:"12px 12px 4px 12px",height:"60%",width:"90%"},round:""},{default:(0,i.w5)((()=>[(0,i._)("div",n,[(0,i._)("div",s,[(0,i.Wm)(w,{"no-gutters":"",style:{"font-weight":"bold","border-bottom":"1px solid #ccc","padding-bottom":"5px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{cols:"6"},{default:(0,i.w5)((()=>[(0,i._)("p",null,(0,l.zw)(a.label)+"-选择框",1)])),_:1}),(0,i.Wm)(f,{cols:"6",class:"text-right"},{default:(0,i.w5)((()=>[(0,i._)("span",o,(0,l.zw)(e.BufferOption.filter((e=>e._checked)).length),1),a.selectAll?((0,i.wg)(),(0,i.j4)(g,{key:0,onClick:d.selectAllHandle,color:"primary mt-1",density:"compact",rounded:0,variant:"plain"},{default:(0,i.w5)((()=>[(0,i.Uk)("全选")])),_:1},8,["onClick"])):(0,i.kq)("",!0)])),_:1})])),_:1}),a.showSearch?((0,i.wg)(),(0,i.j4)(w,{key:0,"no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{cols:"8"},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{modelValue:e.valueSearch,"onUpdate:modelValue":t[1]||(t[1]=t=>e.valueSearch=t),shape:"",placeholder:a.placeholderSearch,style:{"padding-left":"0px"},clearable:!1},null,8,["modelValue","placeholder"])])),_:1}),(0,i.Wm)(f,{cols:"2"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{onClick:t[2]||(t[2]=e=>d.searchHandle(!0)),variant:"plain",color:"primary",block:"",style:{"margin-top":"8px"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" 查询 ")])),_:1})])),_:1}),(0,i.Wm)(f,{cols:"2"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{onClick:t[3]||(t[3]=e=>d.searchHandle(!1)),variant:"plain",block:"",style:{"margin-top":"8px"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" 重置 ")])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0),e.BufferOption.length?((0,i.wg)(),(0,i.iD)("ul",{key:1,style:(0,l.j5)(`height: ${a.showSearch?"73%":"90%"};overflow-y:auto;padding-right:12px;padding-bottom: 20px;`)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.BufferOption,((e,t)=>((0,i.wg)(),(0,i.iD)("li",{key:t,style:(0,l.j5)(`padding: 6px 22px 6px 6px;position:relative;color:${e._searchColor?"#FF9800":"#000"};`),onClick:t=>d.checkChange(e)},[(0,i._)("p",c,(0,l.zw)(e.text),1),(0,i.Wm)(y,{style:{position:"absolute",top:"8px",right:"0px"},modelValue:e._checked,"onUpdate:modelValue":t=>e._checked=t,shape:"square","checked-color":"#4CAF50",disabled:"",class:"custem-select-checkbox"},null,8,["modelValue","onUpdate:modelValue"])],12,r)))),128))],4)):((0,i.wg)(),(0,i.iD)("p",h,"无数据!"))]),(0,i.Wm)(w,{"no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{cols:"6",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{variant:"plain",block:"",onClick:t[4]||(t[4]=()=>e.showPicker=!1)},{default:(0,i.w5)((()=>[(0,i.Uk)(" 取消 ")])),_:1})])),_:1}),(0,i.Wm)(f,{cols:"6",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{variant:"plain",color:"primary",block:"",onClick:d.confirmHandle},{default:(0,i.w5)((()=>[(0,i.Uk)(" 确定 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1},8,["show"])])}a(38862),a(73210),a(26699),a(32023);var p=a(20868),d={components:{},emits:["update:modelValue","onChange","onFieldClick","onSearchChange"],data:()=>({BufferOption:[],selectedValues:[],columns:[],fieldValue:"",showPicker:!1,valueSearch:""}),watch:{option:{handler(e=[]){this.BufferOption=JSON.parse(JSON.stringify(e)),this.$nextTick((()=>{this.modelValue&&this.setValue(this.modelValue)}))},deep:!0,immediate:!0},showPicker:{handler(e){this.$nextTick((()=>{if(e&&this.modelValue)if(this.multiple){const e=this.modelValue.split(",")||[];e.map((e=>{this.BufferOption.map((t=>{var a=t;return t.value==e&&(a._checked=!0),a}))}))}else this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==this.modelValue})))}))},deep:!0,immediate:!0}},methods:{showModle(){this.showPicker=!0},fieldClick(){this.disabled||(this.forbidShow||(this.showPicker=!0),this.$emit("onFieldClick"))},setfieldValue(e=""){this.fieldValue=e},reset(){this.fieldValue="",this.BufferOption.map((e=>Object.assign(e,{_checked:!1}))),this.$emit("update:modelValue","")},setValue(e=""){if(this.multiple){const t=e.split(",")||[];t.map((e=>{this.BufferOption.map((t=>{var a=t;return t.value==e&&(a._checked=!0),a}))})),this.fieldValue=this.BufferOption.filter((e=>e._checked)).map((e=>e.text)).join()}else{const t=JSON.parse(JSON.stringify(this.BufferOption)).filter((t=>t.value==e))[0]||{};this.fieldValue=t.text}},confirmHandle(){const{multiple:e}=this,t=this.BufferOption.filter((e=>1==e._checked));e?(this.fieldValue=t.map((e=>e.text)).join(),this.$emit("update:modelValue",t.map((e=>e.value)).join()||""),this.$emit("onChange",t.map((e=>e.value)).join())):(this.fieldValue=(t[0]||{}).text,this.$emit("update:modelValue",(t[0]||{}).value||""),this.$emit("onChange",(t[0]||{}).value,t[0]||{})),this.showPicker=!1},checkChange(e){const{multiple:t}=this,{_checked:a,value:i}=e;t?this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==i?!a:e._checked}))):this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==i&&!a})))},multipleHandle(){const e=this.BufferOption.filter((e=>e._checked)),t=e.map((e=>e.value)).join();this.showPicker=!1,this.fieldValue=e.map((e=>e.text)).join(),this.$emit("update:modelValue",t),this.$emit("onChange",e)},searchHandle(e){const t=this.valueSearch.trim(),{filterSearch:a}=this;if(a&&e){const e=this.BufferOption.map((e=>Object.assign(e,{_searchColor:!1}))),a=e.filter((e=>e.text.includes(t))).map((e=>Object.assign(e,{_searchColor:!0})));if(!a.length)return void(0,p.LJ)("不存在！");const i=e.filter((e=>!e.text.includes(t))),l=i.filter((e=>e._checked)),n=i.filter((e=>!e._checked));this.BufferOption=a.concat(l).concat(n)}else e?this.$emit("onSearchChange",t):(this.valueSearch="",this.BufferOption=this.option,this.$nextTick((()=>{this.BufferOption=this.BufferOption.map((e=>Object.assign(e,{_checked:!1})))})),this.$emit("onSearchChange",""))},selectAllHandle(){this.BufferOption.map((e=>Object.assign(e,{_checked:!0})))}},props:{modelValue:{},disabled:{type:Boolean,default:()=>!1},showSearch:{type:Boolean,default:()=>!1},forbidShow:{type:Boolean,default:()=>!1},multiple:{type:Boolean,default:()=>!1},label:{type:String,default:()=>"标题"},placeholder:{type:String,default:()=>"请选择"},placeholderSearch:{type:String,default:()=>"请输入搜索关键词"},option:{type:Array,default:()=>[]},selectAll:{type:Boolean,default:()=>!1},required:{type:Boolean,default:()=>!1},filterSearch:{type:Boolean,default:()=>!1}}},m=a(40089);const f=(0,m.Z)(d,[["render",u]]);var g=f},88575:function(e,t,a){a.d(t,{Z:function(){return b}});var i=a(73396),l=a(87139);const n={style:{position:"relative",top:"3px","margin-left":"6px","font-size":"14px"}},s=(0,i._)("span",null,"第",-1),o={style:{"padding-left":"1px","padding-right":"1px"}},r=(0,i._)("span",{style:{"margin-right":"3px"}},"页",-1),c=(0,i._)("span",null,"共",-1),h={style:{"padding-left":"1px","padding-right":"1px"}},u=(0,i._)("span",{style:{"margin-right":"3px"}},"页",-1),p=(0,i._)("span",null,"总",-1),d={style:{"padding-left":"1px","padding-right":"1px"}},m=(0,i._)("span",null,"条",-1),f={style:{position:"relative",top:"1px","margin-left":"0px"}},g={key:2,class:"text-center",style:{"padding-top":"12px"}};function w(e,t,a,w,k,y){const _=(0,i.up)("v-icon"),x=(0,i.up)("v-btn"),v=(0,i.up)("v-card");return(0,i.wg)(),(0,i.iD)("span",null,[e.paging&&a.pagingShow?((0,i.wg)(),(0,i.j4)(v,{key:0,elevation:"0",style:{"margin-bottom":"0px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{variant:"outlined",size:"x-small",icon:"",color:"primary",style:{"margin-right":"6px",width:"28px",height:"28px"},onClick:y.previousHandle},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{size:"28"},{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-chevron-left")])),_:1})])),_:1},8,["onClick"]),(0,i.Wm)(x,{variant:"outlined",size:"x-small",icon:"",color:"primary",style:{width:"28px",height:"28px"},onClick:y.nextHandle},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{size:"28"},{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-chevron-right")])),_:1})])),_:1},8,["onClick"]),(0,i._)("span",n,[s,(0,i._)("span",o,(0,l.zw)(e.current),1),r,c,(0,i._)("span",h,(0,l.zw)(e.page),1),u,p,(0,i._)("span",d,(0,l.zw)(e.totalNum),1),m]),(0,i._)("span",f,[a.showSearchBtn?((0,i.wg)(),(0,i.j4)(x,{key:0,style:{"padding-left":"8px","padding-right":"4px"},onClick:y.searchClick,variant:"plain",color:"primary"},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{size:"24",icon:"mdi-magnify"}),(0,i.Uk)(" 查询 ")])),_:1},8,["onClick"])):(0,i.kq)("",!0),(0,i.Wm)(x,{onClick:y.refreshClick,style:(0,l.j5)(["min-width: 42px;width: 42px",{padding:"0"}]),variant:"plain",color:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)(" 刷新 ")])),_:1},8,["onClick"])])])),_:1})):(0,i.kq)("",!0),e.items.length?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(e.items,((t,a)=>(0,i.WI)(e.$slots,"tableBody",{key:a,items:t,_index:a}))),128)):((0,i.wg)(),(0,i.iD)("p",g,[(0,i.Wm)(_,{icon:"mdi-emoticon-sad-outline"}),(0,i.Uk)(" 无数据！ ")]))])}var k=a(21801),y=a(37184);var _=a(20868),x={components:{},emits:["searchClick","refresh"],data:()=>({totalNum:0,current:1,page:0,paging:!0,items:[]}),created(){const{auto:e,url:t}=this;e&&t&&this.initFunc()},methods:{previousHandle(){const{current:e}=this;1!=e?(this.current=e-1,this.$nextTick((()=>{this.initFunc(this.current)}))):(0,_.LJ)("第一页！")},nextHandle(){const{current:e,page:t}=this;e>=t?(0,_.LJ)("最后一页！"):(this.current=e+1,this.$nextTick((()=>{this.initFunc(this.current)})))},async initFunc(e=1,t){const{url:a,params:i={},children:l,method:n,formatData:s}=this;if(l)return this.items=l,void(this.paging=!1);const o=(0,k.Z)((0,k.Z)({pageNum:e,pageSize:10},i),t),{code:r,total:c=0,msg:h="",data:u,rows:p}=await(0,y.i)({method:n,url:a,payload:"post"==n?o:{},url_params:"get"==n?o:{}});200==r&&(this.totalNum=c,this.current=e,this.page=Math.ceil(c/o.pageSize),this.items=s?s(u||p||[]):u||p||[])},refreshClick(){const{refreshFunc:e}=this;!e&&this.initFunc(1),this.$emit("refresh")},searchClick(){this.$emit("searchClick")},resultData(){return this.items||[]},selectAll(){this.items=this.items.map((e=>Object.assign(e,{_checked:!0})))}},props:{method:{type:String,default:()=>"get"},refreshFunc:{type:Boolean,default:()=>!1},showSearchBtn:{type:Boolean,default:()=>!1},auto:{type:Boolean,default:()=>!0},pagingShow:{type:Boolean,default:()=>!0},children:{type:Array,default:()=>{}},url:{type:String,default:()=>""},params:{type:Object,default:()=>{}},formatData:{}}},v=a(40089);const C=(0,v.Z)(x,[["render",w]]);var b=C},14085:function(e,t,a){a.r(t),a.d(t,{default:function(){return R}});var i=a(21801),l=a(73396),n=a(87139);const s=(0,l._)("span",{class:"font-weight-medium"},"点检设备",-1),o={class:"font-weight-medium text-left text-teal-lighten-1",color:"primary"},r={class:"font-weight-light"},c=(0,l._)("span",{class:"font-weight-medium text"},"单据编号: ",-1),h={class:"text-teal-lighten-1"},u={class:"font-weight-light"},p=(0,l._)("span",{class:"font-weight-medium text"},"点检类型: ",-1),d={class:"font-weight-light"},m=(0,l._)("span",{class:"font-weight-medium text"},"设备类型: ",-1),f={class:"font-weight-light"},g=(0,l._)("span",{class:"font-weight-medium text"},"申请时间: ",-1),w={class:"font-weight-light"},k=(0,l._)("span",{class:"font-weight-medium text"},"状态: ",-1),y=(0,l._)("span",{class:"font-weight-medium"},"点检设备",-1),_={class:"font-weight-medium text-left text-teal-lighten-1",color:"primary"},x={class:"text-truncate font-weight-light"},v=(0,l._)("span",{class:"font-weight-medium text"},"点检类型: ",-1),C={class:"text-truncate font-weight-light"},b=(0,l._)("span",{class:"font-weight-medium text"},"申请人: ",-1),S={class:"text-truncate font-weight-light"},W=(0,l._)("span",{class:"font-weight-medium text"},"申请时间: ",-1),B={key:0,class:"hide-select-equipment-input"};function T(e,t,a,T,$,O){const H=(0,l.up)("AppBarPage"),q=(0,l.up)("v-badge"),V=(0,l.up)("v-col"),F=(0,l.up)("v-row"),N=(0,l.up)("v-card"),U=(0,l.up)("TableComponents"),j=(0,l.up)("v-window-item"),D=(0,l.up)("ScanBarComponents"),I=(0,l.up)("v-btn"),P=(0,l.up)("v-window"),L=(0,l.up)("SearchPage1"),z=(0,l.up)("SearchPage2"),A=(0,l.up)("SelectComponents");return(0,l.wg)(),(0,l.iD)("span",null,[(0,l.Wm)(H),(0,l.Wm)(P,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{value:"1",class:"v-window-item-table"},{default:(0,l.w5)((()=>["1"==e.tab?((0,l.wg)(),(0,l.j4)(U,{key:0,ref:"table1",url:"/iiot/checkTask/list",showSearchBtn:!0,params:(0,i.Z)({params:{typeList:["dj"]},taskState:"",tmBasEquipments:e.tmBasEquipments},e.pageSearchConfig1),method:"post",refreshFunc:"",onSearchClick:O.searchClick1,onRefresh:O.refreshTable},{tableBody:(0,l.w5)((e=>[(0,l.Wm)(N,null,{default:(0,l.w5)((()=>[(0,l.Wm)(F,{"no-gutters":"",class:"table-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"1"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{content:e._index+1,color:"primary",inline:""},null,8,["content"])])),_:2},1024),(0,l.Wm)(V,{cols:"5"},{default:(0,l.w5)((()=>[s])),_:1}),(0,l.Wm)(V,{cols:"3"})])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",o,(0,n.zw)(e.items.equipmentName),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",r,[c,(0,l._)("span",h,(0,n.zw)(e.items.taskNo),1)])])),_:2},1024)])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",u,[p,(0,l.Uk)(" "+(0,n.zw)(O.FormatDictionary("CHECK_TYPE",e.items.taskType)["lable"]),1)])])),_:2},1024),(0,l.Wm)(V,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",d,[m,(0,l.Uk)(" "+(0,n.zw)(e.items.equipmentType),1)])])),_:2},1024)])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",f,[g,(0,l.Uk)(" "+(0,n.zw)(e.items.createDate),1)])])),_:2},1024)])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",w,[k,(0,l.Uk)(" "+(0,n.zw)(O.FormatDictionary("CHECK_STATE",e.items.taskState)["lable"]),1)])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:1},8,["params","onSearchClick","onRefresh"])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(j,{value:"2",class:"v-window-item-table"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{ref:"scanBar2",placeholder:"扫描或输入 区域码",onSearchClick:O.barSearchClick2},null,8,["onSearchClick"]),"2"==e.tab?((0,l.wg)(),(0,l.j4)(U,{key:0,ref:"table2",url:"/iiot/checkTask/listForApp",showSearchBtn:!0,params:(0,i.Z)({params:{typeList:["dj"]},taskState:"C",tmBasEquipments:e.tmBasEquipments},e.pageSearchConfig2),method:"post",onSearchClick:O.searchClick2,refreshFunc:"",onRefresh:O.refreshTable},{tableBody:(0,l.w5)((e=>[(0,l.Wm)(N,null,{default:(0,l.w5)((()=>[(0,l.Wm)(F,{"no-gutters":"",class:"table-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"1"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{content:e._index+1,color:"primary",inline:""},null,8,["content"])])),_:2},1024),(0,l.Wm)(V,{cols:"5"},{default:(0,l.w5)((()=>[y])),_:1}),(0,l.Wm)(V,{cols:"1"})])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",_,(0,n.zw)(e.items.equipmentName),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"6"},{default:(0,l.w5)((()=>[(0,l._)("p",x,[v,(0,l.Uk)(" "+(0,n.zw)(O.FormatDictionary("CHECK_TYPE",e.items.taskType)["lable"]),1)])])),_:2},1024),(0,l.Wm)(V,{cols:"6"},{default:(0,l.w5)((()=>[(0,l._)("p",C,[b,(0,l.Uk)(" "+(0,n.zw)(e.items.createBy),1)])])),_:2},1024)])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",S,[W,(0,l.Uk)(" "+(0,n.zw)(e.items.createDate),1)])])),_:2},1024)])),_:2},1024),(0,l.Wm)(F,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{cols:"4",class:"text-center"}),(0,l.Wm)(V,{cols:"4",class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{onClick:t=>O.cancelHandle(e),color:"error mt-1",density:"compact",rounded:0,variant:"plain"},{default:(0,l.w5)((()=>[(0,l.Uk)("取消点检")])),_:2},1032,["onClick"])])),_:2},1024),(0,l.Wm)(V,{cols:"4",class:"text-right"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{onClick:t=>O.experienceEdit(e),color:"orange mt-1",density:"compact",rounded:0,variant:"plain"},{default:(0,l.w5)((()=>[(0,l.Uk)("点检")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:1},8,["params","onSearchClick","onRefresh"])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(L,{ref:"searchPage1",hideStatus:!1,onResetHandle:O.resetHandle1,onSearchHandle:O.searchHandle1},null,8,["onResetHandle","onSearchHandle"]),(0,l.Wm)(z,{ref:"searchPage2",hideStatus:!1,onResetHandle:O.resetHandle2,onSearchHandle:O.searchHandle2},null,8,["onResetHandle","onSearchHandle"]),e.showSelect?((0,l.wg)(),(0,l.iD)("span",B,[(0,l.Wm)(A,{ref:"selectContent",label:"设备",placeholderSearch:"请输入设备编号",forbidShow:!0,required:"",showSearch:"",multiple:"",option:e.equipmentSelectOption,onOnSearchChange:O.equipmentSearchChange,onOnChange:O.equipmentConfirm},null,8,["option","onOnSearchChange","onOnChange"])])):(0,l.kq)("",!0)])}a(57658),a(38862),a(73210);var $=a(76496),O=a(88575),H=a(73378),q=a(2243),V=a(89337),F=a(37184);const N=(0,l._)("div",{style:{height:"36px"}},null,-1),U={style:{"margin-top":"32px"}};function j(e,t,a,i,n,s){const o=(0,l.up)("van-field"),r=(0,l.up)("v-btn"),c=(0,l.up)("van-cascader"),h=(0,l.up)("van-popup"),u=(0,l.up)("SelectComponents"),p=(0,l.up)("v-col"),d=(0,l.up)("v-row");return(0,l.wg)(),(0,l.iD)("span",null,[(0,l.Wm)(h,{show:e.drawer,"onUpdate:show":t[7]||(t[7]=t=>e.drawer=t),closeable:"",position:"right",style:{padding:"12px",width:"90%",height:"100%"}},{default:(0,l.w5)((()=>[N,(0,l.Wm)(o,{modelValue:e.fieldValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fieldValue=t),"is-link":"",readonly:"",label:"工厂节点",placeholder:"请选择工厂节点",type:"textarea",autocomplete:"off",onClick:t[1]||(t[1]=t=>e.show=!0)},null,8,["modelValue"]),(0,l.Wm)(h,{show:e.show,"onUpdate:show":t[4]||(t[4]=t=>e.show=t),round:"",position:"bottom"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{block:"",color:"cyan",elevation:"0",style:{"border-radius":"0px"},onClick:t[2]||(t[2]=()=>e.show=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)(" 确定 ")])),_:1}),e.hideFactory?((0,l.wg)(),(0,l.j4)(c,{key:0,title:"请选择工厂节点",options:e.options,"active-color":"#4CAF50","field-names":{text:"nodeLevelName",value:"tmBasNodeLevelId",children:"children"},onClose:t[3]||(t[3]=t=>e.show=!1),onChange:s.onFinish},null,8,["options","onChange"])):(0,l.kq)("",!0)])),_:1},8,["show"]),(0,l.Wm)(u,{modelValue:e.property,"onUpdate:modelValue":t[5]||(t[5]=t=>e.property=t),ref:"select2",label:"状态",option:e.propertySelectOption},null,8,["modelValue","option"]),(0,l._)("div",U,[(0,l.Wm)(d,{"no-gutters":""},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{cols:"4",class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{onClick:t[6]||(t[6]=()=>e.drawer=!1),density:"compact",variant:"plain"},{default:(0,l.w5)((()=>[(0,l.Uk)("关闭")])),_:1})])),_:1}),(0,l.Wm)(p,{cols:"4",class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{onClick:s.resetClick,density:"compact",color:"warning",variant:"plain"},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1},8,["onClick"])])),_:1}),(0,l.Wm)(p,{cols:"4",class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{onClick:s.searchClick,density:"compact",color:"primary",variant:"plain"},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1},8,["show"])])}var D=a(5878),I={components:{SelectComponents:q.Z},emits:["searchHandle","resetHandle"],data:()=>({hideFactory:!0,drawer:!1,show:!1,fieldValue:"",options:[],factoryID:"",type:"",typeSelectOption:[],property:"",propertySelectOption:[],status:"",statusSelectOption:[]}),created(){this.initFunc()},methods:{FormatDictionary(e="",t=""){const a=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),i=a[e]||[],l=i.filter((e=>t==e.value))[0]||{};return l},resetClick(){this.fieldValue="",this.factoryID="",this.property="",this.$refs.select2&&this.$refs.select2.reset(),this.hideFactory=!1,this.$nextTick((()=>{this.hideFactory=!0})),this.$emit("resetHandle",{})},async initFunc(){const e=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),t=e["CHECK_STATE"]||[];this.propertySelectOption=t.map((e=>Object.assign({text:e.lable,value:e.value})));const{data:a=[]}=await(0,V.jt)(),i=(0,D.b)(a,"tmBasNodeLevelId","parentId");this.options=i},async getTypeHttp(e=""){const{code:t,data:a=[]}=await(0,F.i)({url:"/iiot/abnormalType/listAbnormalTypeForSelect",method:"get",url_params:{abnormalNo:e}});200==t&&(this.typeSelectOption=a.map((e=>Object.assign({text:`${e.abnormalNo}${e.abnormalName}`,value:e.tmBasAbnormalTypeId}))))},onFinish({selectedOptions:e}){if(!e.length)return;let t=(e[e.length-1]||{})["tmBasNodeLevelId"];this.factoryID=t,this.fieldValue=e.map((e=>e.nodeLevelName)).join("/")},searchClick(){const{factoryID:e,type:t,property:a,status:i}=this,l={tmBasNodeLevelId:e,taskState:a};this.$emit("searchHandle",l),this.drawer=!1},showDrawer(){this.drawer=!0}},props:{hideStatus:{type:Boolean,default:()=>!0}}},P=a(40089);const L=(0,P.Z)(I,[["render",j]]);var z=L,A=a(20868),E=a(69650),Z={components:{AppBarPage:$.Z,SearchPage1:z,SearchPage2:z,SelectComponents:q.Z,ScanBarComponents:H.Z,TableComponents:O.Z},data:()=>({tab:"1",bufferTree:[],pageSearchConfig1:{},pageSearchConfig2:{},tmBasEquipments:[],showSelect:!0,tmBasNodeLevelId:"",equipment:"",equipmentSelectOption:[],equipmentSelectOptionData:[]}),created(){this.initFunc(),this.factoryTreeHTTP();const{$emitter:e}=this.$root;e.on("update_examineHistory_page",(()=>{this.initFunc(),this.factoryTreeHTTP(),this.refreshTable()}))},methods:{FormatDictionary(e="",t=""){const a=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),i=a[e]||[],l=i.filter((e=>t==e.value))[0]||{};return l},initFunc(){const{tabs:e}=this.$route.query;e&&(this.tab=e)},refreshTable(){this.$refs["scanBar1"]&&this.$refs["scanBar1"].reset(),this.$refs["scanBar2"]&&this.$refs["scanBar2"].reset(),this.tmBasEquipments=[],this.$nextTick((()=>{"1"==this.tab&&this.$refs.table1.initFunc(1,{}),"2"==this.tab&&this.$refs.table2.initFunc(1,{})}))},async equipmentSearchChange(e=""){this.equipmentHTTP(e)},async equipmentHTTP(e=""){const{tmBasNodeLevelId:t}=this,{code:a,data:i=[]}=await(0,F.i)({url:"/iiot/equipment/list",method:"get",url_params:{tmBasNodeLevelId:t,equipmentNo:e}});200==a&&(this.equipmentSelectOptionData=i,this.equipmentSelectOption=i.map((e=>Object.assign({text:`${e.equipmentNo}-${e.equipmentName}`,value:e.tmBasEquipmentId}))).splice(0,100))},equipmentConfirm(e=""){this.tmBasEquipments=e?e.split(","):[],this.$nextTick((()=>{"1"==this.tab&&this.$refs.table1.initFunc(1,{}),"2"==this.tab&&this.$refs.table2.initFunc(1,{})}))},async factoryTreeHTTP(){const{data:e=[]}=await(0,V.jt)();this.bufferTree=e},async experienceEditTo(e){const{items:t}=e,{code:a}=await(0,F.i)({url:"/iiot/checkTask/checkTask",method:"post",payload:{ttCheckTaskId:t.ttCheckTaskId}});200==a&&((0,A.XA)("提交成功！"),this.tab="1",this.$nextTick((()=>{this.$refs.table1.initFunc()})))},async experienceEdit(e){const{items:t}=e;this.$router.push({path:"/examineHistory/detail",query:{ttCheckTaskId:t.ttCheckTaskId,row:JSON.stringify(t)}}),setTimeout((()=>{this.$root.$emitter.emit("update_examineHistory_page_index")}),1e3)},async cancelHandle(e){const{items:t}=e;(0,E.vC)({title:"取消确认",message:"取消后数据不可恢复，确认取消！",theme:"round-button",closeOnClickOverlay:!0}).then((async()=>{const{code:e}=await(0,F.i)({url:"/iiot/checkTask",method:"PUT",payload:{ttCheckTaskId:t.ttCheckTaskId,taskState:"N"}});200==e&&((0,A.XA)("提交成功！"),this.tab="1",this.$nextTick((()=>{this.$refs.table1.initFunc()})))}))},async barSearchClick(e=""){const t=e.trim(),a=this.bufferTree.filter((e=>e.nodeLevelNo==t))[0]||{};a.tmBasNodeLevelId?(this.showSelect=!1,this.tmBasNodeLevelId=a.tmBasNodeLevelId,this.$nextTick((async()=>{this.showSelect=!0,await this.equipmentHTTP(""),this.$nextTick((()=>{this.$refs.selectContent.showModle()}))}))):(0,A.LJ)("无工厂节点！")},async barSearchClick2(e=""){const t=e.trim(),a=this.bufferTree.filter((e=>e.nodeLevelNo==t))[0]||{};a.tmBasNodeLevelId?(this.showSelect=!1,this.tmBasNodeLevelId=a.tmBasNodeLevelId,this.$nextTick((async()=>{this.showSelect=!0,await this.equipmentHTTP(""),this.$nextTick((()=>{this.$refs.selectContent.showModle()}))}))):(0,A.LJ)("无工厂节点！")},searchClick1(){this.$refs.searchPage1.showDrawer()},searchHandle1(e){this.pageSearchConfig1=e,this.$nextTick((()=>{this.$refs.table1.initFunc(1)}))},resetHandle1(e){this.pageSearchConfig1={},this.$nextTick((()=>{this.$refs.table1.initFunc(1)}))},searchClick2(){this.$refs.searchPage2.showDrawer()},searchHandle2(e){this.pageSearchConfig2=e,this.$nextTick((()=>{this.$refs.table2.initFunc(1)}))},resetHandle2(e){this.pageSearchConfig2={},this.$nextTick((()=>{this.$refs.table2.initFunc(1)}))}}};const J=(0,P.Z)(Z,[["render",T]]);var R=J},69650:function(e,t,a){a.d(t,{vC:function(){return u}});var i=a(73396),l=a(12220),n=a(57548),s=a(21178);let o;const r={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let c=(0,l.l7)({},r);function h(){const e={setup(){const{state:e,toggle:t}=(0,n.o)();return()=>(0,i.Wm)(s.Z,(0,i.dG)(e,{"onUpdate:show":t}),null)}};({instance:o}=(0,n.H)(e))}function u(e){return l._f?new Promise(((t,a)=>{o||h(),o.open((0,l.l7)({},c,e,{callback:e=>{("confirm"===e?t:a)(e)}}))})):Promise.resolve()}}}]);
//# sourceMappingURL=chunk.455.1689579771365.js.map