"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[1972],{89337:function(e,t,l){l.d(t,{$w:function(){return s},AT:function(){return o},NM:function(){return r},ew:function(){return u},jt:function(){return i},vU:function(){return n}});var a=l(37184);const i=async(e={})=>await(0,a.i)({url:"/iiot/nodeLevel/list",method:"get",url_params:e}),o=async e=>await(0,a.i)({url:"/iiot/faultType/list?enabled=1",method:"get"}),n=async e=>await(0,a.i)({url:"/iiot/fault/list?enabled=1",method:"get"}),u=async e=>await(0,a.i)({url:"/system/dict/data/type/equipment_repair_type",method:"get"}),r=async e=>await(0,a.i)({url:"/iiot/equipmentRepair/userList?enabled=1",method:"post"}),s=async e=>await(0,a.i)({url:"/iiot/equipmentRepair/confirmRepairWbForApp",method:"post",payload:e.payload})},2243:function(e,t,l){l.d(t,{Z:function(){return w}});var a=l(73396),i=l(87139);const o={style:{height:"98%","padding-bottom":"40px"}},n={style:{height:"100%"}},u={style:{position:"relative",top:"4px"}},r=["onClick"],s={class:"text-truncate",style:{height:"24px"}},c={key:2,class:"text-center",style:{"margin-top":"16px"}};function d(e,t,l,d,m,p){const f=(0,a.up)("van-field"),h=(0,a.up)("v-col"),w=(0,a.up)("v-btn"),g=(0,a.up)("v-row"),v=(0,a.up)("van-search"),b=(0,a.up)("van-checkbox"),k=(0,a.up)("van-popup");return(0,a.wg)(),(0,a.iD)("span",null,[(0,a.Wm)(f,{modelValue:e.fieldValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fieldValue=t),"is-link":"",readonly:"",required:l.required,label:l.label,placeholder:l.placeholder,autocomplete:"off",type:l.multiple?"textarea":"text",onClick:p.fieldClick},null,8,["modelValue","required","label","placeholder","type","onClick"]),(0,a.Wm)(k,{show:e.showPicker,"onUpdate:show":t[5]||(t[5]=t=>e.showPicker=t),style:{padding:"12px 12px 4px 12px",height:"60%",width:"90%"},round:""},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("div",n,[(0,a.Wm)(g,{"no-gutters":"",style:{"font-weight":"bold","border-bottom":"1px solid #ccc","padding-bottom":"5px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{cols:"6"},{default:(0,a.w5)((()=>[(0,a._)("p",null,(0,i.zw)(l.label)+"-选择框",1)])),_:1}),(0,a.Wm)(h,{cols:"6",class:"text-right"},{default:(0,a.w5)((()=>[(0,a._)("span",u,(0,i.zw)(e.BufferOption.filter((e=>e._checked)).length),1),l.selectAll?((0,a.wg)(),(0,a.j4)(w,{key:0,onClick:p.selectAllHandle,color:"primary mt-1",density:"compact",rounded:0,variant:"plain"},{default:(0,a.w5)((()=>[(0,a.Uk)("全选")])),_:1},8,["onClick"])):(0,a.kq)("",!0)])),_:1})])),_:1}),l.showSearch?((0,a.wg)(),(0,a.j4)(g,{key:0,"no-gutters":""},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{cols:"8"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{modelValue:e.valueSearch,"onUpdate:modelValue":t[1]||(t[1]=t=>e.valueSearch=t),shape:"",placeholder:l.placeholderSearch,style:{"padding-left":"0px"},clearable:!1},null,8,["modelValue","placeholder"])])),_:1}),(0,a.Wm)(h,{cols:"2"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{onClick:t[2]||(t[2]=e=>p.searchHandle(!0)),variant:"plain",color:"primary",block:"",style:{"margin-top":"8px"}},{default:(0,a.w5)((()=>[(0,a.Uk)(" 查询 ")])),_:1})])),_:1}),(0,a.Wm)(h,{cols:"2"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{onClick:t[3]||(t[3]=e=>p.searchHandle(!1)),variant:"plain",block:"",style:{"margin-top":"8px"}},{default:(0,a.w5)((()=>[(0,a.Uk)(" 重置 ")])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),e.BufferOption.length?((0,a.wg)(),(0,a.iD)("ul",{key:1,style:(0,i.j5)(`height: ${l.showSearch?"73%":"90%"};overflow-y:auto;padding-right:12px;padding-bottom: 20px;`)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.BufferOption,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{key:t,style:(0,i.j5)(`padding: 6px 22px 6px 6px;position:relative;color:${e._searchColor?"#FF9800":"#000"};`),onClick:t=>p.checkChange(e)},[(0,a._)("p",s,(0,i.zw)(e.text),1),(0,a.Wm)(b,{style:{position:"absolute",top:"8px",right:"0px"},modelValue:e._checked,"onUpdate:modelValue":t=>e._checked=t,shape:"square","checked-color":"#4CAF50",disabled:"",class:"custem-select-checkbox"},null,8,["modelValue","onUpdate:modelValue"])],12,r)))),128))],4)):((0,a.wg)(),(0,a.iD)("p",c,"无数据!"))]),(0,a.Wm)(g,{"no-gutters":""},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{cols:"6",class:"text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{variant:"plain",block:"",onClick:t[4]||(t[4]=()=>e.showPicker=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)(" 取消 ")])),_:1})])),_:1}),(0,a.Wm)(h,{cols:"6",class:"text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{variant:"plain",color:"primary",block:"",onClick:p.confirmHandle},{default:(0,a.w5)((()=>[(0,a.Uk)(" 确定 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1},8,["show"])])}l(38862),l(73210),l(26699),l(32023);var m=l(20868),p={components:{},emits:["update:modelValue","onChange","onFieldClick","onSearchChange"],data:()=>({BufferOption:[],selectedValues:[],columns:[],fieldValue:"",showPicker:!1,valueSearch:""}),watch:{option:{handler(e=[]){this.BufferOption=JSON.parse(JSON.stringify(e)),this.$nextTick((()=>{this.modelValue&&this.setValue(this.modelValue)}))},deep:!0,immediate:!0},showPicker:{handler(e){this.$nextTick((()=>{if(e&&this.modelValue)if(this.multiple){const e=this.modelValue.split(",")||[];e.map((e=>{this.BufferOption.map((t=>{var l=t;return t.value==e&&(l._checked=!0),l}))}))}else this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==this.modelValue})))}))},deep:!0,immediate:!0}},methods:{showModle(){this.showPicker=!0},fieldClick(){this.disabled||(this.forbidShow||(this.showPicker=!0),this.$emit("onFieldClick"))},setfieldValue(e=""){this.fieldValue=e},reset(){this.fieldValue="",this.BufferOption.map((e=>Object.assign(e,{_checked:!1}))),this.$emit("update:modelValue","")},setValue(e=""){if(this.multiple){const t=e.split(",")||[];t.map((e=>{this.BufferOption.map((t=>{var l=t;return t.value==e&&(l._checked=!0),l}))})),this.fieldValue=this.BufferOption.filter((e=>e._checked)).map((e=>e.text)).join()}else{const t=JSON.parse(JSON.stringify(this.BufferOption)).filter((t=>t.value==e))[0]||{};this.fieldValue=t.text}},confirmHandle(){const{multiple:e}=this,t=this.BufferOption.filter((e=>1==e._checked));e?(this.fieldValue=t.map((e=>e.text)).join(),this.$emit("update:modelValue",t.map((e=>e.value)).join()||""),this.$emit("onChange",t.map((e=>e.value)).join())):(this.fieldValue=(t[0]||{}).text,this.$emit("update:modelValue",(t[0]||{}).value||""),this.$emit("onChange",(t[0]||{}).value,t[0]||{})),this.showPicker=!1},checkChange(e){const{multiple:t}=this,{_checked:l,value:a}=e;t?this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==a?!l:e._checked}))):this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==a&&!l})))},multipleHandle(){const e=this.BufferOption.filter((e=>e._checked)),t=e.map((e=>e.value)).join();this.showPicker=!1,this.fieldValue=e.map((e=>e.text)).join(),this.$emit("update:modelValue",t),this.$emit("onChange",e)},searchHandle(e){const t=this.valueSearch.trim(),{filterSearch:l}=this;if(l&&e){const e=this.BufferOption.map((e=>Object.assign(e,{_searchColor:!1}))),l=e.filter((e=>e.text.includes(t))).map((e=>Object.assign(e,{_searchColor:!0})));if(!l.length)return void(0,m.LJ)("不存在！");const a=e.filter((e=>!e.text.includes(t))),i=a.filter((e=>e._checked)),o=a.filter((e=>!e._checked));this.BufferOption=l.concat(i).concat(o)}else e?this.$emit("onSearchChange",t):(this.valueSearch="",this.BufferOption=this.option,this.$nextTick((()=>{this.BufferOption=this.BufferOption.map((e=>Object.assign(e,{_checked:!1})))})),this.$emit("onSearchChange",""))},selectAllHandle(){this.BufferOption.map((e=>Object.assign(e,{_checked:!0})))}},props:{modelValue:{},disabled:{type:Boolean,default:()=>!1},showSearch:{type:Boolean,default:()=>!1},forbidShow:{type:Boolean,default:()=>!1},multiple:{type:Boolean,default:()=>!1},label:{type:String,default:()=>"标题"},placeholder:{type:String,default:()=>"请选择"},placeholderSearch:{type:String,default:()=>"请输入搜索关键词"},option:{type:Array,default:()=>[]},selectAll:{type:Boolean,default:()=>!1},required:{type:Boolean,default:()=>!1},filterSearch:{type:Boolean,default:()=>!1}}},f=l(40089);const h=(0,f.Z)(p,[["render",d]]);var w=h},57265:function(e,t,l){l.d(t,{Z:function(){return w}});var a=l(73396);const i={style:{padding:"0px 12px 0px 12px"}},o={key:0,class:"font-weight-medium text",style:{"margin-bottom":"8px"}},n={key:1,style:{"margin-bottom":"8px"},class:"font-weight-medium text"},u={class:"custem-iamge-upload"},r=["src"];function s(e,t,l,s,c,d){const m=(0,a.up)("van-uploader"),p=(0,a.up)("v-icon");return(0,a.wg)(),(0,a.iD)("span",null,[(0,a._)("div",i,[l.preview?((0,a.wg)(),(0,a.iD)("p",o,"图片预览 ")):((0,a.wg)(),(0,a.iD)("p",n," 图片上传 ")),l.preview?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:2,"after-read":d.afterRead,"preview-image":!1},null,8,["after-read"])),(0,a._)("div",u,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.bufferFileList,((i,o)=>((0,a.wg)(),(0,a.iD)("li",{key:o,onClick:t[0]||(t[0]=t=>d.checkImage(e.bufferFileList))},[(0,a._)("img",{src:i.url},null,8,r),l.preview?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(p,{key:0,onClick:e=>d.removeClick(i,e),class:"icon",icon:"mdi-close-circle-outline",color:"red"},null,8,["onClick"]))])))),128))])])])}l(26699),l(32023),l(38862);var c=l(37184),d=l(20868),m=l(9801),p={components:{},emits:["update:modelValue","onChange"],data:()=>({bufferFileList:[]}),watch:{modelValue:{handler(e=[]){this.bufferFileList=e},deep:!0,immediate:!0},initPath:{handler(e=""){e&&(this.bufferFileList=e.split(",").map((e=>Object.assign({url:e}))))},deep:!0,immediate:!0}},methods:{checkImage(e=[]){e.length&&(0,m.V)(e.map((e=>e.url)))},async afterRead(e){if(!e.file.type.includes("image"))return void(0,d.LJ)("只能选择图片！");if(e.file.size>=19922944)return void(0,d.LJ)("图片超过20M！");if(this.bufferFileList.length>2)return void(0,d.LJ)("最多只能选择3张图片！");let t=new FormData;t.append("file",e.file);const{code:l,data:a={}}=await(0,c.i)({url:"/file/upload",method:"post",formData:!0,payload:t});200==l?(this.bufferFileList=this.bufferFileList.concat([a]),(0,d.XA)("图片上传成功！"),this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.bufferFileList)))):(0,d.LJ)("图片上传失败！")},removeClick(e,t){t.stopPropagation(),this.bufferFileList=JSON.parse(JSON.stringify(this.bufferFileList)).filter((t=>t.url!=e.url)),this.$nextTick((()=>{this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.bufferFileList)))}))}},props:{modelValue:{type:Array,default:()=>[]},initPath:{type:String,default:()=>""},preview:{type:Boolean,default:()=>!1}}},f=l(40089);const h=(0,f.Z)(p,[["render",s]]);var w=h},81972:function(e,t,l){l.r(t),l.d(t,{default:function(){return P}});l(33948);var a=l(73396),i=l(87139);const o=(0,a._)("span",{style:{"padding-left":"6px"}},"设备维修信息",-1),n={class:"font-weight-medium text-left text-teal-lighten-1",color:"primary"},u=(0,a._)("span",{class:"font-weight-medium"},"报修信息",-1),r=(0,a._)("p",{class:"font-weight-medium text"},"故障类型:",-1),s={class:"text-truncate font-weight-light"},c=(0,a._)("p",{class:"font-weight-medium text"},"故障位置:",-1),d={class:"text-truncate font-weight-light"},m=(0,a._)("p",{class:"font-weight-medium text"},"故障详情描述:",-1),p=(0,a._)("p",{class:"font-weight-medium text"},"维修类型:",-1),f={class:"text-truncate font-weight-light"},h=(0,a._)("p",{class:"font-weight-medium text"},"报修人:",-1),w={class:"text-truncate font-weight-light"},g=(0,a._)("p",{class:"font-weight-medium text"},"报修时间:",-1),v={class:"text-truncate font-weight-light"},b=(0,a._)("p",{class:"font-weight-medium text"},"响应人:",-1),k={class:"text-truncate font-weight-light"},_=(0,a._)("p",{class:"font-weight-medium text"},"响应时间:",-1),y={class:"text-truncate font-weight-light"},x=(0,a._)("span",{class:"font-weight-medium"},"维修确认",-1),V=(0,a._)("span",{class:"font-weight-medium"},"维修报告",-1),W=(0,a._)("div",{style:{height:"120px"}},null,-1);function C(e,t,l,C,O,B){const S=(0,a.up)("AppBarPage"),R=(0,a.up)("v-icon"),U=(0,a.up)("v-col"),q=(0,a.up)("v-row"),F=(0,a.up)("UploaderImageComponents"),$=(0,a.up)("v-sheet"),L=(0,a.up)("van-field"),A=(0,a.up)("v-btn"),I=(0,a.up)("van-switch"),j=(0,a.up)("SelectComponents");return(0,a.wg)(),(0,a.iD)("span",null,[(0,a.Wm)(S),(0,a.Wm)(q,{"no-gutters":"",style:{"margin-bottom":"2px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"12"},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{icon:"mdi-tools",size:"16",color:"#3F51B5"}),o])),_:1})])),_:1}),(0,a.Wm)(q,{"no-gutters":"",style:{"margin-bottom":"4px","padding-left":"6px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"12"},{default:(0,a.w5)((()=>[(0,a._)("span",n,(0,i.zw)(e.bufferRow.equipmentName),1)])),_:1})])),_:1}),(0,a.Wm)($,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{"no-gutters":"",class:"custem-card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"6"},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{icon:"mdi-bullhorn",size:"16",color:"primary"}),u])),_:1})])),_:1}),(0,a.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[r])),_:1}),(0,a.Wm)(U,{cols:"8"},{default:(0,a.w5)((()=>[(0,a._)("p",s,(0,i.zw)(e.bufferRow.faultTypeCn),1)])),_:1})])),_:1}),(0,a.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[c])),_:1}),(0,a.Wm)(U,{cols:"8"},{default:(0,a.w5)((()=>[(0,a._)("p",d,(0,i.zw)(e.bufferRow.faultStationCn),1)])),_:1})])),_:1}),(0,a.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[m])),_:1}),(0,a.Wm)(U,{cols:"8"},{default:(0,a.w5)((()=>[(0,a._)("p",{class:"text-truncate font-weight-light",onClick:t[0]||(t[0]=t=>B.GlobalTooltipFunc(e.bufferRow.problemDesc))},(0,i.zw)(e.bufferRow.problemDesc),1)])),_:1})])),_:1}),(0,a.Wm)(F,{modelValue:e.bufferFileListPreviewInitiatePath,"onUpdate:modelValue":t[1]||(t[1]=t=>e.bufferFileListPreviewInitiatePath=t),preview:""},null,8,["modelValue"]),(0,a.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[p])),_:1}),(0,a.Wm)(U,{cols:"8"},{default:(0,a.w5)((()=>[(0,a._)("p",f,(0,i.zw)(B.FormatDictionary("equipment_repair_type",e.bufferRow.reportType)["lable"]),1)])),_:1})])),_:1}),(0,a.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[h])),_:1}),(0,a.Wm)(U,{cols:"8"},{default:(0,a.w5)((()=>[(0,a._)("p",w,(0,i.zw)(e.bufferRow.reportBy),1)])),_:1})])),_:1}),(0,a.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[g])),_:1}),(0,a.Wm)(U,{cols:"8"},{default:(0,a.w5)((()=>[(0,a._)("p",v,(0,i.zw)(e.bufferRow.reportTime),1)])),_:1})])),_:1}),(0,a.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[b])),_:1}),(0,a.Wm)(U,{cols:"8"},{default:(0,a.w5)((()=>[(0,a._)("p",k,(0,i.zw)(e.bufferRow.responseBy),1)])),_:1})])),_:1}),(0,a.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[_])),_:1}),(0,a.Wm)(U,{cols:"8"},{default:(0,a.w5)((()=>[(0,a._)("p",y,(0,i.zw)(e.bufferRow.responseTime),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(L,{modelValue:e.reasonCancellation,"onUpdate:modelValue":t[2]||(t[2]=t=>e.reasonCancellation=t),required:"",label:"取消原因",placeholder:"请输入",autocomplete:"off"},null,8,["modelValue"]),(0,a.Wm)(A,{style:{"margin-bottom":"8px"},onClick:B.cancelReimbursement,block:"",color:"error",variant:"outlined"},{default:(0,a.w5)((()=>[(0,a.Uk)(" 取消报修 ")])),_:1},8,["onClick"]),(0,a.Wm)($,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{"no-gutters":"",class:"custem-card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"6"},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{icon:"mdi-check-bold",size:"16",color:"primary"}),x])),_:1}),(0,a.Wm)(U,{cols:"6"},{default:(0,a.w5)((()=>[(0,a._)("p",{onClick:t[3]||(t[3]=(...e)=>B.checkExpress&&B.checkExpress(...e)),class:"font-weight-medium text-right text-teal-lighten-1",color:"primary"},"查看维修经验")])),_:1})])),_:1}),(0,a.Wm)(L,{name:"switch",placeholder:"请输入",autocomplete:"off",label:"是否外修"},{input:(0,a.w5)((()=>[(0,a.Wm)(I,{modelValue:e.checked,"onUpdate:modelValue":t[4]||(t[4]=t=>e.checked=t)},null,8,["modelValue"])])),_:1}),e.checked?((0,a.wg)(),(0,a.j4)(L,{key:0,modelValue:e.repairUnit,"onUpdate:modelValue":t[5]||(t[5]=t=>e.repairUnit=t),placeholder:"请输入",autocomplete:"off",label:"维修单位"},null,8,["modelValue"])):(0,a.kq)("",!0),e.checked?((0,a.wg)(),(0,a.j4)(L,{key:1,modelValue:e.repairCost,"onUpdate:modelValue":t[6]||(t[6]=t=>e.repairCost=t),type:"number",placeholder:"请输入",autocomplete:"off",label:"维修费用"},null,8,["modelValue"])):(0,a.kq)("",!0),(0,a.Wm)(L,{name:"switch",placeholder:"请输入",autocomplete:"off",label:"是否报废"},{input:(0,a.w5)((()=>[(0,a.Wm)(I,{modelValue:e.checked2,"onUpdate:modelValue":t[7]||(t[7]=t=>e.checked2=t)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(L,{modelValue:e.value,"onUpdate:modelValue":t[8]||(t[8]=t=>e.value=t),placeholder:"请输入",autocomplete:"off",label:"维修人",readonly:""},null,8,["modelValue"]),(0,a.Wm)(j,{modelValue:e.user,"onUpdate:modelValue":t[9]||(t[9]=t=>e.user=t),label:"协助人",showSearch:"",filterSearch:"",multiple:"",option:e.repairmanSelectOption,onOnChange:B.repairmanChange},null,8,["modelValue","option","onOnChange"]),(0,a.Wm)(L,{modelValue:e.time,"onUpdate:modelValue":t[10]||(t[10]=t=>e.time=t),placeholder:"请输入",autocomplete:"off",label:"确认时间",readonly:""},null,8,["modelValue"])])),_:1}),(0,a.Wm)($,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{"no-gutters":"",class:"custem-card-title"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"6"},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{icon:"mdi-file-chart",size:"16",color:"primary"}),V])),_:1}),(0,a.Wm)(U,{cols:"6"})])),_:1}),(0,a.Wm)(L,{modelValue:e.value1,"onUpdate:modelValue":t[11]||(t[11]=t=>e.value1=t),autocomplete:"off",label:"根本问题",placeholder:"请输入",required:""},null,8,["modelValue"]),(0,a.Wm)(L,{modelValue:e.value2,"onUpdate:modelValue":t[12]||(t[12]=t=>e.value2=t),autocomplete:"off",label:"解决措施",placeholder:"请输入"},null,8,["modelValue"]),(0,a.Wm)(L,{modelValue:e.value3,"onUpdate:modelValue":t[13]||(t[13]=t=>e.value3=t),autocomplete:"off",label:"改进建议",placeholder:"请输入"},null,8,["modelValue"]),(0,a.Wm)(L,{modelValue:e.value4,"onUpdate:modelValue":t[14]||(t[14]=t=>e.value4=t),autocomplete:"off",label:"维修用时",type:"number",required:"",placeholder:"请输入"},{button:(0,a.w5)((()=>[(0,a.Uk)(" 分钟 ")])),_:1},8,["modelValue"]),(0,a.Wm)(L,{modelValue:e.value5,"onUpdate:modelValue":t[15]||(t[15]=t=>e.value5=t),autocomplete:"off",label:"维修内容",required:"",placeholder:"请输入"},null,8,["modelValue"]),(0,a.Wm)(L,{modelValue:e.value6,"onUpdate:modelValue":t[16]||(t[16]=t=>e.value6=t),autocomplete:"off",label:"工具",placeholder:"请输入"},null,8,["modelValue"]),(0,a.Wm)(L,{modelValue:e.value8,"onUpdate:modelValue":t[17]||(t[17]=t=>e.value8=t),autocomplete:"off",label:"影响时长",required:"",placeholder:"请输入"},{button:(0,a.w5)((()=>[(0,a.Uk)(" 分钟 ")])),_:1},8,["modelValue"]),(0,a.Wm)(L,{name:"switch",placeholder:"请输入",autocomplete:"off",label:"是否遗留"},{input:(0,a.w5)((()=>[(0,a.Wm)(I,{modelValue:e.checked3,"onUpdate:modelValue":t[18]||(t[18]=t=>e.checked3=t)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(L,{modelValue:e.value7,"onUpdate:modelValue":t[19]||(t[19]=t=>e.value7=t),autocomplete:"off",label:"遗留原因",placeholder:"请输入"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(q,{"no-gutters":"",class:"global-botom-btn-box"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{color:"#00E5FF",onClick:B.onReceiveFunc},{default:(0,a.w5)((()=>[(0,a.Uk)(" 备件领用 ")])),_:1},8,["onClick"])])),_:1}),(0,a.Wm)(U,{cols:"4"}),(0,a.Wm)(U,{cols:"4"},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{color:"primary",onClick:B.onSubmit},{default:(0,a.w5)((()=>[(0,a.Uk)(" 确认维修 ")])),_:1},8,["onClick"])])),_:1}),(0,a.Wm)(U,{cols:"4",class:"text-right"})])),_:1}),W])}l(57658),l(73210),l(38862);var O=l(76496),B=l(2243),S=l(37184),R=l(57265),U=l(20868),q=l(89337),F=l(69650),$=l(36797),L=l.n($),A={components:{AppBarPage:O.Z,UploaderImageComponents:R.Z,SelectComponents:B.Z},data:()=>({bufferFileListPreviewInitiatePath:[],bufferRow:{},reasonCancellation:"",repairUnit:"",repairCost:"",checked:!1,checked2:!1,value:"",user:"",time:"",value1:"",value2:"",value3:"",value4:"",value5:"",value6:"",checked3:!1,value7:"",value8:"",repairmanSelectOption:[]}),created(){const{$emitter:e}=this.$root;e.on("update_maintain_page_index",(()=>{this.initFunc(),this.initRepairman()}))},methods:{GlobalTooltipFunc(e=""){(0,U.CF)({message:e,overlay:!0,closeOnClickOverlay:!0,duration:0})},FormatDictionary(e="",t=""){const l=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),a=l[e]||[],i=a.filter((e=>t==e.value))[0]||{};return i},async initFunc(){const{teAdRepairId:e,filePath:t}=this.$route.query,l=JSON.parse(localStorage.getItem("bufferUserInfo")||"{}");this.value=`${l["userName"]}-${l["nickName"]}`,this.time=L()(new Date).format("YYYY-MM-DD HH:mm");const{code:a,data:i={}}=await(0,S.i)({url:`/iiot/equipmentRepair/equipmentForApp/${e}`,method:"get"});200==a&&(this.bufferRow=i,this.$nextTick((()=>{this.value4=Number(this.bufferRow.repairTime||0),this.value8=Number(this.bufferRow.productAffectTime||0)})),t&&(this.bufferFileListPreviewInitiatePath=t.split(",").map((e=>Object.assign({url:e})))))},checkExpress(){const{bufferRow:e}=this;this.$router.push({path:"/equipment/maintain/experience",query:{state:"1",teAdRepairId:e.teAdRepairId,tmBasEquipmentId:e.tmBasEquipmentId}})},async cancelReimbursement(){const{bufferRow:e}=this,t=this.reasonCancellation.trim();t?(0,F.vC)({title:"取消",message:"取消后数据不可恢复，确认取消！",theme:"round-button",closeOnClickOverlay:!0}).then((async()=>{const{code:l,data:a={}}=await(0,S.i)({url:"/iiot/equipmentRepair/cancelRepairWbForceForApp",method:"post",payload:{teAdRepairId:e.teAdRepairId,cancelReason:t,tmBasEquipmentId:e.tmBasEquipmentId}});200==l&&((0,U.XA)("提交成功！"),this.$router.push({path:"/equipment/maintain",query:{tabs:2}}))})):(0,U.LJ)("取消原因必填！")},async onSubmit(){const{bufferRow:e,checked:t,checked2:l,user:a}=this,{value1:i="",value2:o="",value3:n="",value7:u=""}=this;if(!i.trim())return void(0,U.LJ)("根本问题必填!");if(!Number(this.value4))return void(0,U.LJ)("维修用时必填!");if(!this.value5.trim())return void(0,U.LJ)("维修内容必填!");if(Number(this.value8)<0)return void(0,U.LJ)("影响时长必填!");if(this.checked3&&!u.trim())return void(0,U.LJ)("遗留原因必填!");const r={tmBasEquipmentId:e.tmBasEquipmentId,teAdRepairId:e.teAdRepairId,isRepair:t?1:0,isScrap:l?1:0,helpers:a,repairUnit:this.repairUnit,repairCost:this.repairCost,rootWarin:i,solvingMeasures:o,suggestionsImprovement:n,repairTime:this.value4,repairContent:this.value5,tool:this.value6,productAffectTime:this.value8,isLeave:this.checked3?1:0,leaveReason:this.value7},{code:s,data:c={}}=await(0,S.i)({url:"/iiot/equipmentRepair/repConfirmWbForApp",method:"post",payload:r});200==s&&((0,U.XA)("提交成功！"),this.$router.push({path:"/equipment/maintain",query:{tabs:2}}))},async initRepairman(){const{data:e=[]}=await(0,q.NM)();this.repairmanSelectOption=e.map((e=>Object.assign({text:`${e.userName}-${e.nickName}`,value:e.userId})))},editExperience(){const{bufferRow:e}=this;this.$router.push({path:"/equipment/maintain/experienceEdit",query:{teAdRepairId:e.teAdRepairId}})},repairmanChange(e){},onReceiveFunc(){const{bufferRow:e,value:t}=this;this.$router.push({path:"/replacement/index",query:{activeType:"equipment",row:JSON.stringify(Object.assign(e,{reportBy:t}))}})}}},I=l(40089);const j=(0,I.Z)(A,[["render",C]]);var P=j},69650:function(e,t,l){l.d(t,{vC:function(){return d}});var a=l(73396),i=l(12220),o=l(57548),n=l(21178);let u;const r={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let s=(0,i.l7)({},r);function c(){const e={setup(){const{state:e,toggle:t}=(0,o.o)();return()=>(0,a.Wm)(n.Z,(0,a.dG)(e,{"onUpdate:show":t}),null)}};({instance:u}=(0,o.H)(e))}function d(e){return i._f?new Promise(((t,l)=>{u||c(),u.open((0,i.l7)({},s,e,{callback:e=>{("confirm"===e?t:l)(e)}}))})):Promise.resolve()}}}]);
//# sourceMappingURL=chunk.1972.1689579771365.js.map