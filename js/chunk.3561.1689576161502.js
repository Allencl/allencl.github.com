"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[3561],{89337:function(t,e,a){a.d(e,{$w:function(){return c},AT:function(){return l},NM:function(){return r},ew:function(){return o},jt:function(){return n},vU:function(){return s}});var i=a(37184);const n=async(t={})=>await(0,i.i)({url:"/iiot/nodeLevel/list",method:"get",url_params:t}),l=async t=>await(0,i.i)({url:"/iiot/faultType/list?enabled=1",method:"get"}),s=async t=>await(0,i.i)({url:"/iiot/fault/list?enabled=1",method:"get"}),o=async t=>await(0,i.i)({url:"/system/dict/data/type/equipment_repair_type",method:"get"}),r=async t=>await(0,i.i)({url:"/iiot/equipmentRepair/userList?enabled=1",method:"post"}),c=async t=>await(0,i.i)({url:"/iiot/equipmentRepair/confirmRepairWbForApp",method:"post",payload:t.payload})},5878:function(t,e,a){a.d(e,{b:function(){return i}});a(33948),a(57658);const i=(t,e,a,i)=>{let n={id:e||"id",parentId:a||"parentId",childrenList:i||"children"};var l={},s={},o=[];for(let c of t){let t=c[n.parentId];null==l[t]&&(l[t]=[]),s[c[n.id]]=c,l[t].push(c)}for(let c of t){let t=c[n.parentId];null==s[t]&&o.push(c)}for(let c of o)r(c);function r(t){if(null!==l[t[n.id]]&&(t[n.childrenList]=l[t[n.id]]),t[n.childrenList])for(let e of t[n.childrenList])r(e)}return o}},88575:function(t,e,a){a.d(e,{Z:function(){return C}});var i=a(73396),n=a(87139);const l={style:{position:"relative",top:"3px","margin-left":"6px","font-size":"14px"}},s=(0,i._)("span",null,"第",-1),o={style:{"padding-left":"1px","padding-right":"1px"}},r=(0,i._)("span",{style:{"margin-right":"3px"}},"页",-1),c=(0,i._)("span",null,"共",-1),u={style:{"padding-left":"1px","padding-right":"1px"}},m=(0,i._)("span",{style:{"margin-right":"3px"}},"页",-1),p=(0,i._)("span",null,"总",-1),d={style:{"padding-left":"1px","padding-right":"1px"}},h=(0,i._)("span",null,"条",-1),f={style:{position:"relative",top:"1px","margin-left":"0px"}},g={key:2,class:"text-center",style:{"padding-top":"12px"}};function w(t,e,a,w,_,y){const x=(0,i.up)("v-icon"),v=(0,i.up)("v-btn"),k=(0,i.up)("v-card");return(0,i.wg)(),(0,i.iD)("span",null,[t.paging&&a.pagingShow?((0,i.wg)(),(0,i.j4)(k,{key:0,elevation:"0",style:{"margin-bottom":"0px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{variant:"outlined",size:"x-small",icon:"",color:"primary",style:{"margin-right":"6px",width:"28px",height:"28px"},onClick:y.previousHandle},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{size:"28"},{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-chevron-left")])),_:1})])),_:1},8,["onClick"]),(0,i.Wm)(v,{variant:"outlined",size:"x-small",icon:"",color:"primary",style:{width:"28px",height:"28px"},onClick:y.nextHandle},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{size:"28"},{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-chevron-right")])),_:1})])),_:1},8,["onClick"]),(0,i._)("span",l,[s,(0,i._)("span",o,(0,n.zw)(t.current),1),r,c,(0,i._)("span",u,(0,n.zw)(t.page),1),m,p,(0,i._)("span",d,(0,n.zw)(t.totalNum),1),h]),(0,i._)("span",f,[a.showSearchBtn?((0,i.wg)(),(0,i.j4)(v,{key:0,style:{"padding-left":"8px","padding-right":"4px"},onClick:y.searchClick,variant:"plain",color:"primary"},{default:(0,i.w5)((()=>[(0,i.Wm)(x,{size:"24",icon:"mdi-magnify"}),(0,i.Uk)(" 查询 ")])),_:1},8,["onClick"])):(0,i.kq)("",!0),(0,i.Wm)(v,{onClick:y.refreshClick,style:(0,n.j5)(["min-width: 42px;width: 42px",{padding:"0"}]),variant:"plain",color:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)(" 刷新 ")])),_:1},8,["onClick"])])])),_:1})):(0,i.kq)("",!0),t.items.length?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(t.items,((e,a)=>(0,i.WI)(t.$slots,"tableBody",{key:a,items:e,_index:a}))),128)):((0,i.wg)(),(0,i.iD)("p",g,[(0,i.Wm)(x,{icon:"mdi-emoticon-sad-outline"}),(0,i.Uk)(" 无数据！ ")]))])}var _=a(21801),y=a(37184);var x=a(20868),v={components:{},emits:["searchClick","refresh"],data:()=>({totalNum:0,current:1,page:0,paging:!0,items:[]}),created(){const{auto:t,url:e}=this;t&&e&&this.initFunc()},methods:{previousHandle(){const{current:t}=this;1!=t?(this.current=t-1,this.$nextTick((()=>{this.initFunc(this.current)}))):(0,x.LJ)("第一页！")},nextHandle(){const{current:t,page:e}=this;t>=e?(0,x.LJ)("最后一页！"):(this.current=t+1,this.$nextTick((()=>{this.initFunc(this.current)})))},async initFunc(t=1,e){const{url:a,params:i={},children:n,method:l,formatData:s}=this;if(n)return this.items=n,void(this.paging=!1);const o=(0,_.Z)((0,_.Z)({pageNum:t,pageSize:10},i),e),{code:r,total:c=0,msg:u="",data:m,rows:p}=await(0,y.i)({method:l,url:a,payload:"post"==l?o:{},url_params:"get"==l?o:{}});200==r&&(this.totalNum=c,this.current=t,this.page=Math.ceil(c/o.pageSize),this.items=s?s(m||p||[]):m||p||[])},refreshClick(){const{refreshFunc:t}=this;!t&&this.initFunc(1),this.$emit("refresh")},searchClick(){this.$emit("searchClick")},resultData(){return this.items||[]},selectAll(){this.items=this.items.map((t=>Object.assign(t,{_checked:!0})))}},props:{method:{type:String,default:()=>"get"},refreshFunc:{type:Boolean,default:()=>!1},showSearchBtn:{type:Boolean,default:()=>!1},auto:{type:Boolean,default:()=>!0},pagingShow:{type:Boolean,default:()=>!0},children:{type:Array,default:()=>{}},url:{type:String,default:()=>""},params:{type:Object,default:()=>{}},formatData:{}}},k=a(40089);const W=(0,k.Z)(v,[["render",w]]);var C=W},13561:function(t,e,a){a.r(e),a.d(e,{default:function(){return Z}});var i=a(21801),n=a(73396),l=a(87139);const s={class:"v-window-item-table"},o=(0,n._)("span",{class:"font-weight-medium"},"保养设备",-1),r={class:"font-weight-medium",style:{color:"#00E5FF"}},c=(0,n._)("p",{class:"font-weight-medium text"},"任务类型:",-1),u={class:"text-truncate font-weight-light"},m=(0,n._)("p",{class:"font-weight-medium text"},"策略明细:",-1),p={class:"text-truncate font-weight-light"},d=(0,n._)("p",{class:"font-weight-medium text"},"维护位置:",-1),h=["onClick"],f=(0,n._)("p",{class:"font-weight-medium text"},"维护内容:",-1),g=["onClick"],w=(0,n._)("p",{class:"font-weight-medium text"},"实施内容:",-1),_=["onClick"],y={class:"text-truncate font-weight-medium text"},x=(0,n._)("p",{class:"font-weight-medium text"},"计划人:",-1),v={class:"text-truncate font-weight-light"},k=(0,n._)("p",{class:"font-weight-medium text"},"实施人:",-1),W={class:"text-truncate font-weight-light"},C=(0,n._)("p",{class:"font-weight-medium text"},"实施时间:",-1),S={class:"text-truncate font-weight-light"};function b(t,e,a,b,T,O){const q=(0,n.up)("AppBarPage"),F=(0,n.up)("v-badge"),$=(0,n.up)("v-col"),D=(0,n.up)("v-row"),H=(0,n.up)("v-btn"),N=(0,n.up)("v-card"),B=(0,n.up)("TableComponents"),V=(0,n.up)("SearchPage");return(0,n.wg)(),(0,n.iD)("span",null,[(0,n.Wm)(q),(0,n._)("div",s,[(0,n.Wm)(B,{ref:"table1",showSearchBtn:!0,url:"/iiot/maintain/list",params:(0,i.Z)({},t.pageSearchConfig),onSearchClick:O.searchClick},{tableBody:(0,n.w5)((t=>[(0,n.Wm)(N,null,{default:(0,n.w5)((()=>[(0,n.Wm)(D,{"no-gutters":"",class:"table-title"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"1"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{content:t._index+1,color:"primary",inline:""},null,8,["content"])])),_:2},1024),(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[o])),_:1}),(0,n.Wm)($,{cols:"7"})])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"12"},{default:(0,n.w5)((()=>[(0,n._)("p",r,(0,l.zw)(t.items.equipmentName),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[c])),_:1}),(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",u,(0,l.zw)(O.FormatDictionary("WB_TT",t.items.wbTt)["lable"]),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[m])),_:1}),(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",p,(0,l.zw)(O.FormatDictionary("WB_ST",t.items.wbSt)["lable"]),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[d])),_:1}),(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",{class:"text-truncate font-weight-light",onClick:e=>O.GlobalTooltipFunc(t.items.faultStationCn)},(0,l.zw)(t.items.faultStationCn),9,h)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[f])),_:1}),(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",{onClick:e=>O.GlobalTooltipFunc(t.items.manitainContent),class:"text-truncate font-weight-light"},(0,l.zw)(t.items.manitainContent),9,g)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[w])),_:1}),(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",{class:"text-truncate font-weight-light",onClick:e=>O.GlobalTooltipFunc(t.items.implementContent)},(0,l.zw)(t.items.implementContent),9,_)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",y,"额定工时: "+(0,l.zw)(t.items.ratedDuration),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[x])),_:1}),(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",v,(0,l.zw)(t.items.planImplementBy),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[k])),_:1}),(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",W,(0,l.zw)(t.items.implementBy),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"4"},{default:(0,n.w5)((()=>[C])),_:1}),(0,n.Wm)($,{cols:"8"},{default:(0,n.w5)((()=>[(0,n._)("p",S,(0,l.zw)(t.items.implementTime),1)])),_:2},1024)])),_:2},1024),(0,n.Wm)(D,{"no-gutters":"",class:"text"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{cols:"6"}),(0,n.Wm)($,{cols:"6",class:"text-right"},{default:(0,n.w5)((()=>[(0,n.Wm)(H,{onClick:e=>O.detailClick(t),color:"primary mt-1",density:"compact",rounded:0,variant:"plain"},{default:(0,n.w5)((()=>[(0,n.Uk)("详情")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:1},8,["params","onSearchClick"])]),(0,n.Wm)(V,{ref:"searchPage",onResetHandle:O.resetHandle,onSearchHandle:O.searchHandle},null,8,["onResetHandle","onSearchHandle"])])}a(57658),a(38862);var T=a(76496),O=a(88575);const q=(0,n._)("div",{style:{height:"52px"}},null,-1),F={style:{"margin-top":"32px"}};function $(t,e,a,i,l,s){const o=(0,n.up)("SelectComponents"),r=(0,n.up)("DatePickerComponents"),c=(0,n.up)("v-btn"),u=(0,n.up)("v-col"),m=(0,n.up)("v-row"),p=(0,n.up)("van-popup");return(0,n.wg)(),(0,n.iD)("span",null,[(0,n.Wm)(p,{show:t.drawer,"onUpdate:show":e[7]||(e[7]=e=>t.drawer=e),closeable:"",position:"right",style:{padding:"12px",width:"90%",height:"100%"}},{default:(0,n.w5)((()=>[q,(0,n.Wm)(o,{modelValue:t.equipment,"onUpdate:modelValue":e[0]||(e[0]=e=>t.equipment=e),ref:"selectContent",label:"设备",placeholderSearch:"请输入设备编号",showSearch:"",option:t.equipmentSelectOption,onOnSearchChange:s.equipmentSearchChange},null,8,["modelValue","option","onOnSearchChange"]),(0,n.Wm)(r,{modelValue:t.dateStart,"onUpdate:modelValue":e[1]||(e[1]=e=>t.dateStart=e),label:"开始日期",ref:"dateTimeStart","columns-type":["year","month","day"]},null,8,["modelValue"]),(0,n.Wm)(r,{modelValue:t.dateOver,"onUpdate:modelValue":e[2]||(e[2]=e=>t.dateOver=e),label:"结束时间",ref:"dateTimeOver","columns-type":["year","month","day"]},null,8,["modelValue"]),(0,n.Wm)(o,{modelValue:t.user,"onUpdate:modelValue":e[3]||(e[3]=e=>t.user=e),label:"实施人",ref:"user",option:t.userSelectOption},null,8,["modelValue","option"]),(0,n.Wm)(o,{modelValue:t.userAffirm,"onUpdate:modelValue":e[4]||(e[4]=e=>t.userAffirm=e),label:"计划人",ref:"userAffirm",option:t.userAffirmSelectOption},null,8,["modelValue","option"]),(0,n.Wm)(o,{modelValue:t.property,"onUpdate:modelValue":e[5]||(e[5]=e=>t.property=e),ref:"select2",label:"任务类型",option:t.propertySelectOption},null,8,["modelValue","option"]),(0,n._)("div",F,[(0,n.Wm)(m,{"no-gutters":""},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{cols:"4",class:"text-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{onClick:e[6]||(e[6]=()=>t.drawer=!1),density:"compact",variant:"plain"},{default:(0,n.w5)((()=>[(0,n.Uk)("关闭")])),_:1})])),_:1}),(0,n.Wm)(u,{cols:"4",class:"text-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{onClick:s.resetClick,density:"compact",color:"warning",variant:"plain"},{default:(0,n.w5)((()=>[(0,n.Uk)("重置")])),_:1},8,["onClick"])])),_:1}),(0,n.Wm)(u,{cols:"4",class:"text-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{onClick:s.searchClick,density:"compact",color:"primary",variant:"plain"},{default:(0,n.w5)((()=>[(0,n.Uk)("查询")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1},8,["show"])])}var D=a(2243),H=a(37184),N=a(21655),B=a(20868),V=a(89337),z=a(5878),U={components:{SelectComponents:D.Z,DatePickerComponents:N.Z},emits:["searchHandle","resetHandle"],data:()=>({showFactory:!0,drawer:!1,dateStart:"",dateOver:"",show:!1,fieldValue:"",options:[],factoryID:"",equipment:"",equipmentSelectOption:[],user:"",userSelectOption:[],userAffirm:"",userAffirmSelectOption:[],property:"",propertySelectOption:[]}),created(){this.initFunc(),this.equipmentHTTP(),this.initUserHTTP()},methods:{FormatDictionary(t="",e=""){const a=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),i=a[t]||[],n=i.filter((t=>e==t.value))[0]||{};return n},resetClick(){this.factoryID="",this.equipment="",this.dateStart="",this.dateOver="",this.user="",this.userAffirm="",this.fieldValue="",this.$refs.selectContent.reset(),this.$refs.dateTimeStart.reset(),this.$refs.dateTimeOver.reset(),this.$refs.user.reset(),this.$refs.userAffirm.reset(),this.showFactory=!1,this.$nextTick((()=>{this.showFactory=!0})),this.$emit("resetHandle",{})},async initFunc(){const t=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),e=t["WB_TT"]||[];this.propertySelectOption=e.map((t=>Object.assign({text:t.lable,value:t.value})));const{data:a=[]}=await(0,V.jt)(),i=(0,z.b)(a,"tmBasNodeLevelId","parentId");this.options=i},async equipmentHTTP(t=""){const{fieldSelectValue:e={}}=this,{code:a,data:i=[]}=await(0,H.i)({url:"/iiot/equipment/list",method:"get",url_params:{equipmentNo:t}});200==a&&(this.equipmentSelectOptionData=i,this.equipmentSelectOption=i.map((t=>Object.assign({text:`${t.equipmentNo}-${t.equipmentName}`,value:t.tmBasEquipmentId}))).splice(0,100))},async initUserHTTP(){const{data:t=[]}=await(0,V.NM)();this.userSelectOption=t.map((t=>Object.assign({text:`${t.userName}-${t.nickName}`,value:t.userName}))),this.userAffirmSelectOption=t.map((t=>Object.assign({text:`${t.userName}-${t.nickName}`,value:t.userName})))},onFinish({selectedOptions:t}){if(!t.length)return;let e=(t[t.length-1]||{})["tmBasNodeLevelId"];this.factoryID=e,this.fieldValue=t.map((t=>t.nodeLevelName)).join("/")},searchClick(){if(this.dateStart&&!this.dateOver)return void(0,B.LJ)("结束日期必填！");if(!this.dateStart&&this.dateOver)return void(0,B.LJ)("开始日期必填！");if(new Date(this.dateStart).getTime()>new Date(this.dateOver).getTime())return void(0,B.LJ)("结束日期必须大于开始日期！");const t={tmBasEquipmentId:this.equipment,beginTime:this.dateStart,endTime:this.dateOver,planCreateBy:this.userAffirm,implementBy:this.user,wbTt:this.property};this.$emit("searchHandle",t),this.drawer=!1},showDrawer(){this.drawer=!0},async equipmentSearchChange(t=""){this.equipmentHTTP(t)}}},I=a(40089);const A=(0,I.Z)(U,[["render",$]]);var L=A,P={components:{AppBarPage:T.Z,SearchPage:L,TableComponents:O.Z},data:()=>({pageSearchConfig:{}}),methods:{FormatDictionary(t="",e=""){const a=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),i=a[t]||[],n=i.filter((t=>e==t.value))[0]||{};return n},GlobalTooltipFunc(t=""){(0,B.CF)({message:t,overlay:!0,closeOnClickOverlay:!0,duration:0})},async detailClick(t){const{items:e}=t,{code:a,data:i={}}=await(0,H.i)({url:`/iiot/maintain/${e.ttWbMaintainId}`,method:"get"});this.$router.push({path:"/maintainMessage/detailHistory",query:{row:JSON.stringify(i)}})},searchClick(){this.$refs.searchPage.showDrawer()},searchHandle(t={}){this.pageSearchConfig=t,this.$nextTick((()=>{this.$refs.table1.initFunc(1)}))},resetHandle(t){this.pageSearchConfig={},this.$nextTick((()=>{this.$refs.table1.initFunc(1)}))}}};const j=(0,I.Z)(P,[["render",b]]);var Z=j}}]);
//# sourceMappingURL=chunk.3561.1689576161502.js.map