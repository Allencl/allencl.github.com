"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[3497],{57265:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(73396),u={style:{padding:"0px 12px 0px 12px"}},i={key:0,class:"font-weight-medium text",style:{"margin-bottom":"8px"}},a={key:1,style:{"margin-bottom":"8px"},class:"font-weight-medium text"},o={class:"custem-iamge-upload"},l=["src"];function s(e,t,n,s,c,f){var m=(0,r.up)("van-uploader"),d=(0,r.up)("v-icon");return(0,r.wg)(),(0,r.iD)("span",null,[(0,r._)("div",u,[n.preview?((0,r.wg)(),(0,r.iD)("p",i,"图片预览 ")):((0,r.wg)(),(0,r.iD)("p",a," 图片上传 ")),n.preview?(0,r.kq)("",!0):((0,r.wg)(),(0,r.j4)(m,{key:2,"after-read":f.afterRead,"preview-image":!1},null,8,["after-read"])),(0,r._)("div",o,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.bufferFileList,(function(u,i){return(0,r.wg)(),(0,r.iD)("li",{key:i,onClick:t[0]||(t[0]=function(t){return f.checkImage(e.bufferFileList)})},[(0,r._)("img",{src:u.url},null,8,l),n.preview?(0,r.kq)("",!0):((0,r.wg)(),(0,r.j4)(d,{key:0,onClick:function(e){return f.removeClick(u,e)},class:"icon",icon:"mdi-close-circle-outline",color:"red"},null,8,["onClick"]))])})),128))])])])}var c=n(50124),f=n(48534),m=(n(21249),n(26699),n(32023),n(92222),n(38862),n(57327),n(41539),n(37184)),d=n(20868),p=n(9801),w={components:{},emits:["update:modelValue","onChange"],data:function(){return{bufferFileList:[]}},watch:{modelValue:{handler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.bufferFileList=e},deep:!0,immediate:!0},initPath:{handler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e&&(this.bufferFileList=e.split(",").map((function(e){return Object.assign({url:e})})))},deep:!0,immediate:!0}},methods:{checkImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&(0,p.V)(e.map((function(e){return e.url})))},afterRead:function(e){var t=this;return(0,f.Z)((0,c.Z)().mark((function n(){var r,u,i,a,o;return(0,c.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.file.type.includes("image")){n.next=3;break}return(0,d.LJ)("只能选择图片！"),n.abrupt("return");case 3:if(!(e.file.size>=19922944)){n.next=6;break}return(0,d.LJ)("图片超过20M！"),n.abrupt("return");case 6:if(!(t.bufferFileList.length>2)){n.next=9;break}return(0,d.LJ)("最多只能选择3张图片！"),n.abrupt("return");case 9:return r=new FormData,r.append("file",e.file),n.next=13,(0,m.i)({url:"/file/upload",method:"post",formData:!0,payload:r});case 13:u=n.sent,i=u.code,a=u.data,o=void 0===a?{}:a,200==i?(t.bufferFileList=t.bufferFileList.concat([o]),(0,d.XA)("图片上传成功！"),t.$emit("update:modelValue",JSON.parse(JSON.stringify(t.bufferFileList)))):(0,d.LJ)("图片上传失败！");case 18:case"end":return n.stop()}}),n)})))()},removeClick:function(e,t){var n=this;t.stopPropagation(),this.bufferFileList=JSON.parse(JSON.stringify(this.bufferFileList)).filter((function(t){return t.url!=e.url})),this.$nextTick((function(){n.$emit("update:modelValue",JSON.parse(JSON.stringify(n.bufferFileList)))}))}},props:{modelValue:{type:Array,default:function(){return[]}},initPath:{type:String,default:function(){return""}},preview:{type:Boolean,default:function(){return!1}}}},h=n(40089);const g=(0,h.Z)(w,[["render",s]]);var v=g},41055:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});var r=n(73396),u=n(87139),i=(0,r._)("span",{class:"font-weight-medium"},"例外转序信息",-1),a=(0,r._)("p",{class:"font-weight-medium text"},"序列号:",-1),o={class:"font-weight-light text-left text-teal-lighten-1"},l=(0,r._)("p",{class:"font-weight-medium text"},"发起工序:",-1),s={class:"font-weight-light"},c=(0,r._)("p",{class:"font-weight-medium text"},"拦截工序:",-1),f={class:"font-weight-light"},m=(0,r._)("p",{class:"font-weight-medium text"},"例外转序原因:",-1),d={class:"font-weight-light"},p=(0,r._)("p",{class:"font-weight-medium text"},"整机物料:",-1),w={class:"font-weight-light"},h=(0,r._)("p",{class:"font-weight-medium text"},"发起人:",-1),g={class:"font-weight-light"},v=(0,r._)("p",{class:"font-weight-medium text"},"发起时间:",-1),b={class:"font-weight-light"},_=(0,r._)("div",{style:{height:"56px"}},null,-1);function x(e,t,n,x,k,W){var y=(0,r.up)("AppBarPage"),C=(0,r.up)("v-icon"),L=(0,r.up)("v-col"),S=(0,r.up)("v-row"),Z=(0,r.up)("UploaderImageComponents"),F=(0,r.up)("SelectComponents"),O=(0,r.up)("van-field"),P=(0,r.up)("v-btn"),I=(0,r.up)("v-sheet");return(0,r.wg)(),(0,r.iD)("span",null,[(0,r.Wm)(y),(0,r.Wm)(I,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,r.w5)((function(){return[(0,r.Wm)(S,{"no-gutters":"",class:"custem-card-title"},{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"7"},{default:(0,r.w5)((function(){return[(0,r.Wm)(C,{icon:"mdi-rocket-launch",size:"16",color:"primary"}),i]})),_:1}),(0,r.Wm)(L,{cols:"5",class:"text-right"})]})),_:1}),(0,r.Wm)(S,{"no-gutters":"",class:"text"},{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"4"},{default:(0,r.w5)((function(){return[a]})),_:1}),(0,r.Wm)(L,{cols:"8"},{default:(0,r.w5)((function(){return[(0,r._)("p",o,(0,u.zw)(e.bufferRow.sn),1)]})),_:1})]})),_:1}),(0,r.Wm)(S,{"no-gutters":"",class:"text"},{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"4"},{default:(0,r.w5)((function(){return[l]})),_:1}),(0,r.Wm)(L,{cols:"8"},{default:(0,r.w5)((function(){return[(0,r._)("p",s,(0,u.zw)(e.bufferRow.initiateProcess),1)]})),_:1})]})),_:1}),(0,r.Wm)(S,{"no-gutters":"",class:"text"},{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"4"},{default:(0,r.w5)((function(){return[c]})),_:1}),(0,r.Wm)(L,{cols:"8"},{default:(0,r.w5)((function(){return[(0,r._)("p",f,(0,u.zw)(e.bufferRow.interceptProcess),1)]})),_:1})]})),_:1}),(0,r.Wm)(S,{"no-gutters":"",class:"text"},{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"4"},{default:(0,r.w5)((function(){return[m]})),_:1}),(0,r.Wm)(L,{cols:"8"},{default:(0,r.w5)((function(){return[(0,r._)("p",d,(0,u.zw)(e.bufferRow.conversionDesc),1)]})),_:1})]})),_:1}),(0,r.Wm)(S,{"no-gutters":"",class:"text"},{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"4"},{default:(0,r.w5)((function(){return[p]})),_:1}),(0,r.Wm)(L,{cols:"8"},{default:(0,r.w5)((function(){return[(0,r._)("p",w,(0,u.zw)(e.bufferRow.partName),1)]})),_:1})]})),_:1}),(0,r.Wm)(S,{"no-gutters":"",class:"text"},{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"4"},{default:(0,r.w5)((function(){return[h]})),_:1}),(0,r.Wm)(L,{cols:"8"},{default:(0,r.w5)((function(){return[(0,r._)("p",g,(0,u.zw)(e.bufferRow.initiateByName),1)]})),_:1})]})),_:1}),(0,r.Wm)(S,{"no-gutters":"",class:"text"},{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"4"},{default:(0,r.w5)((function(){return[v]})),_:1}),(0,r.Wm)(L,{cols:"8"},{default:(0,r.w5)((function(){return[(0,r._)("p",b,(0,u.zw)(e.bufferRow.createDate),1)]})),_:1})]})),_:1}),(0,r.Wm)(Z,{initPath:e.bufferRow.initiatePath,preview:""},null,8,["initPath"]),(0,r.Wm)(F,{modelValue:e.measures,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.measures=t}),ref:"select11",label:"放行工序",required:"",option:e.measuresSelectOption,onOnSearchChange:W.measuresSelectSearchChange},null,8,["modelValue","option","onOnSearchChange"]),(0,r.Wm)(O,{modelValue:e.value1,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.value1=t}),type:"textarea",required:"",autocomplete:"off",placeholder:"请输入",label:"放行原因"},null,8,["modelValue"]),(0,r.Wm)(S,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(L,{cols:"12",class:"text-left"},{default:(0,r.w5)((function(){return[(0,r.Wm)(P,{onClick:W.submit,block:"",color:"primary"},{default:(0,r.w5)((function(){return[(0,r.Uk)(" 放行 ")]})),_:1},8,["onClick"])]})),_:1})]})),_:1})]})),_:1}),_])}var k=n(50124),W=n(48534),y=(n(57327),n(41539),n(21249),n(73210),n(76496)),C=n(37184),L=n(2243),S=n(73378),Z=n(57265),F=n(20868),O={components:{AppBarPage:y.Z,ScanBarComponents:S.Z,SelectComponents:L.Z,UploaderImageComponents:Z.Z},data:function(){return{bufferRow:{},bufferFileList:[],value1:"",measures:"",measuresSelectOption:[]}},watch:{},created:function(){this.initFunc()},methods:{FormatDictionary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),r=n[e]||[],u=r.filter((function(e){return t==e.value}))[0]||{};return u},initFunc:function(){var e=this;return(0,W.Z)((0,k.Z)().mark((function t(){var n,r,u,i,a;return(0,k.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.query.ttQmAbnormalConversionId,t.next=3,(0,C.i)({url:"/iiot/abnormalConversion/".concat(n),method:"get"});case 3:r=t.sent,u=r.code,i=r.data,a=void 0===i?{}:i,200==u&&(e.bufferRow=a,a.ttPpOrderSnId&&e.measuresHTTP(a.ttPpOrderSnId));case 8:case"end":return t.stop()}}),t)})))()},measuresHTTP:function(e){var t=this;return(0,W.Z)((0,k.Z)().mark((function n(){var r,u,i,a;return(0,k.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.bufferRow,n.next=3,(0,C.i)({url:"/iiot/qmTask/getInspectNodeLevelList",method:"get",url_params:{ttPpOrderSnId:e}});case 3:r=n.sent,u=r.code,i=r.data,a=void 0===i?[]:i,200==u&&(t.measuresSelectOption=a.map((function(e){return Object.assign({text:e.nodeLevelNo+e.nodeLevelName,value:e.tmBasNodeLevelId})})));case 8:case"end":return n.stop()}}),n)})))()},measuresSelectSearchChange:function(e){},submit:function(){var e=this;return(0,W.Z)((0,k.Z)().mark((function t(){var n,r,u,i,a;return(0,k.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$route.query.ttQmAbnormalConversionId,e.bufferRow,e.measures){t.next=5;break}return(0,F.LJ)("放行工序必选！"),t.abrupt("return");case 5:if(e.value1.trim()){t.next=8;break}return(0,F.LJ)("放行原因必填！"),t.abrupt("return");case 8:return r={ttQmAbnormalConversionId:n,dischargedProcessId:e.measures,dischargedExplain:e.value1},t.next=11,(0,C.i)({url:"/iiot/abnormalConversion/dischargedAbnormalConversion",method:"post",payload:r});case 11:u=t.sent,i=u.code,a=u.data,void 0===a?{}:a,200==i&&((0,F.XA)("提交成功！"),e.$router.go(-1));case 16:case"end":return t.stop()}}),t)})))()}}},P=n(40089);const I=(0,P.Z)(O,[["render",x]]);var R=I}}]);
//# sourceMappingURL=chunk.3497.1689576359115.js.map