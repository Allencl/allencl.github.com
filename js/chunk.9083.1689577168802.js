"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[9083],{89337:function(e,t,n){n.d(t,{$w:function(){return p},AT:function(){return u},NM:function(){return s},ew:function(){return c},jt:function(){return i},vU:function(){return l}});var r=n(50124),a=n(48534),o=n(37184),i=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n=arguments;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.next=3,(0,o.i)({url:"/iiot/nodeLevel/list",method:"get",url_params:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,o.i)({url:"/iiot/faultType/list?enabled=1",method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,o.i)({url:"/iiot/fault/list?enabled=1",method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,o.i)({url:"/system/dict/data/type/equipment_repair_type",method:"get"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,o.i)({url:"/iiot/equipmentRepair/userList?enabled=1",method:"post"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,o.i)({url:"/iiot/equipmentRepair/confirmRepairWbForApp",method:"post",payload:t.payload});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},5878:function(e,t,n){n.d(t,{b:function(){return a}});var r=n(66347),a=(n(57658),function(e,t,n,a){var o,i={id:t||"id",parentId:n||"parentId",childrenList:a||"children"},u={},l={},c=[],s=(0,r.Z)(e);try{for(s.s();!(o=s.n()).done;){var p=o.value,d=p[i.parentId];null==u[d]&&(u[d]=[]),l[p[i.id]]=p,u[d].push(p)}}catch(k){s.e(k)}finally{s.f()}var m,f=(0,r.Z)(e);try{for(f.s();!(m=f.n()).done;){var h=m.value,g=h[i.parentId];null==l[g]&&c.push(h)}}catch(k){f.e(k)}finally{f.f()}for(var v=0,b=c;v<b.length;v++){var y=b[v];w(y)}function w(e){if(null!==u[e[i.id]]&&(e[i.childrenList]=u[e[i.id]]),e[i.childrenList]){var t,n=(0,r.Z)(e[i.childrenList]);try{for(n.s();!(t=n.n()).done;){var a=t.value;w(a)}}catch(k){n.e(k)}finally{n.f()}}}return c})},57265:function(e,t,n){n.d(t,{Z:function(){return b}});var r=n(73396),a={style:{padding:"0px 12px 0px 12px"}},o={key:0,class:"font-weight-medium text",style:{"margin-bottom":"8px"}},i={key:1,style:{"margin-bottom":"8px"},class:"font-weight-medium text"},u={class:"custem-iamge-upload"},l=["src"];function c(e,t,n,c,s,p){var d=(0,r.up)("van-uploader"),m=(0,r.up)("v-icon");return(0,r.wg)(),(0,r.iD)("span",null,[(0,r._)("div",a,[n.preview?((0,r.wg)(),(0,r.iD)("p",o,"图片预览 ")):((0,r.wg)(),(0,r.iD)("p",i," 图片上传 ")),n.preview?(0,r.kq)("",!0):((0,r.wg)(),(0,r.j4)(d,{key:2,"after-read":p.afterRead,"preview-image":!1},null,8,["after-read"])),(0,r._)("div",u,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.bufferFileList,(function(a,o){return(0,r.wg)(),(0,r.iD)("li",{key:o,onClick:t[0]||(t[0]=function(t){return p.checkImage(e.bufferFileList)})},[(0,r._)("img",{src:a.url},null,8,l),n.preview?(0,r.kq)("",!0):((0,r.wg)(),(0,r.j4)(m,{key:0,onClick:function(e){return p.removeClick(a,e)},class:"icon",icon:"mdi-close-circle-outline",color:"red"},null,8,["onClick"]))])})),128))])])])}var s=n(50124),p=n(48534),d=(n(21249),n(26699),n(32023),n(92222),n(38862),n(57327),n(41539),n(37184)),m=n(20868),f=n(9801),h={components:{},emits:["update:modelValue","onChange"],data:function(){return{bufferFileList:[]}},watch:{modelValue:{handler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.bufferFileList=e},deep:!0,immediate:!0},initPath:{handler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e&&(this.bufferFileList=e.split(",").map((function(e){return Object.assign({url:e})})))},deep:!0,immediate:!0}},methods:{checkImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&(0,f.V)(e.map((function(e){return e.url})))},afterRead:function(e){var t=this;return(0,p.Z)((0,s.Z)().mark((function n(){var r,a,o,i,u;return(0,s.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.file.type.includes("image")){n.next=3;break}return(0,m.LJ)("只能选择图片！"),n.abrupt("return");case 3:if(!(e.file.size>=19922944)){n.next=6;break}return(0,m.LJ)("图片超过20M！"),n.abrupt("return");case 6:if(!(t.bufferFileList.length>2)){n.next=9;break}return(0,m.LJ)("最多只能选择3张图片！"),n.abrupt("return");case 9:return r=new FormData,r.append("file",e.file),n.next=13,(0,d.i)({url:"/file/upload",method:"post",formData:!0,payload:r});case 13:a=n.sent,o=a.code,i=a.data,u=void 0===i?{}:i,200==o?(t.bufferFileList=t.bufferFileList.concat([u]),(0,m.XA)("图片上传成功！"),t.$emit("update:modelValue",JSON.parse(JSON.stringify(t.bufferFileList)))):(0,m.LJ)("图片上传失败！");case 18:case"end":return n.stop()}}),n)})))()},removeClick:function(e,t){var n=this;t.stopPropagation(),this.bufferFileList=JSON.parse(JSON.stringify(this.bufferFileList)).filter((function(t){return t.url!=e.url})),this.$nextTick((function(){n.$emit("update:modelValue",JSON.parse(JSON.stringify(n.bufferFileList)))}))}},props:{modelValue:{type:Array,default:function(){return[]}},initPath:{type:String,default:function(){return""}},preview:{type:Boolean,default:function(){return!1}}}},g=n(40089);const v=(0,g.Z)(h,[["render",c]]);var b=v},13415:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var r=n(73396),a=n(87139),o=(0,r._)("span",{class:"font-weight-medium"},"通用信息",-1),i=(0,r._)("p",{class:"font-weight-medium text"},[(0,r._)("span",{style:{color:"#ee0a24"}},"*"),(0,r.Uk)("是否停线:")],-1),u={style:{padding:"0px 12px"}},l={key:0},c=(0,r._)("div",{style:{height:"6px"}},null,-1),s=(0,r._)("span",{class:"font-weight-medium"},"其他信息",-1),p=(0,r._)("div",{style:{height:"6px"}},null,-1),d=(0,r._)("span",{class:"font-weight-medium"},"异常信息",-1),m=(0,r._)("div",{style:{height:"36px"}},null,-1);function f(e,t,n,f,h,g){var v=(0,r.up)("AppBarPage"),b=(0,r.up)("v-icon"),y=(0,r.up)("v-col"),w=(0,r.up)("v-row"),k=(0,r.up)("SelectComponents"),x=(0,r.up)("van-field"),S=(0,r.up)("v-btn"),C=(0,r.up)("van-cascader"),I=(0,r.up)("van-popup"),O=(0,r.up)("van-radio"),Z=(0,r.up)("van-radio-group"),L=(0,r.up)("ScanBarComponents"),V=(0,r.up)("v-sheet"),_=(0,r.up)("UploaderImageComponents");return(0,r.wg)(),(0,r.iD)("span",null,[(0,r.Wm)(v),(0,r.Wm)(V,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,r.w5)((function(){return[(0,r.Wm)(w,{"no-gutters":"",class:"custem-card-title"},{default:(0,r.w5)((function(){return[(0,r.Wm)(y,{cols:"6"},{default:(0,r.w5)((function(){return[(0,r.Wm)(b,{icon:"mdi-access-point",size:"16",color:"indigo"}),o]})),_:1}),(0,r.Wm)(y,{cols:"6"})]})),_:1}),(0,r.Wm)(k,{modelValue:e.property,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.property=t}),label:"异常类型属性",required:"",ref:"select11",option:e.selectPropertyOption,onOnChange:g.selectPropertyChange},null,8,["modelValue","option","onOnChange"]),(0,r.Wm)(k,{modelValue:e.type,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.type=t}),ref:"selectType",label:"异常类型",showSearch:"",option:e.typeSelectOption,forbidShow:!0,onOnFieldClick:g.typeFieldClick,onOnChange:g.selectTypeChange,onOnSearchChange:g.typeSearchChange,required:""},null,8,["modelValue","option","onOnFieldClick","onOnChange","onOnSearchChange"]),(0,r.Wm)(k,{modelValue:e.content,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.content=t}),ref:"selectContent",label:"异常内容",forbidShow:!0,showSearch:"",option:e.contentSelectOption,onOnFieldClick:g.contentFieldClick,onOnSearchChange:g.contentSearchChange,required:""},null,8,["modelValue","option","onOnFieldClick","onOnSearchChange"]),(0,r.Wm)(x,{modelValue:e.fieldValue,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.fieldValue=t}),"is-link":"",readonly:"",label:"工厂节点",placeholder:"请选择工厂节点",type:"textarea",required:"",autocomplete:"off",onClick:t[4]||(t[4]=function(t){return e.show=!0})},null,8,["modelValue"]),(0,r.Wm)(I,{show:e.show,"onUpdate:show":t[7]||(t[7]=function(t){return e.show=t}),round:"",position:"bottom"},{default:(0,r.w5)((function(){return[(0,r.Wm)(S,{block:"",color:"cyan",elevation:"0",style:{"border-radius":"0px"},onClick:t[5]||(t[5]=function(){return e.show=!1})},{default:(0,r.w5)((function(){return[(0,r.Uk)(" 确定 ")]})),_:1}),(0,r.Wm)(C,{title:"请选择工厂节点",options:e.options,"active-color":"#4CAF50","field-names":{text:"nodeLevelName",value:"tmBasNodeLevelId",children:"children"},onClose:t[6]||(t[6]=function(t){return e.show=!1}),onChange:g.onFinish},null,8,["options","onChange"])]})),_:1},8,["show"]),(0,r.Wm)(w,{"no-gutters":"",class:"text"},{default:(0,r.w5)((function(){return[(0,r.Wm)(y,{cols:"4",style:{"padding-left":"5px"}},{default:(0,r.w5)((function(){return[i]})),_:1}),(0,r.Wm)(y,{cols:"4",style:{"text-align":"right"}},{default:(0,r.w5)((function(){return[(0,r.Wm)(Z,{modelValue:e._switch11,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e._switch11=t}),direction:"horizontal"},{default:(0,r.w5)((function(){return[(0,r.Wm)(O,{name:"1","checked-color":"#4CAF50",shape:"square"},{default:(0,r.w5)((function(){return[(0,r.Uk)("是")]})),_:1}),(0,r.Wm)(O,{name:"0","checked-color":"#4CAF50",shape:"square"},{default:(0,r.w5)((function(){return[(0,r.Uk)("否")]})),_:1})]})),_:1},8,["modelValue"])]})),_:1})]})),_:1}),(0,r.Wm)(k,{modelValue:e.urgency,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.urgency=t}),ref:"select4",label:"紧急程度",option:e.urgencySelectOption,required:""},null,8,["modelValue","option"]),(0,r.Wm)(x,{modelValue:e.place,"onUpdate:modelValue":t[10]||(t[10]=function(t){return e.place=t}),autocomplete:"off",placeholder:"请输入",label:"地点"},null,8,["modelValue"]),(0,r._)("div",u,[(0,r.Wm)(L,{placeholder:"扫描或输入产品序列号",onSearchClick:g.barSearchClick},null,8,["onSearchClick"]),e.serialNumberLable?((0,r.wg)(),(0,r.iD)("p",l,"查询结果: "+(0,a.zw)(e.serialNumberLable),1)):(0,r.kq)("",!0)])]})),_:1}),c,(0,r.Wm)(V,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,r.w5)((function(){return[(0,r.Wm)(w,{"no-gutters":"",class:"custem-card-title"},{default:(0,r.w5)((function(){return[(0,r.Wm)(y,{cols:"6"},{default:(0,r.w5)((function(){return[(0,r.Wm)(b,{icon:"mdi-dots-vertical",size:"16",color:"primary"}),s]})),_:1}),(0,r.Wm)(y,{cols:"6"})]})),_:1}),(0,r.Wm)(k,{modelValue:e.equipment,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.equipment=t}),ref:"select7",label:"设备信息",showSearch:"",option:e.equipmentSelectOption,onOnSearchChange:g.equipmentSearchChange},null,8,["modelValue","option","onOnSearchChange"]),(0,r.Wm)(k,{modelValue:e.product,"onUpdate:modelValue":t[12]||(t[12]=function(t){return e.product=t}),ref:"select8",label:"产品信息",showSearch:"",option:e.productSelectOption,onOnSearchChange:g.productSearchChange},null,8,["modelValue","option","onOnSearchChange"])]})),_:1}),p,(0,r.Wm)(V,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,r.w5)((function(){return[(0,r.Wm)(w,{"no-gutters":"",class:"custem-card-title"},{default:(0,r.w5)((function(){return[(0,r.Wm)(y,{cols:"6"},{default:(0,r.w5)((function(){return[(0,r.Wm)(b,{icon:"mdi-alert-circle",size:"16",color:"warning"}),d]})),_:1}),(0,r.Wm)(y,{cols:"6"})]})),_:1}),(0,r.Wm)(x,{modelValue:e.abnormalDescription,"onUpdate:modelValue":t[13]||(t[13]=function(t){return e.abnormalDescription=t}),placeholder:"请输入",autocomplete:"off",type:"textarea",label:"异常描述",required:""},null,8,["modelValue"]),(0,r.Wm)(x,{modelValue:e.remark,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.remark=t}),placeholder:"请输入",autocomplete:"off",type:"textarea",label:"备注"},null,8,["modelValue"]),(0,r.Wm)(_,{modelValue:e.bufferFileList,"onUpdate:modelValue":t[15]||(t[15]=function(t){return e.bufferFileList=t})},null,8,["modelValue"])]})),_:1}),(0,r.Wm)(w,{"no-gutters":""},{default:(0,r.w5)((function(){return[(0,r.Wm)(y,{cols:"12",class:"text-center"},{default:(0,r.w5)((function(){return[(0,r.Wm)(S,{onClick:g.submitHandle,color:"primary",block:""},{default:(0,r.w5)((function(){return[(0,r.Uk)(" 确认发起 ")]})),_:1},8,["onClick"])]})),_:1})]})),_:1}),m])}var h=n(95082),g=n(50124),v=n(48534),b=(n(57327),n(41539),n(21249),n(57658),n(30541),n(69600),n(92222),n(38862),n(40561),n(76496)),y=n(37184),w=n(89337),k=n(5878),x=n(2243),S=n(57265),C=n(73378),I=n(20868),O=(n(36797),{components:{AppBarPage:b.Z,UploaderImageComponents:S.Z,ScanBarComponents:C.Z,SelectComponents:x.Z},data:function(){return{bufferRow:{},_switch11:"",fileList:[],bufferFileList:[],property:"",selectPropertyOption:[],type:"",typeSelectOption:[],content:"",contentSelectOption:[],show:!1,fieldValue:"",options:[],factoryID:"",urgency:"",urgencySelectOption:[],place:"",serialNumber:"",serialNumberLable:"",equipment:"",equipmentSelectOption:[],product:"",productSelectOption:[],abnormalDescription:"",remark:""}},created:function(){this.initFunc(),this.getContentHttp(),this.FactoryHTTP(),this.getEquipmentHttp(),this.productHTTP()},methods:{FormatDictionary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),r=n[e]||[],a=r.filter((function(e){return t==e.value}))[0]||{};return a},initFunc:function(){var e=this;return(0,v.Z)((0,g.Z)().mark((function t(){var n,r,a,o,i;return(0,g.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),r=n["abnormal_type"]||[],e.selectPropertyOption=r.map((function(e){return Object.assign({text:e.lable,value:e.value})})),a=n["urgent_degree"]||[],e.urgencySelectOption=a.map((function(e){return Object.assign({text:e.lable,value:e.value})})),o=JSON.parse(localStorage.getItem("bufferPageDataAnomalyInitiateSponsorFactory")||"{}"),o.id&&(e.factoryID=o.id,e.fieldValue=o.text),i=e.$route.query.ttQmAbnormalId,i&&e.editFunc(i);case 9:case"end":return t.stop()}}),t)})))()},editFunc:function(e){var t=this;return(0,v.Z)((0,g.Z)().mark((function n(){var r,a,o,i;return(0,g.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,y.i)({url:"/iiot/abnormal/".concat(e),method:"get"});case 2:r=n.sent,a=r.code,o=r.data,i=void 0===o?{}:o,200==a&&(t.property=i.abnormalType,t.type=i.tmBasAbnormalTypeId,t.content=i.tmBasAbnormalContentId,t.urgency=i.urgentDegree,t._switch11=String(i.isLineStop||""),t.place=i.abnormalPlace,t.serialNumber=i.ttPpOrderSnId,t.equipment=i.tmBasAbnormalMeasuresId,t.product=i.tmBasPartId,t.abnormalDescription=i.abnormalDesc,t.remark=i.initiateRemark,i.initiatePath&&(t.bufferFileList=i.initiatePath.split(",").map((function(e){return Object.assign({url:e})}))),t.factoryID=i.tmBasNodeLevelId,t.factoryEdit(i.tmBasNodeLevelId),t.$nextTick((function(){t.$refs.select11&&t.$refs.select11.setValue(i.abnormalType),t.$refs.select4&&t.$refs.select4.setValue(i.urgentDegree)})),t.getTypeHttp({abnormalAttribute:i.abnormalType},"",(function(){t.$refs.selectType&&t.$refs.selectType.setValue(i.tmBasAbnormalTypeId)})),t.getContentHttp({tmBasAbnormalTypeId:i.tmBasAbnormalTypeId},"",(function(){t.$refs.selectContent&&t.$refs.selectContent.setValue(i.tmBasAbnormalContentId)})),i.ttPpOrderSnId&&t.barSearchClick("",i.ttPpOrderSnId,(function(e){t.serialNumberLable=e["sernr"]})),t.getEquipmentHttp("",i.tmBasAbnormalMeasuresId,(function(){t.$refs.select7&&t.$refs.select7.setValue(i.tmBasAbnormalMeasuresId)})),t.productHTTP("",i.tmBasPartId,(function(){t.$refs.select8&&t.$refs.select8.setValue(i.tmBasPartId)})));case 7:case"end":return n.stop()}}),n)})))()},factoryEdit:function(e){var t=this;return(0,v.Z)((0,g.Z)().mark((function n(){var r,a,o,i,u,l;return(0,g.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(0,w.jt)();case 4:r=n.sent,a=r.data,o=void 0===a?[]:a,i=(0,k.b)(o,"tmBasNodeLevelId","parentId"),u=function e(t,n){for(var r=[],a=0;a<t.length;a++){var o=t[a];if(o.tmBasNodeLevelId===n){r.push(o);break}if(o.children&&0!==o.children.length){var i=e(o.children,n);if(0!==i.length){i.unshift(o),r=i;break}}}return r},l=u(i,e)||[],t.fieldValue=l.map((function(e){return e.nodeLevelName})).join("/");case 11:case"end":return n.stop()}}),n)})))()},typeSearchChange:function(e){this.getTypeHttp({abnormalAttribute:this.property},e)},getTypeHttp:function(){var e=arguments,t=this;return(0,v.Z)((0,g.Z)().mark((function n(){var r,a,o,i,u,l,c;return(0,g.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},a=e.length>1&&void 0!==e[1]?e[1]:"",o=e.length>2?e[2]:void 0,n.next=5,(0,y.i)({url:"/iiot/abnormalType/listAbnormalTypeForSelect",method:"get",url_params:(0,h.Z)({abnormalNo:a},r)});case 5:i=n.sent,u=i.code,l=i.data,c=void 0===l?[]:l,200==u&&(t.typeSelectOption=c.map((function(e){return Object.assign({text:"".concat(e.abnormalNo).concat(e.abnormalName),value:e.tmBasAbnormalTypeId})})),t.$nextTick((function(){o&&o()})));case 10:case"end":return n.stop()}}),n)})))()},selectPropertyChange:function(e){this.type="",this.typeSelectOption=[],this.$refs.selectType.reset(),this.content="",this.contentSelectOption=[],this.$refs.selectContent.reset()},selectTypeChange:function(){this.content="",this.contentSelectOption=[],this.$refs.selectContent.reset()},typeFieldClick:function(){var e=this;this.property?(this.getTypeHttp({abnormalAttribute:this.property}),setTimeout((function(){e.$refs.selectType.showModle()}),600)):(0,I.LJ)("异常类型属性未选！")},contentFieldClick:function(){var e=this;this.type?(this.getContentHttp({tmBasAbnormalTypeId:this.type}),setTimeout((function(){e.$refs.selectContent.showModle()}),600)):(0,I.LJ)("异常类型未选！")},getContentHttp:function(){var e=arguments,t=this;return(0,v.Z)((0,g.Z)().mark((function n(){var r,a,o,i,u,l,c;return(0,g.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},a=e.length>1&&void 0!==e[1]?e[1]:"",o=e.length>2?e[2]:void 0,n.next=5,(0,y.i)({url:"/iiot/abnormalContent/listAbnormalContentForSelect",method:"get",url_params:(0,h.Z)({contentNo:a},r)});case 5:i=n.sent,u=i.code,l=i.data,c=void 0===l?[]:l,200==u&&(t.contentSelectOption=c.map((function(e){return Object.assign({text:"".concat(e.contentNo).concat(e.contentName),value:e.tmBasAbnormalContentId})})),t.$nextTick((function(){o&&o()})));case 10:case"end":return n.stop()}}),n)})))()},contentSearchChange:function(e){this.getContentHttp({tmBasAbnormalTypeId:this.type},e)},FactoryHTTP:function(){var e=this;return(0,v.Z)((0,g.Z)().mark((function t(){var n,r,a,o;return(0,g.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,w.jt)();case 2:n=t.sent,r=n.data,a=void 0===r?[]:r,o=(0,k.b)(a,"tmBasNodeLevelId","parentId"),e.options=o;case 7:case"end":return t.stop()}}),t)})))()},onFinish:function(e){var t=e.selectedOptions;if(t.length){var n=(t[t.length-1]||{})["tmBasNodeLevelId"];this.factoryID=n,this.fieldValue=t.map((function(e){return e.nodeLevelName})).join("/"),localStorage.setItem("bufferPageDataAnomalyInitiateSponsorFactory",JSON.stringify({id:this.factoryID,text:this.fieldValue}))}},getEquipmentHttp:function(){var e=arguments,t=this;return(0,v.Z)((0,g.Z)().mark((function n(){var r,a,o,i,u,l,c;return(0,g.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",a=e.length>1&&void 0!==e[1]?e[1]:"",o=e.length>2?e[2]:void 0,n.next=5,(0,y.i)({url:"/iiot/equipment/llistEquipmentForSelect",method:"get",url_params:{equipmentNo:r,tmBasEquipmentId:a}});case 5:i=n.sent,u=i.code,l=i.data,c=void 0===l?[]:l,200==u&&(t.equipmentSelectOption=c.map((function(e){return Object.assign({text:"".concat(e.equipmentNo).concat(e.equipmentName),value:e.tmBasEquipmentId})})),t.$nextTick((function(){o&&o()})));case 10:case"end":return n.stop()}}),n)})))()},equipmentSearchChange:function(e){this.getEquipmentHttp(e)},productHTTP:function(){var e=arguments,t=this;return(0,v.Z)((0,g.Z)().mark((function n(){var r,a,o,i,u,l,c;return(0,g.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",a=e.length>1&&void 0!==e[1]?e[1]:"",o=e.length>2?e[2]:void 0,n.next=5,(0,y.i)({url:"/iiot/part/listPartForSelect",method:"get",url_params:{noOrName:r,tmBasPartId:a}});case 5:i=n.sent,u=i.code,l=i.data,c=void 0===l?[]:l,200==u&&(t.productSelectOption=c.map((function(e){return Object.assign({text:"".concat(e.matnr).concat(e.maktxC),value:e.tmBasPartId})})).splice(0,100),t.$nextTick((function(){o&&o()})));case 10:case"end":return n.stop()}}),n)})))()},productSearchChange:function(e){this.productHTTP(e)},submitHandle:function(){var e=this;return(0,v.Z)((0,g.Z)().mark((function t(){var n,r,a,o,i;return(0,g.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$route.query.ttQmAbnormalId,e.property){t.next=4;break}return(0,I.LJ)("异常类型属性必填！"),t.abrupt("return");case 4:if(e.type){t.next=7;break}return(0,I.LJ)("异常类型必填！"),t.abrupt("return");case 7:if(e.content){t.next=10;break}return(0,I.LJ)("异常内容必填！"),t.abrupt("return");case 10:if(e.factoryID){t.next=13;break}return(0,I.LJ)("工厂节点必填！"),t.abrupt("return");case 13:if(String(e._switch11)){t.next=16;break}return(0,I.LJ)("是否停线必填！"),t.abrupt("return");case 16:if(e.urgency){t.next=19;break}return(0,I.LJ)("紧急程度必填！"),t.abrupt("return");case 19:if(e.abnormalDescription){t.next=22;break}return(0,I.LJ)("异常描述必填！"),t.abrupt("return");case 22:return r={ttQmAbnormalId:n||"",abnormalType:e.property,tmBasAbnormalTypeId:e.type,tmBasAbnormalContentId:e.content,tmBasNodeLevelId:e.factoryID,isLineStop:String(e._switch11),urgentDegree:e.urgency,abnormalPlace:e.place,ttPpOrderSnId:e.serialNumber,tmBasAbnormalMeasuresId:e.equipment,tmBasPartId:e.product,abnormalDesc:e.abnormalDescription,initiateRemark:e.remark,initiatePath:e.bufferFileList.map((function(e){return e.url})).join()},t.next=25,(0,y.i)({url:"/iiot/abnormal",method:n?"put":"post",payload:r});case 25:a=t.sent,o=a.code,i=a.data,void 0===i?{}:i,200==o&&((0,I.XA)("提交成功！"),e.$router.push({path:"/anomalyInitiate/index",query:{}}));case 30:case"end":return t.stop()}}),t)})))()},barSearchClick:function(){var e=arguments,t=this;return(0,v.Z)((0,g.Z)().mark((function n(){var r,a,o,i,u,l,c;return(0,g.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:"",a=e.length>1&&void 0!==e[1]?e[1]:"",o=e.length>2?e[2]:void 0,t.serialNumber="",t.serialNumberLable="",n.next=7,(0,y.i)({url:"/iiot/orderSn/listOrderSnForSelect",method:"get",url_params:{sernr:r,ttPpOrderSnId:a}});case 7:i=n.sent,u=i.code,l=i.data,c=void 0===l?[]:l,200==u&&c.length?((0,I.XA)("查询成功！"),t.serialNumberLable=c[0].sernr,t.serialNumber=c[0].ttPpOrderSnId,t.$nextTick((function(){o&&o(c[0]||{})}))):(0,I.LJ)("未查询到结果！");case 12:case"end":return n.stop()}}),n)})))()}}}),Z=n(40089);const L=(0,Z.Z)(O,[["render",f]]);var V=L}}]);
//# sourceMappingURL=chunk.9083.1689577168802.js.map