"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[8032],{89337:function(e,t,i){i.d(t,{$w:function(){return c},AT:function(){return o},NM:function(){return r},ew:function(){return s},jt:function(){return a},vU:function(){return n}});var l=i(37184);const a=async(e={})=>await(0,l.i)({url:"/iiot/nodeLevel/list",method:"get",url_params:e}),o=async e=>await(0,l.i)({url:"/iiot/faultType/list?enabled=1",method:"get"}),n=async e=>await(0,l.i)({url:"/iiot/fault/list?enabled=1",method:"get"}),s=async e=>await(0,l.i)({url:"/system/dict/data/type/equipment_repair_type",method:"get"}),r=async e=>await(0,l.i)({url:"/iiot/equipmentRepair/userList?enabled=1",method:"post"}),c=async e=>await(0,l.i)({url:"/iiot/equipmentRepair/confirmRepairWbForApp",method:"post",payload:e.payload})},5878:function(e,t,i){i.d(t,{b:function(){return l}});i(33948),i(57658);const l=(e,t,i,l)=>{let a={id:t||"id",parentId:i||"parentId",childrenList:l||"children"};var o={},n={},s=[];for(let c of e){let e=c[a.parentId];null==o[e]&&(o[e]=[]),n[c[a.id]]=c,o[e].push(c)}for(let c of e){let e=c[a.parentId];null==n[e]&&s.push(c)}for(let c of s)r(c);function r(e){if(null!==o[e[a.id]]&&(e[a.childrenList]=o[e[a.id]]),e[a.childrenList])for(let t of e[a.childrenList])r(t)}return s}},2243:function(e,t,i){i.d(t,{Z:function(){return w}});var l=i(73396),a=i(87139);const o={style:{height:"98%","padding-bottom":"40px"}},n={style:{height:"100%"}},s={style:{position:"relative",top:"4px"}},r=["onClick"],c={class:"text-truncate",style:{height:"24px"}},u={key:2,class:"text-center",style:{"margin-top":"16px"}};function d(e,t,i,d,p,h){const m=(0,l.up)("van-field"),f=(0,l.up)("v-col"),w=(0,l.up)("v-btn"),g=(0,l.up)("v-row"),k=(0,l.up)("van-search"),y=(0,l.up)("van-checkbox"),b=(0,l.up)("van-popup");return(0,l.wg)(),(0,l.iD)("span",null,[(0,l.Wm)(m,{modelValue:e.fieldValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fieldValue=t),"is-link":"",readonly:"",required:i.required,label:i.label,placeholder:i.placeholder,autocomplete:"off",type:i.multiple?"textarea":"text",onClick:h.fieldClick},null,8,["modelValue","required","label","placeholder","type","onClick"]),(0,l.Wm)(b,{show:e.showPicker,"onUpdate:show":t[5]||(t[5]=t=>e.showPicker=t),style:{padding:"12px 12px 4px 12px",height:"60%",width:"90%"},round:""},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l._)("div",n,[(0,l.Wm)(g,{"no-gutters":"",style:{"font-weight":"bold","border-bottom":"1px solid #ccc","padding-bottom":"5px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{cols:"6"},{default:(0,l.w5)((()=>[(0,l._)("p",null,(0,a.zw)(i.label)+"-选择框",1)])),_:1}),(0,l.Wm)(f,{cols:"6",class:"text-right"},{default:(0,l.w5)((()=>[(0,l._)("span",s,(0,a.zw)(e.BufferOption.filter((e=>e._checked)).length),1),i.selectAll?((0,l.wg)(),(0,l.j4)(w,{key:0,onClick:h.selectAllHandle,color:"primary mt-1",density:"compact",rounded:0,variant:"plain"},{default:(0,l.w5)((()=>[(0,l.Uk)("全选")])),_:1},8,["onClick"])):(0,l.kq)("",!0)])),_:1})])),_:1}),i.showSearch?((0,l.wg)(),(0,l.j4)(g,{key:0,"no-gutters":""},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{cols:"8"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:e.valueSearch,"onUpdate:modelValue":t[1]||(t[1]=t=>e.valueSearch=t),shape:"",placeholder:i.placeholderSearch,style:{"padding-left":"0px"},clearable:!1},null,8,["modelValue","placeholder"])])),_:1}),(0,l.Wm)(f,{cols:"2"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{onClick:t[2]||(t[2]=e=>h.searchHandle(!0)),variant:"plain",color:"primary",block:"",style:{"margin-top":"8px"}},{default:(0,l.w5)((()=>[(0,l.Uk)(" 查询 ")])),_:1})])),_:1}),(0,l.Wm)(f,{cols:"2"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{onClick:t[3]||(t[3]=e=>h.searchHandle(!1)),variant:"plain",block:"",style:{"margin-top":"8px"}},{default:(0,l.w5)((()=>[(0,l.Uk)(" 重置 ")])),_:1})])),_:1})])),_:1})):(0,l.kq)("",!0),e.BufferOption.length?((0,l.wg)(),(0,l.iD)("ul",{key:1,style:(0,a.j5)(`height: ${i.showSearch?"73%":"90%"};overflow-y:auto;padding-right:12px;padding-bottom: 20px;`)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.BufferOption,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{key:t,style:(0,a.j5)(`padding: 6px 22px 6px 6px;position:relative;color:${e._searchColor?"#FF9800":"#000"};`),onClick:t=>h.checkChange(e)},[(0,l._)("p",c,(0,a.zw)(e.text),1),(0,l.Wm)(y,{style:{position:"absolute",top:"8px",right:"0px"},modelValue:e._checked,"onUpdate:modelValue":t=>e._checked=t,shape:"square","checked-color":"#4CAF50",disabled:"",class:"custem-select-checkbox"},null,8,["modelValue","onUpdate:modelValue"])],12,r)))),128))],4)):((0,l.wg)(),(0,l.iD)("p",u,"无数据!"))]),(0,l.Wm)(g,{"no-gutters":""},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{cols:"6",class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{variant:"plain",block:"",onClick:t[4]||(t[4]=()=>e.showPicker=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)(" 取消 ")])),_:1})])),_:1}),(0,l.Wm)(f,{cols:"6",class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{variant:"plain",color:"primary",block:"",onClick:h.confirmHandle},{default:(0,l.w5)((()=>[(0,l.Uk)(" 确定 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1},8,["show"])])}i(38862),i(73210),i(26699),i(32023);var p=i(20868),h={components:{},emits:["update:modelValue","onChange","onFieldClick","onSearchChange"],data:()=>({BufferOption:[],selectedValues:[],columns:[],fieldValue:"",showPicker:!1,valueSearch:""}),watch:{option:{handler(e=[]){this.BufferOption=JSON.parse(JSON.stringify(e)),this.$nextTick((()=>{this.modelValue&&this.setValue(this.modelValue)}))},deep:!0,immediate:!0},showPicker:{handler(e){this.$nextTick((()=>{if(e&&this.modelValue)if(this.multiple){const e=this.modelValue.split(",")||[];e.map((e=>{this.BufferOption.map((t=>{var i=t;return t.value==e&&(i._checked=!0),i}))}))}else this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==this.modelValue})))}))},deep:!0,immediate:!0}},methods:{showModle(){this.showPicker=!0},fieldClick(){this.disabled||(this.forbidShow||(this.showPicker=!0),this.$emit("onFieldClick"))},setfieldValue(e=""){this.fieldValue=e},reset(){this.fieldValue="",this.BufferOption.map((e=>Object.assign(e,{_checked:!1}))),this.$emit("update:modelValue","")},setValue(e=""){if(this.multiple){const t=e.split(",")||[];t.map((e=>{this.BufferOption.map((t=>{var i=t;return t.value==e&&(i._checked=!0),i}))})),this.fieldValue=this.BufferOption.filter((e=>e._checked)).map((e=>e.text)).join()}else{const t=JSON.parse(JSON.stringify(this.BufferOption)).filter((t=>t.value==e))[0]||{};this.fieldValue=t.text}},confirmHandle(){const{multiple:e}=this,t=this.BufferOption.filter((e=>1==e._checked));e?(this.fieldValue=t.map((e=>e.text)).join(),this.$emit("update:modelValue",t.map((e=>e.value)).join()||""),this.$emit("onChange",t.map((e=>e.value)).join())):(this.fieldValue=(t[0]||{}).text,this.$emit("update:modelValue",(t[0]||{}).value||""),this.$emit("onChange",(t[0]||{}).value,t[0]||{})),this.showPicker=!1},checkChange(e){const{multiple:t}=this,{_checked:i,value:l}=e;t?this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==l?!i:e._checked}))):this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==l&&!i})))},multipleHandle(){const e=this.BufferOption.filter((e=>e._checked)),t=e.map((e=>e.value)).join();this.showPicker=!1,this.fieldValue=e.map((e=>e.text)).join(),this.$emit("update:modelValue",t),this.$emit("onChange",e)},searchHandle(e){const t=this.valueSearch.trim(),{filterSearch:i}=this;if(i&&e){const e=this.BufferOption.map((e=>Object.assign(e,{_searchColor:!1}))),i=e.filter((e=>e.text.includes(t))).map((e=>Object.assign(e,{_searchColor:!0})));if(!i.length)return void(0,p.LJ)("不存在！");const l=e.filter((e=>!e.text.includes(t))),a=l.filter((e=>e._checked)),o=l.filter((e=>!e._checked));this.BufferOption=i.concat(a).concat(o)}else e?this.$emit("onSearchChange",t):(this.valueSearch="",this.BufferOption=this.option,this.$nextTick((()=>{this.BufferOption=this.BufferOption.map((e=>Object.assign(e,{_checked:!1})))})),this.$emit("onSearchChange",""))},selectAllHandle(){this.BufferOption.map((e=>Object.assign(e,{_checked:!0})))}},props:{modelValue:{},disabled:{type:Boolean,default:()=>!1},showSearch:{type:Boolean,default:()=>!1},forbidShow:{type:Boolean,default:()=>!1},multiple:{type:Boolean,default:()=>!1},label:{type:String,default:()=>"标题"},placeholder:{type:String,default:()=>"请选择"},placeholderSearch:{type:String,default:()=>"请输入搜索关键词"},option:{type:Array,default:()=>[]},selectAll:{type:Boolean,default:()=>!1},required:{type:Boolean,default:()=>!1},filterSearch:{type:Boolean,default:()=>!1}}},m=i(40089);const f=(0,m.Z)(h,[["render",d]]);var w=f},57265:function(e,t,i){i.d(t,{Z:function(){return w}});var l=i(73396);const a={style:{padding:"0px 12px 0px 12px"}},o={key:0,class:"font-weight-medium text",style:{"margin-bottom":"8px"}},n={key:1,style:{"margin-bottom":"8px"},class:"font-weight-medium text"},s={class:"custem-iamge-upload"},r=["src"];function c(e,t,i,c,u,d){const p=(0,l.up)("van-uploader"),h=(0,l.up)("v-icon");return(0,l.wg)(),(0,l.iD)("span",null,[(0,l._)("div",a,[i.preview?((0,l.wg)(),(0,l.iD)("p",o,"图片预览 ")):((0,l.wg)(),(0,l.iD)("p",n," 图片上传 ")),i.preview?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(p,{key:2,"after-read":d.afterRead,"preview-image":!1},null,8,["after-read"])),(0,l._)("div",s,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.bufferFileList,((a,o)=>((0,l.wg)(),(0,l.iD)("li",{key:o,onClick:t[0]||(t[0]=t=>d.checkImage(e.bufferFileList))},[(0,l._)("img",{src:a.url},null,8,r),i.preview?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(h,{key:0,onClick:e=>d.removeClick(a,e),class:"icon",icon:"mdi-close-circle-outline",color:"red"},null,8,["onClick"]))])))),128))])])])}i(26699),i(32023),i(38862);var u=i(37184),d=i(20868),p=i(9801),h={components:{},emits:["update:modelValue","onChange"],data:()=>({bufferFileList:[]}),watch:{modelValue:{handler(e=[]){this.bufferFileList=e},deep:!0,immediate:!0},initPath:{handler(e=""){e&&(this.bufferFileList=e.split(",").map((e=>Object.assign({url:e}))))},deep:!0,immediate:!0}},methods:{checkImage(e=[]){e.length&&(0,p.V)(e.map((e=>e.url)))},async afterRead(e){if(!e.file.type.includes("image"))return void(0,d.LJ)("只能选择图片！");if(e.file.size>=19922944)return void(0,d.LJ)("图片超过20M！");if(this.bufferFileList.length>2)return void(0,d.LJ)("最多只能选择3张图片！");let t=new FormData;t.append("file",e.file);const{code:i,data:l={}}=await(0,u.i)({url:"/file/upload",method:"post",formData:!0,payload:t});200==i?(this.bufferFileList=this.bufferFileList.concat([l]),(0,d.XA)("图片上传成功！"),this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.bufferFileList)))):(0,d.LJ)("图片上传失败！")},removeClick(e,t){t.stopPropagation(),this.bufferFileList=JSON.parse(JSON.stringify(this.bufferFileList)).filter((t=>t.url!=e.url)),this.$nextTick((()=>{this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.bufferFileList)))}))}},props:{modelValue:{type:Array,default:()=>[]},initPath:{type:String,default:()=>""},preview:{type:Boolean,default:()=>!1}}},m=i(40089);const f=(0,m.Z)(h,[["render",c]]);var w=f},95741:function(e,t,i){i.r(t),i.d(t,{default:function(){return F}});var l=i(73396),a=i(87139);const o=(0,l._)("div",{style:{height:"12px"}},null,-1),n=(0,l._)("div",{style:{height:"12px"}},null,-1),s=(0,l._)("span",{class:"font-weight-medium"},"历史数据",-1),r={class:"font-weight-light font-weight-medium"},c=(0,l._)("span",null,"产线:",-1),u={style:{color:"aqua","padding-left":"12px"}},d={class:"font-weight-light font-weight-medium"},p=(0,l._)("span",null,"电表:",-1),h={style:{color:"aqua","padding-left":"12px"}},m={class:"font-weight-light font-weight-medium"},f=(0,l._)("span",null,"电表型号:",-1),w={style:{color:"aqua","padding-left":"12px"}},g={class:"font-weight-light font-weight-medium"},k=(0,l._)("span",null,"上次读表数据:",-1),y={style:{color:"aqua","padding-left":"12px","padding-right":"12px"}},b=(0,l._)("span",{class:"font-weight-medium"},"数据录入",-1);function _(e,t,i,_,v,x){const C=(0,l.up)("AppBarPage"),V=(0,l.up)("v-btn"),S=(0,l.up)("ScanBarComponents"),W=(0,l.up)("van-field"),O=(0,l.up)("v-col"),q=(0,l.up)("v-row"),B=(0,l.up)("van-cascader"),L=(0,l.up)("van-popup"),F=(0,l.up)("SelectComponents"),N=(0,l.up)("v-sheet"),$=(0,l.up)("v-icon"),U=(0,l.up)("UploaderImageComponents");return(0,l.wg)(),(0,l.iD)("span",null,[(0,l.Wm)(C),(0,l.Wm)(V,{style:{position:"fixed",top:"160px",right:"26px","z-index":"11",color:"#fff !important"},icon:"mdi-plus",color:"secondary",onClick:x.searchHandle},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1},8,["onClick"]),(0,l.Wm)(V,{style:{position:"fixed",top:"222px",right:"26px","z-index":"11",color:"#fff !important"},icon:"mdi-plus",color:"warning",onClick:x.restFunc},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1},8,["onClick"]),(0,l.Wm)(S,{ref:"scanBar1",placeholder:"扫描或输入 设备",onSearchClick:x.barSearchClick2},null,8,["onSearchClick"]),(0,l.Wm)(N,{elevation:"2",rounded:"",class:"pa-1"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{modelValue:e.fieldValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fieldValue=t),"is-link":"",readonly:"",label:"工厂节点",placeholder:"请选择工厂节点",type:"textarea",autocomplete:"off",onClick:t[1]||(t[1]=t=>e.show=!0)},null,8,["modelValue"]),(0,l.Wm)(L,{show:e.show,"onUpdate:show":t[3]||(t[3]=t=>e.show=t),round:"",position:"bottom"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{cols:"6"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{block:"",color:"warning",elevation:"0",style:{"border-radius":"0px"},onClick:x.factoryReset},{default:(0,l.w5)((()=>[(0,l.Uk)(" 重置 ")])),_:1},8,["onClick"])])),_:1}),(0,l.Wm)(O,{cols:"6"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{block:"",color:"cyan",elevation:"0",style:{"border-radius":"0px"},onClick:x.factoryAffirm},{default:(0,l.w5)((()=>[(0,l.Uk)(" 确定 ")])),_:1},8,["onClick"])])),_:1})])),_:1}),e.factoryShow?((0,l.wg)(),(0,l.j4)(B,{key:0,title:"请选择工厂节点",options:e.options,"active-color":"#4CAF50","field-names":{text:"nodeLevelName",value:"tmBasNodeLevelId",children:"children"},onClose:t[2]||(t[2]=t=>e.show=!1),onChange:x.onFinish},null,8,["options","onChange"])):(0,l.kq)("",!0)])),_:1},8,["show"]),(0,l.Wm)(F,{modelValue:e.equipment,"onUpdate:modelValue":t[4]||(t[4]=t=>e.equipment=t),ref:"selectContent",label:"设备",placeholderSearch:"请输入设备编号",showSearch:"",option:e.equipmentSelectOption,onOnFieldClick:x.onEquipmentFieldClick,onOnSearchChange:x.equipmentSearchChange,onOnChange:x.equipmentConfirm},null,8,["modelValue","option","onOnFieldClick","onOnSearchChange","onOnChange"])])),_:1}),o,n,(0,l.Wm)(N,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{"no-gutters":"",class:"custem-card-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{cols:"6"},{default:(0,l.w5)((()=>[(0,l.Wm)($,{icon:"mdi-alert-circle",size:"16",color:"warning"}),s])),_:1}),(0,l.Wm)(O,{cols:"6"})])),_:1}),(0,l.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",r,[c,(0,l._)("span",u,(0,a.zw)(e.bufferRow.lineName),1)])])),_:1})])),_:1}),(0,l.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",d,[p,(0,l._)("span",h,(0,a.zw)(e.bufferRow.equipmentName),1)])])),_:1})])),_:1}),(0,l.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",m,[f,(0,l._)("span",w,(0,a.zw)(e.bufferRow.deviceModel),1)])])),_:1})])),_:1}),(0,l.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{cols:"12"},{default:(0,l.w5)((()=>[(0,l._)("p",g,[k,(0,l._)("span",y,(0,a.zw)(e.bufferRow.endVal),1),(0,l.Uk)(" KW.h ")])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(N,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{"no-gutters":"",class:"custem-card-title"},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{cols:"6"},{default:(0,l.w5)((()=>[(0,l.Wm)($,{icon:"mdi-plus",size:"16",color:"primary"}),b])),_:1}),(0,l.Wm)(O,{cols:"6"})])),_:1}),(0,l.Wm)(W,{modelValue:e.text1,"onUpdate:modelValue":t[5]||(t[5]=t=>e.text1=t),placeholder:"请输入",autocomplete:"off",type:"number",label:"用电累积数"},{button:(0,l.w5)((()=>[(0,l.Uk)(" KW.h ")])),_:1},8,["modelValue"]),(0,l.Wm)(W,{modelValue:e.text2,"onUpdate:modelValue":t[6]||(t[6]=t=>e.text2=t),placeholder:"请输入",autocomplete:"off",type:"number",label:"电流量"},{button:(0,l.w5)((()=>[(0,l.Uk)(" A ")])),_:1},8,["modelValue"]),(0,l.Wm)(W,{modelValue:e.text3,"onUpdate:modelValue":t[7]||(t[7]=t=>e.text3=t),placeholder:"请输入",autocomplete:"off",type:"number",label:"电压量"},{button:(0,l.w5)((()=>[(0,l.Uk)(" V ")])),_:1},8,["modelValue"]),(0,l.Wm)(U,{modelValue:e.bufferFileList,"onUpdate:modelValue":t[8]||(t[8]=t=>e.bufferFileList=t)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(q,{"no-gutters":"",class:"text"},{default:(0,l.w5)((()=>[(0,l.Wm)(O,{cols:"12"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{onClick:x.submit,block:"",color:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)(" 提交 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])}i(73210);var v=i(76496),x=i(73378),C=i(2243),V=i(57265),S=i(20868),W=(i(89337),i(37184)),O=i(5878),q={components:{AppBarPage:v.Z,SelectComponents:C.Z,UploaderImageComponents:V.Z,ScanBarComponents:x.Z},data:()=>({factoryShow:!0,checked1:!0,checked2:!0,bufferTree:[],bufferRow:{},nodeCode:"",bufferFileList:[],tableList:[],text1:"",text2:"",text3:"",show:!1,fieldValue:"",fieldSelectValue:{},options:[],equipment:"",equipmentSelectOption:[],equipmentSelectOptionData:[]}),created(){this.initFunc(),this.equipmentHTTP()},methods:{async initFunc(e="",t){const{code:i,data:l=[]}=await(0,W.i)({url:"/iiot/nodeLevel/getNodeLevelByLineNode",method:"get",url_params:{noOrName:e}});if(200==i){const e=(0,O.b)(l,"tmBasNodeLevelId","parentId");this.bufferTree=l,this.options=e,t&&t()}},async equipmentHTTP(e=""){const{fieldSelectValue:t={},nodeCode:i=""}=this,{code:l,data:a=[]}=await(0,W.i)({url:"/iiot/equipment/getEquipmentByKey",method:"get",url_params:{nodeCode:i,equipmentNo:e}});200==l&&(this.equipmentSelectOptionData=a,this.equipmentSelectOption=a.map((e=>Object.assign({text:`${e.equipmentNo}-${e.equipmentName}`,value:e.equipmentNo}))))},async barSearchClick(e){const t=e.trim(),{bufferTree:i}=this;this.factoryReset(),this.initFunc(t,(()=>{this.show=!0}))},onFinish({selectedOptions:e}){this.fieldSelectValue=e[e.length-1]||{},this.fieldValue=e.map((e=>e.nodeLevelName)).join("/")},factoryReset(){this.fieldValue="",this.fieldSelectValue={},this.show=!1,this.nodeCode="",this.factoryShow=!1,this.$nextTick((async()=>{await this.equipmentHTTP(),this.factoryShow=!0}))},async factoryAffirm(){this.show=!1,this.$nextTick((()=>{this.nodeCode=this.fieldSelectValue.nodeLevelNo,this.$nextTick((async()=>{await this.equipmentHTTP(),this.$refs.selectContent.showModle()}))}))},async onEquipmentFieldClick(){},async equipmentSearchChange(e=""){this.equipmentHTTP(e)},restFunc(){this.fieldValue="",this.factoryID="",this.$refs["scanBar1"]&&this.$refs["scanBar1"].reset(),this.nodeCode="",this.fieldSelectValue={},this.equipment="",this.bufferRow={},this.hideFactory=!1,this.$nextTick((()=>{this.hideFactory=!0,this.$refs.selectContent&&this.$refs.selectContent.reset(),this.equipmentHTTP()}))},barSearchClick2(e){const t=e.trim();this.equipmentHTTP(t),this.$refs.selectContent.showModle()},async searchHandle(){const{equipment:e}=this;if(!e)return void(0,S.LJ)("设备未选择！");const{code:t,data:i={}}=await(0,W.i)({url:"/collect/energySources/getEnergyRecordManually",method:"get",url_params:{equipmentCode:e}});200==t&&(this.bufferRow=i)},equipmentConfirm(e){this.$nextTick((()=>{this.searchHandle()}))},removeIcon(e){this.tableList=this.tableList.filter((t=>t.tmBasEquipmentId!=e.tmBasEquipmentId))},async submit(){if(!this.equipment)return void(0,S.LJ)("设备不能为空！");if(!this.text1)return void(0,S.LJ)("用电累积数不能为空！");const e={lineNo:this.nodeCode,equipmentNo:this.equipment,totalElectricityNums:Number(this.text1),voltageNums:Number(this.text2),electricityNums:Number(this.text3),energyPicture:this.bufferFileList.map((e=>e.url)).join()},{code:t,data:i={}}=await(0,W.i)({url:"/collect/energySources/energyRecordManually",method:"post",payload:e});200==t&&((0,S.XA)("提交成功！"),this.searchHandle())}}},B=i(40089);const L=(0,B.Z)(q,[["render",_]]);var F=L}}]);
//# sourceMappingURL=chunk.8032.1689576161502.js.map