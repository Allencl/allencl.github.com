"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[7487],{2243:function(e,t,a){a.d(t,{Z:function(){return g}});var i=a(73396),l=a(87139);const s={style:{height:"98%","padding-bottom":"40px"}},o={style:{height:"100%"}},n={style:{position:"relative",top:"4px"}},r=["onClick"],c={class:"text-truncate",style:{height:"24px"}},u={key:2,class:"text-center",style:{"margin-top":"16px"}};function p(e,t,a,p,d,m){const h=(0,i.up)("van-field"),f=(0,i.up)("v-col"),g=(0,i.up)("v-btn"),w=(0,i.up)("v-row"),_=(0,i.up)("van-search"),k=(0,i.up)("van-checkbox"),y=(0,i.up)("van-popup");return(0,i.wg)(),(0,i.iD)("span",null,[(0,i.Wm)(h,{modelValue:e.fieldValue,"onUpdate:modelValue":t[0]||(t[0]=t=>e.fieldValue=t),"is-link":"",readonly:"",required:a.required,label:a.label,placeholder:a.placeholder,autocomplete:"off",type:a.multiple?"textarea":"text",onClick:m.fieldClick},null,8,["modelValue","required","label","placeholder","type","onClick"]),(0,i.Wm)(y,{show:e.showPicker,"onUpdate:show":t[5]||(t[5]=t=>e.showPicker=t),style:{padding:"12px 12px 4px 12px",height:"60%",width:"90%"},round:""},{default:(0,i.w5)((()=>[(0,i._)("div",s,[(0,i._)("div",o,[(0,i.Wm)(w,{"no-gutters":"",style:{"font-weight":"bold","border-bottom":"1px solid #ccc","padding-bottom":"5px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{cols:"6"},{default:(0,i.w5)((()=>[(0,i._)("p",null,(0,l.zw)(a.label)+"-选择框",1)])),_:1}),(0,i.Wm)(f,{cols:"6",class:"text-right"},{default:(0,i.w5)((()=>[(0,i._)("span",n,(0,l.zw)(e.BufferOption.filter((e=>e._checked)).length),1),a.selectAll?((0,i.wg)(),(0,i.j4)(g,{key:0,onClick:m.selectAllHandle,color:"primary mt-1",density:"compact",rounded:0,variant:"plain"},{default:(0,i.w5)((()=>[(0,i.Uk)("全选")])),_:1},8,["onClick"])):(0,i.kq)("",!0)])),_:1})])),_:1}),a.showSearch?((0,i.wg)(),(0,i.j4)(w,{key:0,"no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{cols:"8"},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{modelValue:e.valueSearch,"onUpdate:modelValue":t[1]||(t[1]=t=>e.valueSearch=t),shape:"",placeholder:a.placeholderSearch,style:{"padding-left":"0px"},clearable:!1},null,8,["modelValue","placeholder"])])),_:1}),(0,i.Wm)(f,{cols:"2"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{onClick:t[2]||(t[2]=e=>m.searchHandle(!0)),variant:"plain",color:"primary",block:"",style:{"margin-top":"8px"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" 查询 ")])),_:1})])),_:1}),(0,i.Wm)(f,{cols:"2"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{onClick:t[3]||(t[3]=e=>m.searchHandle(!1)),variant:"plain",block:"",style:{"margin-top":"8px"}},{default:(0,i.w5)((()=>[(0,i.Uk)(" 重置 ")])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0),e.BufferOption.length?((0,i.wg)(),(0,i.iD)("ul",{key:1,style:(0,l.j5)(`height: ${a.showSearch?"73%":"90%"};overflow-y:auto;padding-right:12px;padding-bottom: 20px;`)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.BufferOption,((e,t)=>((0,i.wg)(),(0,i.iD)("li",{key:t,style:(0,l.j5)(`padding: 6px 22px 6px 6px;position:relative;color:${e._searchColor?"#FF9800":"#000"};`),onClick:t=>m.checkChange(e)},[(0,i._)("p",c,(0,l.zw)(e.text),1),(0,i.Wm)(k,{style:{position:"absolute",top:"8px",right:"0px"},modelValue:e._checked,"onUpdate:modelValue":t=>e._checked=t,shape:"square","checked-color":"#4CAF50",disabled:"",class:"custem-select-checkbox"},null,8,["modelValue","onUpdate:modelValue"])],12,r)))),128))],4)):((0,i.wg)(),(0,i.iD)("p",u,"无数据!"))]),(0,i.Wm)(w,{"no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{cols:"6",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{variant:"plain",block:"",onClick:t[4]||(t[4]=()=>e.showPicker=!1)},{default:(0,i.w5)((()=>[(0,i.Uk)(" 取消 ")])),_:1})])),_:1}),(0,i.Wm)(f,{cols:"6",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{variant:"plain",color:"primary",block:"",onClick:m.confirmHandle},{default:(0,i.w5)((()=>[(0,i.Uk)(" 确定 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1},8,["show"])])}a(38862),a(73210),a(26699),a(32023);var d=a(20868),m={components:{},emits:["update:modelValue","onChange","onFieldClick","onSearchChange"],data:()=>({BufferOption:[],selectedValues:[],columns:[],fieldValue:"",showPicker:!1,valueSearch:""}),watch:{option:{handler(e=[]){this.BufferOption=JSON.parse(JSON.stringify(e)),this.$nextTick((()=>{this.modelValue&&this.setValue(this.modelValue)}))},deep:!0,immediate:!0},showPicker:{handler(e){this.$nextTick((()=>{if(e&&this.modelValue)if(this.multiple){const e=this.modelValue.split(",")||[];e.map((e=>{this.BufferOption.map((t=>{var a=t;return t.value==e&&(a._checked=!0),a}))}))}else this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==this.modelValue})))}))},deep:!0,immediate:!0}},methods:{showModle(){this.showPicker=!0},fieldClick(){this.disabled||(this.forbidShow||(this.showPicker=!0),this.$emit("onFieldClick"))},setfieldValue(e=""){this.fieldValue=e},reset(){this.fieldValue="",this.BufferOption.map((e=>Object.assign(e,{_checked:!1}))),this.$emit("update:modelValue","")},setValue(e=""){if(this.multiple){const t=e.split(",")||[];t.map((e=>{this.BufferOption.map((t=>{var a=t;return t.value==e&&(a._checked=!0),a}))})),this.fieldValue=this.BufferOption.filter((e=>e._checked)).map((e=>e.text)).join()}else{const t=JSON.parse(JSON.stringify(this.BufferOption)).filter((t=>t.value==e))[0]||{};this.fieldValue=t.text}},confirmHandle(){const{multiple:e}=this,t=this.BufferOption.filter((e=>1==e._checked));e?(this.fieldValue=t.map((e=>e.text)).join(),this.$emit("update:modelValue",t.map((e=>e.value)).join()||""),this.$emit("onChange",t.map((e=>e.value)).join())):(this.fieldValue=(t[0]||{}).text,this.$emit("update:modelValue",(t[0]||{}).value||""),this.$emit("onChange",(t[0]||{}).value,t[0]||{})),this.showPicker=!1},checkChange(e){const{multiple:t}=this,{_checked:a,value:i}=e;t?this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==i?!a:e._checked}))):this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==i&&!a})))},multipleHandle(){const e=this.BufferOption.filter((e=>e._checked)),t=e.map((e=>e.value)).join();this.showPicker=!1,this.fieldValue=e.map((e=>e.text)).join(),this.$emit("update:modelValue",t),this.$emit("onChange",e)},searchHandle(e){const t=this.valueSearch.trim(),{filterSearch:a}=this;if(a&&e){const e=this.BufferOption.map((e=>Object.assign(e,{_searchColor:!1}))),a=e.filter((e=>e.text.includes(t))).map((e=>Object.assign(e,{_searchColor:!0})));if(!a.length)return void(0,d.LJ)("不存在！");const i=e.filter((e=>!e.text.includes(t))),l=i.filter((e=>e._checked)),s=i.filter((e=>!e._checked));this.BufferOption=a.concat(l).concat(s)}else e?this.$emit("onSearchChange",t):(this.valueSearch="",this.BufferOption=this.option,this.$nextTick((()=>{this.BufferOption=this.BufferOption.map((e=>Object.assign(e,{_checked:!1})))})),this.$emit("onSearchChange",""))},selectAllHandle(){this.BufferOption.map((e=>Object.assign(e,{_checked:!0})))}},props:{modelValue:{},disabled:{type:Boolean,default:()=>!1},showSearch:{type:Boolean,default:()=>!1},forbidShow:{type:Boolean,default:()=>!1},multiple:{type:Boolean,default:()=>!1},label:{type:String,default:()=>"标题"},placeholder:{type:String,default:()=>"请选择"},placeholderSearch:{type:String,default:()=>"请输入搜索关键词"},option:{type:Array,default:()=>[]},selectAll:{type:Boolean,default:()=>!1},required:{type:Boolean,default:()=>!1},filterSearch:{type:Boolean,default:()=>!1}}},h=a(40089);const f=(0,h.Z)(m,[["render",p]]);var g=f},88575:function(e,t,a){a.d(t,{Z:function(){return W}});var i=a(73396),l=a(87139);const s={style:{position:"relative",top:"3px","margin-left":"6px","font-size":"14px"}},o=(0,i._)("span",null,"第",-1),n={style:{"padding-left":"1px","padding-right":"1px"}},r=(0,i._)("span",{style:{"margin-right":"3px"}},"页",-1),c=(0,i._)("span",null,"共",-1),u={style:{"padding-left":"1px","padding-right":"1px"}},p=(0,i._)("span",{style:{"margin-right":"3px"}},"页",-1),d=(0,i._)("span",null,"总",-1),m={style:{"padding-left":"1px","padding-right":"1px"}},h=(0,i._)("span",null,"条",-1),f={style:{position:"relative",top:"1px","margin-left":"0px"}},g={key:2,class:"text-center",style:{"padding-top":"12px"}};function w(e,t,a,w,_,k){const y=(0,i.up)("v-icon"),b=(0,i.up)("v-btn"),x=(0,i.up)("v-card");return(0,i.wg)(),(0,i.iD)("span",null,[e.paging&&a.pagingShow?((0,i.wg)(),(0,i.j4)(x,{key:0,elevation:"0",style:{"margin-bottom":"0px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{variant:"outlined",size:"x-small",icon:"",color:"primary",style:{"margin-right":"6px",width:"28px",height:"28px"},onClick:k.previousHandle},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{size:"28"},{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-chevron-left")])),_:1})])),_:1},8,["onClick"]),(0,i.Wm)(b,{variant:"outlined",size:"x-small",icon:"",color:"primary",style:{width:"28px",height:"28px"},onClick:k.nextHandle},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{size:"28"},{default:(0,i.w5)((()=>[(0,i.Uk)("mdi-chevron-right")])),_:1})])),_:1},8,["onClick"]),(0,i._)("span",s,[o,(0,i._)("span",n,(0,l.zw)(e.current),1),r,c,(0,i._)("span",u,(0,l.zw)(e.page),1),p,d,(0,i._)("span",m,(0,l.zw)(e.totalNum),1),h]),(0,i._)("span",f,[a.showSearchBtn?((0,i.wg)(),(0,i.j4)(b,{key:0,style:{"padding-left":"8px","padding-right":"4px"},onClick:k.searchClick,variant:"plain",color:"primary"},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{size:"24",icon:"mdi-magnify"}),(0,i.Uk)(" 查询 ")])),_:1},8,["onClick"])):(0,i.kq)("",!0),(0,i.Wm)(b,{onClick:k.refreshClick,style:(0,l.j5)(["min-width: 42px;width: 42px",{padding:"0"}]),variant:"plain",color:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)(" 刷新 ")])),_:1},8,["onClick"])])])),_:1})):(0,i.kq)("",!0),e.items.length?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(e.items,((t,a)=>(0,i.WI)(e.$slots,"tableBody",{key:a,items:t,_index:a}))),128)):((0,i.wg)(),(0,i.iD)("p",g,[(0,i.Wm)(y,{icon:"mdi-emoticon-sad-outline"}),(0,i.Uk)(" 无数据！ ")]))])}var _=a(21801),k=a(37184);var y=a(20868),b={components:{},emits:["searchClick","refresh"],data:()=>({totalNum:0,current:1,page:0,paging:!0,items:[]}),created(){const{auto:e,url:t}=this;e&&t&&this.initFunc()},methods:{previousHandle(){const{current:e}=this;1!=e?(this.current=e-1,this.$nextTick((()=>{this.initFunc(this.current)}))):(0,y.LJ)("第一页！")},nextHandle(){const{current:e,page:t}=this;e>=t?(0,y.LJ)("最后一页！"):(this.current=e+1,this.$nextTick((()=>{this.initFunc(this.current)})))},async initFunc(e=1,t){const{url:a,params:i={},children:l,method:s,formatData:o}=this;if(l)return this.items=l,void(this.paging=!1);const n=(0,_.Z)((0,_.Z)({pageNum:e,pageSize:10},i),t),{code:r,total:c=0,msg:u="",data:p,rows:d}=await(0,k.i)({method:s,url:a,payload:"post"==s?n:{},url_params:"get"==s?n:{}});200==r&&(this.totalNum=c,this.current=e,this.page=Math.ceil(c/n.pageSize),this.items=o?o(p||d||[]):p||d||[])},refreshClick(){const{refreshFunc:e}=this;!e&&this.initFunc(1),this.$emit("refresh")},searchClick(){this.$emit("searchClick")},resultData(){return this.items||[]},selectAll(){this.items=this.items.map((e=>Object.assign(e,{_checked:!0})))}},props:{method:{type:String,default:()=>"get"},refreshFunc:{type:Boolean,default:()=>!1},showSearchBtn:{type:Boolean,default:()=>!1},auto:{type:Boolean,default:()=>!0},pagingShow:{type:Boolean,default:()=>!0},children:{type:Array,default:()=>{}},url:{type:String,default:()=>""},params:{type:Object,default:()=>{}},formatData:{}}},x=a(40089);const v=(0,x.Z)(b,[["render",w]]);var W=v},57265:function(e,t,a){a.d(t,{Z:function(){return g}});var i=a(73396);const l={style:{padding:"0px 12px 0px 12px"}},s={key:0,class:"font-weight-medium text",style:{"margin-bottom":"8px"}},o={key:1,style:{"margin-bottom":"8px"},class:"font-weight-medium text"},n={class:"custem-iamge-upload"},r=["src"];function c(e,t,a,c,u,p){const d=(0,i.up)("van-uploader"),m=(0,i.up)("v-icon");return(0,i.wg)(),(0,i.iD)("span",null,[(0,i._)("div",l,[a.preview?((0,i.wg)(),(0,i.iD)("p",s,"图片预览 ")):((0,i.wg)(),(0,i.iD)("p",o," 图片上传 ")),a.preview?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(d,{key:2,"after-read":p.afterRead,"preview-image":!1},null,8,["after-read"])),(0,i._)("div",n,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.bufferFileList,((l,s)=>((0,i.wg)(),(0,i.iD)("li",{key:s,onClick:t[0]||(t[0]=t=>p.checkImage(e.bufferFileList))},[(0,i._)("img",{src:l.url},null,8,r),a.preview?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(m,{key:0,onClick:e=>p.removeClick(l,e),class:"icon",icon:"mdi-close-circle-outline",color:"red"},null,8,["onClick"]))])))),128))])])])}a(26699),a(32023),a(38862);var u=a(37184),p=a(20868),d=a(9801),m={components:{},emits:["update:modelValue","onChange"],data:()=>({bufferFileList:[]}),watch:{modelValue:{handler(e=[]){this.bufferFileList=e},deep:!0,immediate:!0},initPath:{handler(e=""){e&&(this.bufferFileList=e.split(",").map((e=>Object.assign({url:e}))))},deep:!0,immediate:!0}},methods:{checkImage(e=[]){e.length&&(0,d.V)(e.map((e=>e.url)))},async afterRead(e){if(!e.file.type.includes("image"))return void(0,p.LJ)("只能选择图片！");if(e.file.size>=19922944)return void(0,p.LJ)("图片超过20M！");if(this.bufferFileList.length>2)return void(0,p.LJ)("最多只能选择3张图片！");let t=new FormData;t.append("file",e.file);const{code:a,data:i={}}=await(0,u.i)({url:"/file/upload",method:"post",formData:!0,payload:t});200==a?(this.bufferFileList=this.bufferFileList.concat([i]),(0,p.XA)("图片上传成功！"),this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.bufferFileList)))):(0,p.LJ)("图片上传失败！")},removeClick(e,t){t.stopPropagation(),this.bufferFileList=JSON.parse(JSON.stringify(this.bufferFileList)).filter((t=>t.url!=e.url)),this.$nextTick((()=>{this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.bufferFileList)))}))}},props:{modelValue:{type:Array,default:()=>[]},initPath:{type:String,default:()=>""},preview:{type:Boolean,default:()=>!1}}},h=a(40089);const f=(0,h.Z)(m,[["render",c]]);var g=f},47487:function(e,t,a){a.r(t),a.d(t,{default:function(){return X}});var i=a(73396),l=a(87139);const s=(0,i._)("p",{class:"font-weight-medium text"},"检验产品:",-1),o=(0,i._)("p",{class:"font-weight-medium text"},"订单号:",-1),n={class:"text-truncate font-weight-light"},r=(0,i._)("p",{class:"font-weight-medium text"},"工作中心:",-1),c={class:"text-truncate font-weight-light"},u=(0,i._)("p",{class:"font-weight-medium text"},"产品SN号:",-1),p={class:"text-truncate font-weight-light"},d=(0,i._)("p",{class:"font-weight-medium text"},"检验类型:",-1),m={class:"text-truncate font-weight-light"},h={class:"text-truncate font-weight-light"},f=(0,i._)("span",{class:"font-weight-medium text"},"检验数量: ",-1),g={class:"text-truncate font-weight-light"},w={style:{color:"#00E5FF"}},_={class:"text-truncate font-weight-light font-weight-medium text"},k={style:{"padding-left":"12px",color:"#00E5FF"}},y=(0,i._)("div",{style:{height:"6px"}},null,-1),b={class:"font-weight-light",style:{color:"#00E5FF"}},x=(0,i._)("p",{class:"font-weight-medium text"},"检验项目:",-1),v=["onClick"],W=(0,i._)("span",{class:"font-weight-medium text"},"检验明细:",-1),C=["onClick"],S={class:"text-truncate font-weight-light"},O=(0,i._)("span",{class:"font-weight-medium text"},"标准值: ",-1),T={class:"text-truncate font-weight-light"},F=(0,i._)("span",{class:"font-weight-medium text"},"最大值: ",-1),D={class:"text-truncate font-weight-light"},q=(0,i._)("span",{class:"font-weight-medium text"},"最小值: ",-1),V=(0,i._)("div",{style:{height:"3px"}},null,-1),L=(0,i._)("p",{style:{"margin-top":"8px"},class:"font-weight-medium text input-lable"},"检验结果:",-1),j=(0,i._)("div",{style:{height:"80px"}},null,-1),N=(0,i._)("span",null,"结果: ",-1),$={key:2},R=(0,i._)("div",{style:{height:"60px"}},null,-1);function B(e,t,a,B,I,U){const J=(0,i.up)("AppBarPage"),H=(0,i.up)("v-col"),A=(0,i.up)("v-row"),P=(0,i.up)("v-sheet"),z=(0,i.up)("SelectComponents"),Q=(0,i.up)("v-btn"),Z=(0,i.up)("v-badge"),X=(0,i.up)("van-field"),M=(0,i.up)("v-switch"),E=(0,i.up)("UploaderImageComponents"),G=(0,i.up)("TableComponents");return(0,i.wg)(),(0,i.iD)("span",null,[(0,i.Wm)(J),(0,i.Wm)(P,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,i.w5)((()=>[(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[s])),_:1}),(0,i.Wm)(H,{cols:"8"},{default:(0,i.w5)((()=>[(0,i._)("p",{onClick:t[0]||(t[0]=t=>U.GlobalTooltipFunc(e.bufferRow.partName)),class:"font-weight-light text-left"},(0,l.zw)(e.bufferRow.partName),1)])),_:1})])),_:1}),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[o])),_:1}),(0,i.Wm)(H,{cols:"8"},{default:(0,i.w5)((()=>[(0,i._)("p",n,(0,l.zw)(e.bufferRow.orderNo),1)])),_:1})])),_:1}),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[r])),_:1}),(0,i.Wm)(H,{cols:"8"},{default:(0,i.w5)((()=>[(0,i._)("p",c,(0,l.zw)(e.bufferRow.nodeLevelName),1)])),_:1})])),_:1}),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[u])),_:1}),(0,i.Wm)(H,{cols:"8"},{default:(0,i.w5)((()=>[(0,i._)("p",p,(0,l.zw)(e.bufferRow.sn),1)])),_:1})])),_:1}),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[d])),_:1}),(0,i.Wm)(H,{cols:"8"},{default:(0,i.w5)((()=>[(0,i._)("p",m,(0,l.zw)(U.FormatDictionary("test_type",e.bufferRow.taskType)["lable"]),1)])),_:1})])),_:1}),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"6"},{default:(0,i.w5)((()=>[(0,i._)("p",h,[f,(0,i.Uk)(" "+(0,l.zw)(e.bufferRow.taskQty),1)])])),_:1}),(0,i.Wm)(H,{cols:"6",class:"text-right"},{default:(0,i.w5)((()=>[(0,i._)("p",g,[(0,i.Uk)(" 状态: "),(0,i._)("span",w,(0,l.zw)(U.FormatDictionary("qm_task_status",e.bufferRow.taskStatus)["lable"]),1)])])),_:1})])),_:1})])),_:1}),2==e._pageIndex||3==e._pageIndex?((0,i.wg)(),(0,i.j4)(z,{key:0,modelValue:e.process,"onUpdate:modelValue":t[1]||(t[1]=t=>e.process=t),label:"工序",ref:"select111",disabled:e._pageActive,option:e.processSelectOption,onOnChange:U.onChangeProcess},null,8,["modelValue","disabled","option","onOnChange"])):(0,i.kq)("",!0),e.tableList.filter((e=>"1"==e.isBatteryCheck)).length?((0,i.wg)(),(0,i.j4)(A,{key:1,style:{"margin-top":"0px","margin-bottom":"12px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12",style:{padding:"0px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{block:"",color:"warning",onClick:t[2]||(t[2]=t=>U.batteryHandle(e.tableList))},{default:(0,i.w5)((()=>[(0,i.Uk)(" 电池曲线调试 ")])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(P,{class:"v-window-item-table"},{default:(0,i.w5)((()=>[(0,i.Wm)(G,{ref:"table1",children:e.tableList,pagingShow:!1},{tableBody:(0,i.w5)((t=>[(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(A,{"no-gutters":"",class:"table-title"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"1"},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{content:t._index+1,color:"primary",inline:""},null,8,["content"])])),_:2},1024),(0,i.Wm)(H,{cols:"10"},{default:(0,i.w5)((()=>[(0,i._)("p",_,[(0,i._)("span",k,(0,l.zw)(`<${U.FormatDictionary("checkout_param_type",t.items.parameterType)["lable"]}类型>`),1)])])),_:2},1024)])),_:2},1024),y,(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12"},{default:(0,i.w5)((()=>[(0,i._)("p",b,(0,l.zw)(t.items.inspectName),1)])),_:2},1024)])),_:2},1024),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[x])),_:1}),(0,i.Wm)(H,{cols:"8"},{default:(0,i.w5)((()=>[(0,i._)("p",{onClick:e=>U.GlobalTooltipFunc(t.items.inspectName),class:"text-truncate font-weight-light"},(0,l.zw)(t.items.inspectName),9,v)])),_:2},1024)])),_:2},1024),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12"},{default:(0,i.w5)((()=>[W,(0,i._)("span",{onClick:e=>U.GlobalTooltipFunc(`${t.items.inspectDetailName||""}`),class:"font-weight-light",style:{"padding-left":"6px"}},(0,l.zw)(t.items.inspectDetailName),9,C)])),_:2},1024)])),_:2},1024),"DT"==t.items.parameterType?((0,i.wg)(),(0,i.j4)(A,{key:0,"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[(0,i._)("p",S,[O,(0,i.Uk)(" "+(0,l.zw)(t.items.parameterDefault),1)])])),_:2},1024),(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[(0,i._)("p",T,[F,(0,i.Uk)(" "+(0,l.zw)(t.items.upperDeviation),1)])])),_:2},1024),(0,i.Wm)(H,{cols:"4"},{default:(0,i.w5)((()=>[(0,i._)("p",D,[q,(0,i.Uk)(" "+(0,l.zw)(t.items.lowerDeviation),1)])])),_:2},1024)])),_:2},1024)):(0,i.kq)("",!0),V,(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"3"},{default:(0,i.w5)((()=>[L])),_:1}),(0,i.Wm)(H,{cols:"9"},{default:(0,i.w5)((()=>[(0,i.Wm)(X,{modelValue:t.items.resultValue,"onUpdate:modelValue":[e=>t.items.resultValue=e,e=>U.resultValueHandle(t)],style:(0,l.j5)([{padding:"0px"},"padding-top:0px;"]),size:"large",placeholder:"请输入检验结果",autocomplete:"off",class:"custem-input-index1 custem-input-big",type:""+("DT"==U.FormatDictionary("checkout_param_type",t.items.parameterType).value?"number":"text"),onFocus:e.$root.$utils.VanFieldFocusToTop},null,8,["modelValue","onUpdate:modelValue","type","onFocus"])])),_:2},1024)])),_:2},1024),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12",style:{position:"relative",left:"-14px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(z,{modelValue:t.items._urgency,"onUpdate:modelValue":e=>t.items._urgency=e,ref:"select4",label:"不良描述",class:"custem-select-big",showSearch:"",option:e.urgencySelectOption,onOnSearchChange:U.productSearchChange},null,8,["modelValue","onUpdate:modelValue","option","onOnSearchChange"])])),_:2},1024)])),_:2},1024),(0,i.Wm)(A,{"no-gutters":"",class:"text"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12",style:{"text-align":"right"}},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{modelValue:t.items._switch,"onUpdate:modelValue":e=>t.items._switch=e,label:t.items._switch?"合格":"不合格",color:"primary",density:"comfortable",disabled:e._pageActive||"DT"==U.FormatDictionary("checkout_param_type",t.items.parameterType).value,style:{top:"-10px",left:"8px",position:"relative",height:"48px",display:"block",width:"104px"}},null,8,["modelValue","onUpdate:modelValue","label","disabled"])])),_:2},1024)])),_:2},1024),t.items._switch?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(A,{key:1,"no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12"},{default:(0,i.w5)((()=>[(0,i.Wm)(E,{modelValue:t.items._bufferFileList,"onUpdate:modelValue":e=>t.items._bufferFileList=e,preview:e._pageActive},null,8,["modelValue","onUpdate:modelValue","preview"])])),_:2},1024)])),_:2},1024)),"1"==t.items.isRectiify?((0,i.wg)(),(0,i.j4)(A,{key:2,"no-gutters":"",style:{padding:"6px 8px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{block:"",color:"warning",onClick:e=>U.rectifyHandle(t.items)},{default:(0,i.w5)((()=>[(0,i.Uk)(" 整改 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)):(0,i.kq)("",!0)])),_:2},1024)])),_:1},8,["children"])])),_:1}),j,(0,i.Wm)(A,{class:"global-botom-btn-box",style:{bottom:"122px","padding-top":"12px",background:"#fff"},"no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12",style:{"margin-bottom":"18px","padding-left":"6px"}},{default:(0,i.w5)((()=>[(0,i._)("p",null,[N,(0,i._)("span",{style:(0,l.j5)(U.FormatBottomResultColor())},(0,l.zw)(U.FormatBottomResult()),5)])])),_:1})])),_:1}),e._pageActive?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("span",$,[1==e._pageIndex?((0,i.wg)(),(0,i.j4)(A,{key:0,class:"global-botom-btn-box","no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"5",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{color:"warning",onClick:U.disqualificationApplyHandle},{default:(0,i.w5)((()=>[(0,i.Uk)(" 不合格处理申请 ")])),_:1},8,["onClick"])])),_:1}),(0,i.Wm)(H,{cols:"4",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{color:"error",onClick:t[3]||(t[3]=e=>U.standardHandle(!1))},{default:(0,i.w5)((()=>[(0,i.Uk)(" 不合格 ")])),_:1})])),_:1}),(0,i.Wm)(H,{cols:"3",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{color:"primary",onClick:t[4]||(t[4]=e=>U.standardHandle(!0))},{default:(0,i.w5)((()=>[(0,i.Uk)(" 合格 ")])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0),2==e._pageIndex||3==e._pageIndex?((0,i.wg)(),(0,i.j4)(A,{key:1,style:{bottom:"118px"},class:"global-botom-btn-box","no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"5",class:"text-center"},{default:(0,i.w5)((()=>[3==e._pageIndex?((0,i.wg)(),(0,i.j4)(Q,{key:0,disabled:"B"!=e.qmTaskData.processState,onClick:t[5]||(t[5]=e=>U.shiftToHandle("C")),color:"purple",block:""},{default:(0,i.w5)((()=>[(0,i.Uk)(" 转入库检验 ")])),_:1},8,["disabled"])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(H,{cols:"2"}),2==e._pageIndex||3==e._pageIndex?((0,i.wg)(),(0,i.j4)(H,{key:0,cols:"5",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{color:"cyan",onClick:t[6]||(t[6]=e=>U.submitHandle(void 0)),block:""},{default:(0,i.w5)((()=>[(0,i.Uk)(" 提交 ")])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1})):(0,i.kq)("",!0),2==e._pageIndex||3==e._pageIndex?((0,i.wg)(),(0,i.j4)(A,{key:2,style:{bottom:"64px"},class:"global-botom-btn-box","no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"5",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{onClick:t[7]||(t[7]=e=>U.anomalyInitiateSectionFunc(1)),color:"primary",block:""},{default:(0,i.w5)((()=>[(0,i.Uk)("例外转序发起")])),_:1})])),_:1}),(0,i.Wm)(H,{cols:"2"}),(0,i.Wm)(H,{cols:"5",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{onClick:t[8]||(t[8]=e=>U.anomalyInitiateSectionFunc(2)),color:"error",block:""},{default:(0,i.w5)((()=>[(0,i.Uk)("例外转序关闭")])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0),4==e._pageIndex?((0,i.wg)(),(0,i.j4)(A,{key:3,class:"global-botom-btn-box","no-gutters":""},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{cols:"12",class:"text-center"},{default:(0,i.w5)((()=>[(0,i.Wm)(Q,{color:"cyan",onClick:t[9]||(t[9]=e=>U.submitHandle(void 0)),block:""},{default:(0,i.w5)((()=>[(0,i.Uk)(" 提交 ")])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0)])),R])}a(33948),a(38862),a(73210),a(57658);var I=a(76496),U=a(88575),J=a(2243),H=a(57265),A=a(37184),P=a(20868),z={components:{AppBarPage:I.Z,SelectComponents:J.Z,UploaderImageComponents:H.Z,TableComponents:U.Z},data:()=>({_pageIndex:0,_pageActive:!1,bufferRow:{},qmTaskData:{},tableList:[],tableListBuffer:[],urgency:"",urgencySelectOption:[],process:"",processSelectOption:[]}),created(){this.initFunc(),this.remarkHTTP()},methods:{GlobalTooltipFunc(e=""){(0,P.CF)({message:e,overlay:!0,closeOnClickOverlay:!0,duration:0})},FormatDictionary(e="",t=""){const a=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),i=a[e]||[],l=i.filter((e=>t==e.value))[0]||{};return l},FormatBottomResult(){const{bufferRow:e={}}=this;if(!e.inspectResult)return;const t=this.FormatDictionary("IQC_RESULT",e.inspectResult)["lable"];return t},FormatBottomResultColor(){const{bufferRow:e={}}=this;let t="";switch(e.inspectResult){case"10":t="color:#4CAF50";break;case"20":t="color:#FF9800";break;case"30":t="color:#FF5722";break;default:break}return t},async initFunc(){const{ttQmTaskId:e,_pageIndex:t=0,qcType:a="",_pageActive:i=""}=this.$route.query;this._pageIndex=t,this._pageActive="detail"==i;const{code:l,data:s={}}=await(0,A.i)({url:`/iiot/qmTask/getQmTaskData/${e}`,method:"get"});200==l&&(this.bufferRow=s.qmTaskData||{},this.qmTaskData=s.qmTaskData||{});const o=await(0,A.i)({url:"/iiot/qmTaskResult/getCheckResultList",method:"get",url_params:{ttQmTaskId:e,qcType:a}});if(200==l){this.tableList=((null===o||void 0===o?void 0:o.data.dataList)||[]).map((e=>Object.assign(e,{_switch:!e.inspectResult||"10"==e.inspectResult,_urgency:e.remark,_bufferFileList:e.taskResultPath?e.taskResultPath.split(",").map((e=>Object.assign({url:e}))):[]}))),this.$nextTick((()=>{this.tableListBuffer=this.tableList,this.$refs.table1.initFunc()}));let e=new Set(((null===o||void 0===o?void 0:o.data.dataList)||[]).map((e=>e.nodeLevelName)));this.processSelectOption=[...e].map(((e,t)=>Object.assign({text:e,value:t}))),this.$nextTick((()=>{const e=JSON.parse(localStorage.getItem("bufferProcessDetailSelectProcess")||"{}");if(Object.keys(e).length){const t=this.processSelectOption.filter((t=>t.text==e.text))[0]||{};this.$refs.select111&&this.$refs.select111.setValue(t.value),this.onChangeProcess("",t)}}))}},async remarkHTTP(e=""){const{code:t,data:a=[]}=await(0,A.i)({url:"/iiot/defect/listDefectForSelect",method:"get",url_params:{defectNo:e,enabled:"1"}});200==t&&(this.urgencySelectOption=a.map((e=>Object.assign({text:`${e.defectTypeName}-${e.defectName}`,value:e.tmQmDefectId}))).splice(0,200))},productSearchChange(e){this.remarkHTTP(e)},onChangeProcess(e,t){this.tableList=JSON.parse(JSON.stringify(this.tableListBuffer)).filter((e=>e.nodeLevelName==t.text)),this.$nextTick((()=>{this.$refs.table1.initFunc(),localStorage.setItem("bufferProcessDetailSelectProcess",JSON.stringify(t))}))},resultValueHandle(e){const{items:t,_index:a}=e;this.$nextTick((()=>{"DT"==this.FormatDictionary("checkout_param_type",e.items.parameterType).value&&(Number(t.resultValue)>=Number(t.lowerDeviation)&&Number(t.resultValue)<=Number(t.upperDeviation)?this.tableList[a]["_switch"]=!0:this.tableList[a]["_switch"]=!1)}))},async disqualificationApplyHandle(){const{qmTaskData:e}=this;if(this.tableList.filter((e=>!e._switch&&!(e._urgency||"").trim())).length)return void(0,P.LJ)("不合格时，不良描述必填");const t={dataList:JSON.parse(JSON.stringify(this.tableList)).map((e=>Object.assign(e,{remark:e._urgency,inspectResult:e._switch?"10":"30",taskResultPath:(e._bufferFileList||[]).map((e=>e.url)).join()}))),qmTaskData:e},{code:a,data:i={}}=await(0,A.i)({url:"/iiot/qmTaskResult/materialsApplyUnQualityManage",method:"post",payload:t});200==a&&((0,P.XA)("提交成功！"),this.$router.push({path:"/processDisqualification/detail",query:{ttQmDefectId:i.ttQmDefectId}}))},async standardHandle(e){const{qmTaskData:t}=this,{_pageIndex:a=""}=this.$route.query;if(this.tableList.filter((e=>!e._switch&&!(e._urgency||"").trim())).length)return void(0,P.LJ)("不合格时，不良描述必填");const i={dataList:JSON.parse(JSON.stringify(this.tableList)).map((e=>Object.assign(e,{remark:e._urgency,inspectResult:e._switch?"10":"30",taskResultPath:(e._bufferFileList||[]).map((e=>e.url)).join()}))),qmTaskData:Object.assign(t,{inspectResult:e?"10":"30"})},{code:l,data:s={}}=await(0,A.i)({url:"/iiot/qmTaskResult/materialsCheckResultSave",method:"post",payload:i});200==l&&((0,P.XA)("提交成功！"),this.initFunc(),"1"==a&&e&&setTimeout((()=>{this.$router.push({path:"/process/index",query:{}})}),1500))},async submitHandle(e){const{qmTaskData:t}=this,{_pageIndex:a=""}=this.$route.query;let i={};switch(e){case 1:i={inspectResult:"10"};break;case 2:i={inspectResult:"30"};break;default:break}var l={inspectResult:""};this.tableList.filter((e=>!e._switch)).length?l.inspectResult="30":l.inspectResult="10";const s=this.tableList.filter((e=>"DT"==this.FormatDictionary("checkout_param_type",e.parameterType).value&&!e.resultValue));if(s.length)return void(0,P.LJ)("数值类型，检验结果必填！");if(this.tableList.filter((e=>!e._switch&&!(e._urgency||"").trim())).length)return void(0,P.LJ)("不合格时，不良描述必填");const o={dataList:JSON.parse(JSON.stringify(this.tableList)).map((e=>Object.assign(e,{remark:e._urgency,inspectResult:e._switch?"10":"30",taskResultPath:(e._bufferFileList||[]).map((e=>e.url)).join()}))),qmTaskData:Object.assign(t,i,l)},{code:n,data:r={}}=await(0,A.i)({url:"/iiot/qmTaskResult/materialsCheckResultSave",method:"post",payload:o});200==n&&((0,P.XA)("提交成功！"),this.initFunc(),"2"!=a||e||setTimeout((()=>{this.$router.push({path:"/process/index",query:{}})}),1500),"3"!=a||e||this.process!=this.processSelectOption.length-1&&setTimeout((()=>{this.$router.push({path:"/process/index",query:{}})}),1500),"4"==a&&1==e&&setTimeout((()=>{this.$router.push({path:"/process/index",query:{}})}),1500))},async applyDisposeHandle(e){const{items:t}=e,{qmTaskData:a}=this;if(!t._switch&&!(t._urgency||"").trim())return void(0,P.LJ)("不合格时，不良描述必填");const i={dataList:[t].map((e=>Object.assign(e,{remark:e._urgency}))),qmTaskData:a},{code:l,data:s={}}=await(0,A.i)({url:"/iiot/qmTaskResult/materialsApplyUnQualityManage",method:"post",payload:i});200==l&&((0,P.XA)("提交成功！"),this.$router.push({path:"/processDisqualification/detail",query:{ttQmDefectId:s.ttQmDefectId}}))},async shiftToHandle(e){const{qmTaskData:t}=this,a={type:e,ttQmTaskId:t.ttQmTaskId},{code:i,data:l={}}=await(0,A.i)({url:"/iiot/qmTaskResult/turnAdjustmentStorage",method:"post",payload:{qmTaskData:a}});200==i&&((0,P.XA)("提交成功！"),this.initFunc(),setTimeout((()=>{this.$router.push({path:"/process/index",query:{}})}),1e3))},anomalyInitiateSectionFunc(e){const{qmTaskData:t}=this;1==e&&this.$router.push({path:"/anomalyInitiateSection/add",query:{sn:null===t||void 0===t?void 0:t.sn,ttPpOrderSnId:null===t||void 0===t?void 0:t.ttPpOrderSnId}}),2==e&&this.$router.push({path:"/anomalyInitiateSection/dispose",query:{sn:null===t||void 0===t?void 0:t.sn,ttPpOrderSnId:null===t||void 0===t?void 0:t.ttPpOrderSnId}})},rectifyHandle(e){this.$router.push({path:"/processDisqualification/detail",query:{ttQmDefectId:e.ttQmDefectId}})},async batteryHandle(e=[]){const{_pageActive:t=""}=this.$route.query,{bufferRow:a}=this;if("detail"==t){const{code:e,data:i=[]}=await(0,A.i)({url:"/iiot/batteryResult/list",method:"get",url_params:{sn:a.sn,orderNo:a.orderNo,partNo:a.partNo}});return void(200==e&&(i&&i.length?this.$router.push({path:"/battery/index",query:{_pageActive:t,row:JSON.stringify(this.bufferRow)}}):(0,P.LJ)("没有维护电池曲线!")))}const i=await(0,A.i)({url:"/iiot/batteryResult/batteryList",method:"get",url_params:{sn:a.sn,orderNo:a.orderNo,partNo:a.partNo}});var l;200==i.code&&this.$router.push({path:"/battery/index",query:{batteryCheckType:null===(l=e[0])||void 0===l?void 0:l.batteryCheckType,_pageActive:t,row:JSON.stringify(this.bufferRow)}})}}},Q=a(40089);const Z=(0,Q.Z)(z,[["render",B]]);var X=Z}}]);
//# sourceMappingURL=chunk.7487.1689577235749.js.map