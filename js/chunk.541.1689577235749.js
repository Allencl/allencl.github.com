"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[541],{2243:function(e,l,t){t.d(l,{Z:function(){return y}});var a=t(73396),i=t(87139);const o={style:{height:"98%","padding-bottom":"40px"}},n={style:{height:"100%"}},s={style:{position:"relative",top:"4px"}},p=["onClick"],u={class:"text-truncate",style:{height:"24px"}},r={key:2,class:"text-center",style:{"margin-top":"16px"}};function c(e,l,t,c,d,h){const m=(0,a.up)("van-field"),f=(0,a.up)("v-col"),y=(0,a.up)("v-btn"),k=(0,a.up)("v-row"),g=(0,a.up)("van-search"),b=(0,a.up)("van-checkbox"),v=(0,a.up)("van-popup");return(0,a.wg)(),(0,a.iD)("span",null,[(0,a.Wm)(m,{modelValue:e.fieldValue,"onUpdate:modelValue":l[0]||(l[0]=l=>e.fieldValue=l),"is-link":"",readonly:"",required:t.required,label:t.label,placeholder:t.placeholder,autocomplete:"off",type:t.multiple?"textarea":"text",onClick:h.fieldClick},null,8,["modelValue","required","label","placeholder","type","onClick"]),(0,a.Wm)(v,{show:e.showPicker,"onUpdate:show":l[5]||(l[5]=l=>e.showPicker=l),style:{padding:"12px 12px 4px 12px",height:"60%",width:"90%"},round:""},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a._)("div",n,[(0,a.Wm)(k,{"no-gutters":"",style:{"font-weight":"bold","border-bottom":"1px solid #ccc","padding-bottom":"5px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{cols:"6"},{default:(0,a.w5)((()=>[(0,a._)("p",null,(0,i.zw)(t.label)+"-选择框",1)])),_:1}),(0,a.Wm)(f,{cols:"6",class:"text-right"},{default:(0,a.w5)((()=>[(0,a._)("span",s,(0,i.zw)(e.BufferOption.filter((e=>e._checked)).length),1),t.selectAll?((0,a.wg)(),(0,a.j4)(y,{key:0,onClick:h.selectAllHandle,color:"primary mt-1",density:"compact",rounded:0,variant:"plain"},{default:(0,a.w5)((()=>[(0,a.Uk)("全选")])),_:1},8,["onClick"])):(0,a.kq)("",!0)])),_:1})])),_:1}),t.showSearch?((0,a.wg)(),(0,a.j4)(k,{key:0,"no-gutters":""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{cols:"8"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{modelValue:e.valueSearch,"onUpdate:modelValue":l[1]||(l[1]=l=>e.valueSearch=l),shape:"",placeholder:t.placeholderSearch,style:{"padding-left":"0px"},clearable:!1},null,8,["modelValue","placeholder"])])),_:1}),(0,a.Wm)(f,{cols:"2"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{onClick:l[2]||(l[2]=e=>h.searchHandle(!0)),variant:"plain",color:"primary",block:"",style:{"margin-top":"8px"}},{default:(0,a.w5)((()=>[(0,a.Uk)(" 查询 ")])),_:1})])),_:1}),(0,a.Wm)(f,{cols:"2"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{onClick:l[3]||(l[3]=e=>h.searchHandle(!1)),variant:"plain",block:"",style:{"margin-top":"8px"}},{default:(0,a.w5)((()=>[(0,a.Uk)(" 重置 ")])),_:1})])),_:1})])),_:1})):(0,a.kq)("",!0),e.BufferOption.length?((0,a.wg)(),(0,a.iD)("ul",{key:1,style:(0,i.j5)(`height: ${t.showSearch?"73%":"90%"};overflow-y:auto;padding-right:12px;padding-bottom: 20px;`)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.BufferOption,((e,l)=>((0,a.wg)(),(0,a.iD)("li",{key:l,style:(0,i.j5)(`padding: 6px 22px 6px 6px;position:relative;color:${e._searchColor?"#FF9800":"#000"};`),onClick:l=>h.checkChange(e)},[(0,a._)("p",u,(0,i.zw)(e.text),1),(0,a.Wm)(b,{style:{position:"absolute",top:"8px",right:"0px"},modelValue:e._checked,"onUpdate:modelValue":l=>e._checked=l,shape:"square","checked-color":"#4CAF50",disabled:"",class:"custem-select-checkbox"},null,8,["modelValue","onUpdate:modelValue"])],12,p)))),128))],4)):((0,a.wg)(),(0,a.iD)("p",r,"无数据!"))]),(0,a.Wm)(k,{"no-gutters":""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{cols:"6",class:"text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{variant:"plain",block:"",onClick:l[4]||(l[4]=()=>e.showPicker=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)(" 取消 ")])),_:1})])),_:1}),(0,a.Wm)(f,{cols:"6",class:"text-center"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{variant:"plain",color:"primary",block:"",onClick:h.confirmHandle},{default:(0,a.w5)((()=>[(0,a.Uk)(" 确定 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])])),_:1},8,["show"])])}t(38862),t(73210),t(26699),t(32023);var d=t(20868),h={components:{},emits:["update:modelValue","onChange","onFieldClick","onSearchChange"],data:()=>({BufferOption:[],selectedValues:[],columns:[],fieldValue:"",showPicker:!1,valueSearch:""}),watch:{option:{handler(e=[]){this.BufferOption=JSON.parse(JSON.stringify(e)),this.$nextTick((()=>{this.modelValue&&this.setValue(this.modelValue)}))},deep:!0,immediate:!0},showPicker:{handler(e){this.$nextTick((()=>{if(e&&this.modelValue)if(this.multiple){const e=this.modelValue.split(",")||[];e.map((e=>{this.BufferOption.map((l=>{var t=l;return l.value==e&&(t._checked=!0),t}))}))}else this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==this.modelValue})))}))},deep:!0,immediate:!0}},methods:{showModle(){this.showPicker=!0},fieldClick(){this.disabled||(this.forbidShow||(this.showPicker=!0),this.$emit("onFieldClick"))},setfieldValue(e=""){this.fieldValue=e},reset(){this.fieldValue="",this.BufferOption.map((e=>Object.assign(e,{_checked:!1}))),this.$emit("update:modelValue","")},setValue(e=""){if(this.multiple){const l=e.split(",")||[];l.map((e=>{this.BufferOption.map((l=>{var t=l;return l.value==e&&(t._checked=!0),t}))})),this.fieldValue=this.BufferOption.filter((e=>e._checked)).map((e=>e.text)).join()}else{const l=JSON.parse(JSON.stringify(this.BufferOption)).filter((l=>l.value==e))[0]||{};this.fieldValue=l.text}},confirmHandle(){const{multiple:e}=this,l=this.BufferOption.filter((e=>1==e._checked));e?(this.fieldValue=l.map((e=>e.text)).join(),this.$emit("update:modelValue",l.map((e=>e.value)).join()||""),this.$emit("onChange",l.map((e=>e.value)).join())):(this.fieldValue=(l[0]||{}).text,this.$emit("update:modelValue",(l[0]||{}).value||""),this.$emit("onChange",(l[0]||{}).value,l[0]||{})),this.showPicker=!1},checkChange(e){const{multiple:l}=this,{_checked:t,value:a}=e;l?this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==a?!t:e._checked}))):this.BufferOption.map((e=>Object.assign(e,{_checked:e.value==a&&!t})))},multipleHandle(){const e=this.BufferOption.filter((e=>e._checked)),l=e.map((e=>e.value)).join();this.showPicker=!1,this.fieldValue=e.map((e=>e.text)).join(),this.$emit("update:modelValue",l),this.$emit("onChange",e)},searchHandle(e){const l=this.valueSearch.trim(),{filterSearch:t}=this;if(t&&e){const e=this.BufferOption.map((e=>Object.assign(e,{_searchColor:!1}))),t=e.filter((e=>e.text.includes(l))).map((e=>Object.assign(e,{_searchColor:!0})));if(!t.length)return void(0,d.LJ)("不存在！");const a=e.filter((e=>!e.text.includes(l))),i=a.filter((e=>e._checked)),o=a.filter((e=>!e._checked));this.BufferOption=t.concat(i).concat(o)}else e?this.$emit("onSearchChange",l):(this.valueSearch="",this.BufferOption=this.option,this.$nextTick((()=>{this.BufferOption=this.BufferOption.map((e=>Object.assign(e,{_checked:!1})))})),this.$emit("onSearchChange",""))},selectAllHandle(){this.BufferOption.map((e=>Object.assign(e,{_checked:!0})))}},props:{modelValue:{},disabled:{type:Boolean,default:()=>!1},showSearch:{type:Boolean,default:()=>!1},forbidShow:{type:Boolean,default:()=>!1},multiple:{type:Boolean,default:()=>!1},label:{type:String,default:()=>"标题"},placeholder:{type:String,default:()=>"请选择"},placeholderSearch:{type:String,default:()=>"请输入搜索关键词"},option:{type:Array,default:()=>[]},selectAll:{type:Boolean,default:()=>!1},required:{type:Boolean,default:()=>!1},filterSearch:{type:Boolean,default:()=>!1}}},m=t(40089);const f=(0,m.Z)(h,[["render",c]]);var y=f},50541:function(e,l,t){t.r(l),t.d(l,{default:function(){return f}});var a=t(73396);const i=(0,a._)("span",{style:{"padding-left":"6px"}},"添加异常",-1),o=(0,a._)("div",{style:{height:"80px"}},null,-1);function n(e,l,t,n,s,p){const u=(0,a.up)("AppBarPage"),r=(0,a.up)("v-icon"),c=(0,a.up)("v-col"),d=(0,a.up)("v-row"),h=(0,a.up)("SelectComponents"),m=(0,a.up)("van-field"),f=(0,a.up)("v-sheet"),y=(0,a.up)("v-btn");return(0,a.wg)(),(0,a.iD)("span",null,[(0,a.Wm)(u),(0,a.Wm)(d,{"no-gutters":"",style:{"margin-bottom":"8px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{cols:"8"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{icon:"mdi-bullhorn",size:"16",color:"error"}),i])),_:1}),(0,a.Wm)(c,{cols:"4",class:"text-right",style:{"padding-right":"6px"}})])),_:1}),(0,a.Wm)(f,{elevation:"2",rounded:"",class:"custem-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{modelValue:e.user,"onUpdate:modelValue":l[0]||(l[0]=l=>e.user=l),ref:"select11",label:"物料编码",option:e.repairmanSelectOption},null,8,["modelValue","option"]),(0,a.Wm)(m,{modelValue:e.reqQty,"onUpdate:modelValue":l[1]||(l[1]=l=>e.reqQty=l),type:"number",placeholder:"请输入",label:"数量",autocomplete:"off"},null,8,["modelValue"]),(0,a.Wm)(h,{modelValue:e.type,"onUpdate:modelValue":l[2]||(l[2]=l=>e.type=l),ref:"select22",label:"异常类型",option:e.typeSelectOption},null,8,["modelValue","option"]),(0,a.Wm)(h,{modelValue:e.type2,"onUpdate:modelValue":l[3]||(l[3]=l=>e.type2=l),ref:"select33",label:"处理类型",option:e.type2SelectOption},null,8,["modelValue","option"]),(0,a.Wm)(m,{modelValue:e.abnormalExplain,"onUpdate:modelValue":l[4]||(l[4]=l=>e.abnormalExplain=l),placeholder:"请输入",label:"异常说明",autocomplete:"off"},null,8,["modelValue"]),(0,a.Wm)(m,{modelValue:e.disposeExplain,"onUpdate:modelValue":l[5]||(l[5]=l=>e.disposeExplain=l),placeholder:"请输入",label:"处理说明",autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{"no-gutters":""},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{cols:"12"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{block:"",color:"primary",onClick:p.onSubmit},{default:(0,a.w5)((()=>[(0,a.Uk)(" 提交 ")])),_:1},8,["onClick"])])),_:1})])),_:1}),o])}var s=t(21801),p=(t(57658),t(76496)),u=t(2243),r=t(20868),c=t(37184),d={components:{AppBarPage:p.Z,SelectComponents:u.Z},data:()=>({bufferRow:{},user:"",repairmanSelectOption:[],reqQty:"",type:"",typeSelectOption:[],type2:"",type2SelectOption:[],abnormalExplain:"",disposeExplain:""}),created(){this.initFunc(),this.initRepairman()},methods:{initFunc(){const e=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),l=e["ccgl_abnormal_type"]||[];this.typeSelectOption=l.map((e=>Object.assign({text:e.lable,value:e.value})));const t=e["ccgl_abnomal_dispose"]||[];this.type2SelectOption=t.map((e=>Object.assign({text:e.lable,value:e.value})))},async initRepairman(){const{deliverySlipId:e}=this.$route.query,l=await(0,c.i)({url:`/iiot/deliverySlipPart/dict/${e}`,method:"get"});this.repairmanSelectOption=(l||[]).map((e=>Object.assign({text:`${e.dictValue||""}-${e.dictLabel||""}`,value:e.dictValue})))},async onSubmit(){const{deliverySlipId:e,deliverySlipType:l,poNo:t,srmNo:a}=this.$route.query,i={abnormalId:null,deliverySlipId:e,deliverySlipType:l,poNo:t,srmNo:a,abnormalType:null,abnormalExplain:null,partNo:null,reqQty:null,partName:null,submitDatetime:null,submitUser:null,disposeType:null,disposeExplain:null,disposeUser:null,disposeDatetime:null,dataState:2,createBy:null,createTime:null,updateBy:null,updateTime:null,delFlag:null,version:null},o=(0,s.Z)((0,s.Z)({},i),{},{partNo:this.user,reqQty:this.reqQty,abnormalType:this.type,disposeType:this.type2,abnormalExplain:this.abnormalExplain,disposeExplain:this.disposeExplain}),{code:n,data:p={}}=await(0,c.i)({url:"/iiot/deliverySlipAbnormal",method:"post",payload:o});200==n&&((0,r.XA)("提交成功！"),this.$router.push({path:"/storage/take",query:{deliverySlipId:e}}))}}},h=t(40089);const m=(0,h.Z)(d,[["render",n]]);var f=m}}]);
//# sourceMappingURL=chunk.541.1689577235749.js.map