"use strict";(self["webpackChunksinoboom_mom"]=self["webpackChunksinoboom_mom"]||[]).push([[290],{57265:function(e,t,i){i.d(t,{Z:function(){return h}});var a=i(73396);const r={style:{padding:"0px 12px 0px 12px"}},l={key:0,class:"font-weight-medium text",style:{"margin-bottom":"8px"}},s={key:1,style:{"margin-bottom":"8px"},class:"font-weight-medium text"},o={class:"custem-iamge-upload"},n=["src"];function p(e,t,i,p,u,c){const m=(0,a.up)("van-uploader"),d=(0,a.up)("v-icon");return(0,a.wg)(),(0,a.iD)("span",null,[(0,a._)("div",r,[i.preview?((0,a.wg)(),(0,a.iD)("p",l,"图片预览 ")):((0,a.wg)(),(0,a.iD)("p",s," 图片上传 ")),i.preview?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:2,"after-read":c.afterRead,"preview-image":!1},null,8,["after-read"])),(0,a._)("div",o,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.bufferFileList,((r,l)=>((0,a.wg)(),(0,a.iD)("li",{key:l,onClick:t[0]||(t[0]=t=>c.checkImage(e.bufferFileList))},[(0,a._)("img",{src:r.url},null,8,n),i.preview?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(d,{key:0,onClick:e=>c.removeClick(r,e),class:"icon",icon:"mdi-close-circle-outline",color:"red"},null,8,["onClick"]))])))),128))])])])}i(26699),i(32023),i(38862);var u=i(37184),c=i(20868),m=i(9801),d={components:{},emits:["update:modelValue","onChange"],data:()=>({bufferFileList:[]}),watch:{modelValue:{handler(e=[]){this.bufferFileList=e},deep:!0,immediate:!0},initPath:{handler(e=""){e&&(this.bufferFileList=e.split(",").map((e=>Object.assign({url:e}))))},deep:!0,immediate:!0}},methods:{checkImage(e=[]){e.length&&(0,m.V)(e.map((e=>e.url)))},async afterRead(e){if(!e.file.type.includes("image"))return void(0,c.LJ)("只能选择图片！");if(e.file.size>=19922944)return void(0,c.LJ)("图片超过20M！");if(this.bufferFileList.length>2)return void(0,c.LJ)("最多只能选择3张图片！");let t=new FormData;t.append("file",e.file);const{code:i,data:a={}}=await(0,u.i)({url:"/file/upload",method:"post",formData:!0,payload:t});200==i?(this.bufferFileList=this.bufferFileList.concat([a]),(0,c.XA)("图片上传成功！"),this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.bufferFileList)))):(0,c.LJ)("图片上传失败！")},removeClick(e,t){t.stopPropagation(),this.bufferFileList=JSON.parse(JSON.stringify(this.bufferFileList)).filter((t=>t.url!=e.url)),this.$nextTick((()=>{this.$emit("update:modelValue",JSON.parse(JSON.stringify(this.bufferFileList)))}))}},props:{modelValue:{type:Array,default:()=>[]},initPath:{type:String,default:()=>""},preview:{type:Boolean,default:()=>!1}}},f=i(40089);const g=(0,f.Z)(d,[["render",p]]);var h=g},40290:function(e,t,i){i.r(t),i.d(t,{default:function(){return y}});var a=i(73396),r=i(87139);const l={class:"eror-content-steps-container"},s={class:"title text"},o={class:"user text"},n={class:"time text"},p={class:"remark text"},u=(0,a._)("div",{style:{height:"52px"}},null,-1);function c(e,t,i,c,m,d){const f=(0,a.up)("AppBarPage"),g=(0,a.up)("UploaderImageComponents"),h=(0,a.up)("van-step"),v=(0,a.up)("van-steps");return(0,a.wg)(),(0,a.iD)("span",null,[(0,a.Wm)(f),(0,a._)("div",l,[(0,a.Wm)(v,{direction:"vertical",active:e.active,"active-color":"#07c160"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.steapList,((e,t)=>((0,a.wg)(),(0,a.j4)(h,{key:t},{default:(0,a.w5)((()=>[(0,a._)("p",s,(0,r.zw)(e.title),1),(0,a._)("p",o,(0,r.zw)(e.user),1),(0,a._)("p",n,(0,r.zw)(e.time),1),(0,a._)("p",p,(0,r.zw)(e.remark),1),e._bufferFileList.length?((0,a.wg)(),(0,a.j4)(g,{key:0,modelValue:e._bufferFileList,"onUpdate:modelValue":t=>e._bufferFileList=t,preview:""},null,8,["modelValue","onUpdate:modelValue"])):(0,a.kq)("",!0)])),_:2},1024)))),128))])),_:1},8,["active"])]),u])}var m=i(76496),d=i(37184),f=i(57265),g={components:{AppBarPage:m.Z,UploaderImageComponents:f.Z},data:()=>({active:0,steapList:[]}),created(){this.initFunc()},methods:{FormatDictionary(e="",t=""){const i=JSON.parse(localStorage.getItem("bufferDictionaries")||"{}"),a=i[e]||[],r=a.filter((e=>t==e.value))[0]||{};return r},async initFunc(){const{ttQmAbnormalId:e}=this.$route.query,{code:t,data:i=[]}=await(0,d.i)({url:"/iiot/abnormalDetail/list",method:"get",url_params:{ttQmAbnormalId:e}});200==t&&i.length&&(this.steapList=i.map((e=>{var t="",i=e.operatePath||"";"1"!=e.operateType&&"5"!=e.operateType||(t=e.abnormalDesc||""),"2"==e.operateType&&(t=e.retransmissionDesc||""),"3"==e.operateType&&(t=e.appointDesc||""),"4"==e.operateType&&(t=e.manageDesc||""),"6"!=e.operateType&&"8"!=e.operateType||(t=e.rejectReason||""),"7"==e.operateType&&(t=e.closeAppraise||"");var a=Object.assign({title:e.operateTypeName,user:e.operateBy,time:e.operateTime,remark:`${e.operateTypeName}描述: ${t}`,_bufferFileList:i?i.split(",").map((e=>Object.assign({url:e}))):[]});return a})),this.active=i.length-1)}}},h=i(40089);const v=(0,h.Z)(g,[["render",c]]);var y=v}}]);
//# sourceMappingURL=chunk.290.1689576161502.js.map